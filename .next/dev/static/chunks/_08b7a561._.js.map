{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sinan/sola/lib/storage.ts"],"sourcesContent":["// User-specific storage utilities\r\nexport interface UserData {\r\n  projects: any[]\r\n  users: any[]\r\n  allocations: any[]\r\n  positions: any[]\r\n  entities: any[]\r\n  startMonth?: number\r\n  startYear?: number\r\n  systemUsers?: SystemUser[] // Global system users (for login)\r\n}\r\n\r\nexport interface SystemUser {\r\n  id: string\r\n  email: string\r\n  name: string\r\n  password: string\r\n  role: 'admin' | 'editor' | 'viewer' | 'senior'\r\n  isActive: boolean\r\n  createdAt: string\r\n}\r\n\r\nconst STORAGE_KEYS = {\r\n  CURRENT_USER: \"sola-current-user\",\r\n  USER_DATA_PREFIX: \"sola-user-data-\",\r\n  SYSTEM_USERS: \"sola-system-users\", // Global user registry\r\n} as const\r\n\r\nexport function getSystemUsers(): SystemUser[] {\r\n  if (typeof window === 'undefined') return []\r\n  const data = localStorage.getItem(STORAGE_KEYS.SYSTEM_USERS)\r\n  return data ? JSON.parse(data) : []\r\n}\r\n\r\nexport function setSystemUsers(users: SystemUser[]): void {\r\n  if (typeof window === 'undefined') return\r\n  localStorage.setItem(STORAGE_KEYS.SYSTEM_USERS, JSON.stringify(users))\r\n}\r\n\r\nexport function addSystemUser(user: Omit<SystemUser, 'id' | 'createdAt'>): SystemUser {\r\n  const users = getSystemUsers()\r\n  const newUser: SystemUser = {\r\n    ...user,\r\n    id: `system-user-${Date.now()}`,\r\n    createdAt: new Date().toISOString(),\r\n  }\r\n  setSystemUsers([...users, newUser])\r\n  return newUser\r\n}\r\n\r\nexport function updateSystemUser(id: string, updates: Partial<SystemUser>): void {\r\n  const users = getSystemUsers()\r\n  const updated = users.map(u => u.id === id ? { ...u, ...updates } : u)\r\n  setSystemUsers(updated)\r\n}\r\n\r\nexport function deleteSystemUser(id: string): void {\r\n  const users = getSystemUsers()\r\n  setSystemUsers(users.filter(u => u.id !== id))\r\n}\r\n\r\nexport function authenticateUser(email: string, password: string): SystemUser | null {\r\n  const users = getSystemUsers()\r\n  return users.find(u => u.email === email && u.password === password && u.isActive) || null\r\n}\r\n\r\nexport function getCurrentUser(): string | null {\r\n  if (typeof window === 'undefined') return null\r\n  return localStorage.getItem(STORAGE_KEYS.CURRENT_USER)\r\n}\r\n\r\nexport function getCurrentSystemUser(): SystemUser | null {\r\n  const email = getCurrentUser()\r\n  if (!email) return null\r\n  const users = getSystemUsers()\r\n  return users.find(u => u.email === email) || null\r\n}\r\n\r\nexport function setCurrentUser(email: string): void {\r\n  if (typeof window === 'undefined') return\r\n  localStorage.setItem(STORAGE_KEYS.CURRENT_USER, email)\r\n}\r\n\r\nexport function clearCurrentUser(): void {\r\n  if (typeof window === 'undefined') return\r\n  localStorage.removeItem(STORAGE_KEYS.CURRENT_USER)\r\n}\r\n\r\nexport function getUserData(email: string): UserData {\r\n  if (typeof window === 'undefined') return { projects: [], users: [], allocations: [], positions: [], entities: [] }\r\n  \r\n  const data = localStorage.getItem(STORAGE_KEYS.USER_DATA_PREFIX + email)\r\n  return data ? JSON.parse(data) : { projects: [], users: [], allocations: [], positions: [], entities: [] }\r\n}\r\n\r\nexport function setUserData(email: string, data: Partial<UserData>): void {\r\n  if (typeof window === 'undefined') return\r\n  \r\n  const existing = getUserData(email)\r\n  const updated = { ...existing, ...data }\r\n  localStorage.setItem(STORAGE_KEYS.USER_DATA_PREFIX + email, JSON.stringify(updated))\r\n}\r\n\r\nexport function clearUserData(email: string): void {\r\n  if (typeof window === 'undefined') return\r\n  localStorage.removeItem(STORAGE_KEYS.USER_DATA_PREFIX + email)\r\n}\r\n\r\n// Convenience functions that work with the current user\r\nexport function getCurrentUserData(): UserData {\r\n  const currentUser = getCurrentUser()\r\n  if (!currentUser) return { projects: [], users: [], allocations: [], positions: [], entities: [] }\r\n  return getUserData(currentUser)\r\n}\r\n\r\nexport function setCurrentUserData(data: Partial<UserData>): void {\r\n  const currentUser = getCurrentUser()\r\n  if (!currentUser) return\r\n  setUserData(currentUser, data)\r\n}\r\n"],"names":[],"mappings":"AAAA,kCAAkC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsBlC,MAAM,eAAe;IACnB,cAAc;IACd,kBAAkB;IAClB,cAAc;AAChB;AAEO,SAAS;IACd;;IACA,MAAM,OAAO,aAAa,OAAO,CAAC,aAAa,YAAY;IAC3D,OAAO,OAAO,KAAK,KAAK,CAAC,QAAQ,EAAE;AACrC;AAEO,SAAS,eAAe,KAAmB;IAChD;;IACA,aAAa,OAAO,CAAC,aAAa,YAAY,EAAE,KAAK,SAAS,CAAC;AACjE;AAEO,SAAS,cAAc,IAA0C;IACtE,MAAM,QAAQ;IACd,MAAM,UAAsB;QAC1B,GAAG,IAAI;QACP,IAAI,CAAC,YAAY,EAAE,KAAK,GAAG,IAAI;QAC/B,WAAW,IAAI,OAAO,WAAW;IACnC;IACA,eAAe;WAAI;QAAO;KAAQ;IAClC,OAAO;AACT;AAEO,SAAS,iBAAiB,EAAU,EAAE,OAA4B;IACvE,MAAM,QAAQ;IACd,MAAM,UAAU,MAAM,GAAG,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,KAAK;YAAE,GAAG,CAAC;YAAE,GAAG,OAAO;QAAC,IAAI;IACpE,eAAe;AACjB;AAEO,SAAS,iBAAiB,EAAU;IACzC,MAAM,QAAQ;IACd,eAAe,MAAM,MAAM,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;AAC5C;AAEO,SAAS,iBAAiB,KAAa,EAAE,QAAgB;IAC9D,MAAM,QAAQ;IACd,OAAO,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,KAAK,KAAK,SAAS,EAAE,QAAQ,KAAK,YAAY,EAAE,QAAQ,KAAK;AACxF;AAEO,SAAS;IACd;;IACA,OAAO,aAAa,OAAO,CAAC,aAAa,YAAY;AACvD;AAEO,SAAS;IACd,MAAM,QAAQ;IACd,IAAI,CAAC,OAAO,OAAO;IACnB,MAAM,QAAQ;IACd,OAAO,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,KAAK,KAAK,UAAU;AAC/C;AAEO,SAAS,eAAe,KAAa;IAC1C;;IACA,aAAa,OAAO,CAAC,aAAa,YAAY,EAAE;AAClD;AAEO,SAAS;IACd;;IACA,aAAa,UAAU,CAAC,aAAa,YAAY;AACnD;AAEO,SAAS,YAAY,KAAa;IACvC;;IAEA,MAAM,OAAO,aAAa,OAAO,CAAC,aAAa,gBAAgB,GAAG;IAClE,OAAO,OAAO,KAAK,KAAK,CAAC,QAAQ;QAAE,UAAU,EAAE;QAAE,OAAO,EAAE;QAAE,aAAa,EAAE;QAAE,WAAW,EAAE;QAAE,UAAU,EAAE;IAAC;AAC3G;AAEO,SAAS,YAAY,KAAa,EAAE,IAAuB;IAChE;;IAEA,MAAM,WAAW,YAAY;IAC7B,MAAM,UAAU;QAAE,GAAG,QAAQ;QAAE,GAAG,IAAI;IAAC;IACvC,aAAa,OAAO,CAAC,aAAa,gBAAgB,GAAG,OAAO,KAAK,SAAS,CAAC;AAC7E;AAEO,SAAS,cAAc,KAAa;IACzC;;IACA,aAAa,UAAU,CAAC,aAAa,gBAAgB,GAAG;AAC1D;AAGO,SAAS;IACd,MAAM,cAAc;IACpB,IAAI,CAAC,aAAa,OAAO;QAAE,UAAU,EAAE;QAAE,OAAO,EAAE;QAAE,aAAa,EAAE;QAAE,WAAW,EAAE;QAAE,UAAU,EAAE;IAAC;IACjG,OAAO,YAAY;AACrB;AAEO,SAAS,mBAAmB,IAAuB;IACxD,MAAM,cAAc;IACpB,IAAI,CAAC,aAAa;IAClB,YAAY,aAAa;AAC3B"}},
    {"offset": {"line": 153, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sinan/sola/lib/permissions.ts"],"sourcesContent":["// Role-based access control utilities\r\n\r\nexport type UserRole = 'admin' | 'editor' | 'viewer' | 'senior'\r\n\r\nexport interface PagePermissions {\r\n  canView: boolean\r\n  canEdit: boolean\r\n  canDelete: boolean\r\n}\r\n\r\nexport interface TabPermissions {\r\n  allocation: PagePermissions\r\n  planning: PagePermissions\r\n  actualAllocation: PagePermissions\r\n  expenseAllocation: PagePermissions\r\n  scheduledRecords: PagePermissions\r\n  settings: PagePermissions\r\n}\r\n\r\n/**\r\n * Get permissions for a specific role and page\r\n */\r\nexport function getPermissions(role: UserRole, page: keyof Omit<TabPermissions, 'settings'>): PagePermissions {\r\n  switch (role) {\r\n    case 'admin':\r\n      return {\r\n        canView: true,\r\n        canEdit: true,\r\n        canDelete: true\r\n      }\r\n    \r\n    case 'senior':\r\n      return {\r\n        canView: true,\r\n        canEdit: true,\r\n        canDelete: true\r\n      }\r\n    \r\n    case 'editor':\r\n      // Editor can view all tabs except settings, but only edit specific pages\r\n      const canEdit = page === 'expenseAllocation' || page === 'scheduledRecords'\r\n      return {\r\n        canView: true,\r\n        canEdit,\r\n        canDelete: canEdit\r\n      }\r\n    \r\n    case 'viewer':\r\n      // Viewer can only view allocation and planning\r\n      const canView = page === 'allocation' || page === 'planning'\r\n      return {\r\n        canView,\r\n        canEdit: false,\r\n        canDelete: false\r\n      }\r\n    \r\n    default:\r\n      return {\r\n        canView: false,\r\n        canEdit: false,\r\n        canDelete: false\r\n      }\r\n  }\r\n}\r\n\r\n/**\r\n * Get all tab permissions for a role\r\n */\r\nexport function getAllTabPermissions(role: UserRole): TabPermissions {\r\n  return {\r\n    allocation: getPermissions(role, 'allocation'),\r\n    planning: getPermissions(role, 'planning'),\r\n    actualAllocation: getPermissions(role, 'actualAllocation'),\r\n    expenseAllocation: getPermissions(role, 'expenseAllocation'),\r\n    scheduledRecords: getPermissions(role, 'scheduledRecords'),\r\n    settings: {\r\n      canView: role === 'admin',\r\n      canEdit: role === 'admin',\r\n      canDelete: role === 'admin'\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Check if user can access a specific tab\r\n */\r\nexport function canAccessTab(role: UserRole, tab: keyof TabPermissions): boolean {\r\n  const permissions = getAllTabPermissions(role)\r\n  return permissions[tab].canView\r\n}\r\n\r\n/**\r\n * Check if user can edit on a specific page\r\n */\r\nexport function canEditPage(role: UserRole, page: keyof Omit<TabPermissions, 'settings'>): boolean {\r\n  return getPermissions(role, page).canEdit\r\n}\r\n\r\n/**\r\n * Check if user can delete on a specific page\r\n */\r\nexport function canDeletePage(role: UserRole, page: keyof Omit<TabPermissions, 'settings'>): boolean {\r\n  return getPermissions(role, page).canDelete\r\n}\r\n"],"names":[],"mappings":"AAAA,sCAAsC;;;;;;;;;;;;;AAsB/B,SAAS,eAAe,IAAc,EAAE,IAA4C;IACzF,OAAQ;QACN,KAAK;YACH,OAAO;gBACL,SAAS;gBACT,SAAS;gBACT,WAAW;YACb;QAEF,KAAK;YACH,OAAO;gBACL,SAAS;gBACT,SAAS;gBACT,WAAW;YACb;QAEF,KAAK;YACH,yEAAyE;YACzE,MAAM,UAAU,SAAS,uBAAuB,SAAS;YACzD,OAAO;gBACL,SAAS;gBACT;gBACA,WAAW;YACb;QAEF,KAAK;YACH,+CAA+C;YAC/C,MAAM,UAAU,SAAS,gBAAgB,SAAS;YAClD,OAAO;gBACL;gBACA,SAAS;gBACT,WAAW;YACb;QAEF;YACE,OAAO;gBACL,SAAS;gBACT,SAAS;gBACT,WAAW;YACb;IACJ;AACF;AAKO,SAAS,qBAAqB,IAAc;IACjD,OAAO;QACL,YAAY,eAAe,MAAM;QACjC,UAAU,eAAe,MAAM;QAC/B,kBAAkB,eAAe,MAAM;QACvC,mBAAmB,eAAe,MAAM;QACxC,kBAAkB,eAAe,MAAM;QACvC,UAAU;YACR,SAAS,SAAS;YAClB,SAAS,SAAS;YAClB,WAAW,SAAS;QACtB;IACF;AACF;AAKO,SAAS,aAAa,IAAc,EAAE,GAAyB;IACpE,MAAM,cAAc,qBAAqB;IACzC,OAAO,WAAW,CAAC,IAAI,CAAC,OAAO;AACjC;AAKO,SAAS,YAAY,IAAc,EAAE,IAA4C;IACtF,OAAO,eAAe,MAAM,MAAM,OAAO;AAC3C;AAKO,SAAS,cAAc,IAAc,EAAE,IAA4C;IACxF,OAAO,eAAe,MAAM,MAAM,SAAS;AAC7C"}},
    {"offset": {"line": 235, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sinan/sola/components/navigation.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport Link from \"next/link\"\r\nimport { getCurrentSystemUser } from \"../lib/storage\"\r\nimport { canAccessTab, UserRole } from \"../lib/permissions\"\r\nimport { useState, useEffect } from \"react\"\r\n\r\ninterface NavigationProps {\r\n  currentPage: string\r\n}\r\n\r\nexport function Navigation({ currentPage }: NavigationProps) {\r\n  const [userRole, setUserRole] = useState<UserRole | null>(null)\r\n\r\n  useEffect(() => {\r\n    const systemUser = getCurrentSystemUser()\r\n    setUserRole(systemUser?.role || null)\r\n  }, [])\r\n\r\n  if (!userRole) return null\r\n\r\n  const tabs = [\r\n    { key: 'allocation', label: 'Allocation', href: '/' },\r\n    { key: 'planning', label: 'Planning', href: '/planning' },\r\n    { key: 'actualAllocation', label: 'Payroll Allocation', href: '/actual-allocation' },\r\n    { key: 'expenseAllocation', label: 'Expense Allocation', href: '/expense-allocation' },\r\n    { key: 'scheduledRecords', label: 'Scheduled Records', href: '/scheduled-records' },\r\n  ] as const\r\n\r\n  const visibleTabs = tabs.filter(tab => canAccessTab(userRole, tab.key))\r\n\r\n  return (\r\n    <nav className=\"bg-white border-b border-gray-200 px-6 py-3\">\r\n      <div className=\"flex items-center gap-6\">\r\n        <h1 className=\"text-lg font-semibold text-gray-900\">Sola Allocation Tool</h1>\r\n        <div className=\"flex gap-4\">\r\n          {visibleTabs.map((tab) => (\r\n            <Link\r\n              key={tab.key}\r\n              href={tab.href}\r\n              className={\r\n                currentPage === tab.href\r\n                  ? \"text-blue-600 hover:text-blue-800 font-medium\"\r\n                  : \"text-gray-600 hover:text-gray-800 font-medium\"\r\n              }\r\n            >\r\n              {tab.label}\r\n            </Link>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </nav>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;;;AALA;;;;;AAWO,SAAS,WAAW,EAAE,WAAW,EAAmB;;IACzD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,wSAAQ,EAAkB;IAE1D,IAAA,ySAAS;gCAAC;YACR,MAAM,aAAa,IAAA,yIAAoB;YACvC,YAAY,YAAY,QAAQ;QAClC;+BAAG,EAAE;IAEL,IAAI,CAAC,UAAU,OAAO;IAEtB,MAAM,OAAO;QACX;YAAE,KAAK;YAAc,OAAO;YAAc,MAAM;QAAI;QACpD;YAAE,KAAK;YAAY,OAAO;YAAY,MAAM;QAAY;QACxD;YAAE,KAAK;YAAoB,OAAO;YAAsB,MAAM;QAAqB;QACnF;YAAE,KAAK;YAAqB,OAAO;YAAsB,MAAM;QAAsB;QACrF;YAAE,KAAK;YAAoB,OAAO;YAAqB,MAAM;QAAqB;KACnF;IAED,MAAM,cAAc,KAAK,MAAM,CAAC,CAAA,MAAO,IAAA,qIAAY,EAAC,UAAU,IAAI,GAAG;IAErE,qBACE,4TAAC;QAAI,WAAU;kBACb,cAAA,4TAAC;YAAI,WAAU;;8BACb,4TAAC;oBAAG,WAAU;8BAAsC;;;;;;8BACpD,4TAAC;oBAAI,WAAU;8BACZ,YAAY,GAAG,CAAC,CAAC,oBAChB,4TAAC,ySAAI;4BAEH,MAAM,IAAI,IAAI;4BACd,WACE,gBAAgB,IAAI,IAAI,GACpB,kDACA;sCAGL,IAAI,KAAK;2BARL,IAAI,GAAG;;;;;;;;;;;;;;;;;;;;;AAe1B;GA1CgB;KAAA"}},
    {"offset": {"line": 341, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sinan/sola/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\r\nimport { twMerge } from 'tailwind-merge'\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs))\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,uOAAO,EAAC,IAAA,iMAAI,EAAC;AACtB"}},
    {"offset": {"line": 359, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sinan/sola/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\r\nimport { Slot } from '@radix-ui/react-slot'\r\nimport { cva, type VariantProps } from 'class-variance-authority'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nconst buttonVariants = cva(\r\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\r\n        destructive:\r\n          'bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\r\n        outline:\r\n          'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',\r\n        secondary:\r\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\r\n        ghost:\r\n          'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',\r\n        link: 'text-primary underline-offset-4 hover:underline',\r\n      },\r\n      size: {\r\n        default: 'h-9 px-4 py-2 has-[>svg]:px-3',\r\n        sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',\r\n        lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',\r\n        icon: 'size-9',\r\n        'icon-sm': 'size-8',\r\n        'icon-lg': 'size-10',\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: 'default',\r\n      size: 'default',\r\n    },\r\n  },\r\n)\r\n\r\nfunction Button({\r\n  className,\r\n  variant,\r\n  size,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<'button'> &\r\n  VariantProps<typeof buttonVariants> & {\r\n    asChild?: boolean\r\n  }) {\r\n  const Comp = asChild ? Slot : 'button'\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"button\"\r\n      className={cn(buttonVariants({ variant, size, className }))}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Button, buttonVariants }\r\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,qPAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,+SAAI,GAAG;IAE9B,qBACE,4TAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf;KAnBS"}},
    {"offset": {"line": 424, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sinan/sola/app/scheduled-records/page.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport { Navigation } from \"@/components/navigation\"\r\nimport { canEditPage, UserRole } from \"@/lib/permissions\"\r\nimport { getCurrentSystemUser } from \"@/lib/storage\"\r\nimport { getSharedMonthYear, setSharedMonthYear } from \"@/lib/shared-state\"\r\nimport { Button } from \"@/components/ui/button\"\r\n\r\nconst MONTHS = [\r\n  \"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\r\n  \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\r\n]\r\n\r\ninterface ScheduledRecord {\r\n  id: string\r\n  purchaseDate: string\r\n  description: string\r\n  currency: string\r\n  amount: number\r\n  usdAmount: number\r\n  usefulMonths: number\r\n  monthlyCost: number\r\n  disposalDate?: string\r\n  isFinished: boolean\r\n  isEditing?: boolean\r\n}\r\n\r\nexport default function ScheduledRecordsPage() {\r\n  const [currentUserRole, setCurrentUserRole] = React.useState<UserRole | null>(null)\r\n  const [selectedMonth, setSelectedMonth] = React.useState<number>(() => {\r\n    // Load saved month from localStorage or use current month\r\n    if (typeof window !== 'undefined') {\r\n      const savedMonth = localStorage.getItem('sola-selected-month')\r\n      return savedMonth !== null ? parseInt(savedMonth) : new Date().getMonth()\r\n    }\r\n    return new Date().getMonth()\r\n  })\r\n  const [selectedYear, setSelectedYear] = React.useState<number>(() => {\r\n    // Load saved year from localStorage or use current year\r\n    if (typeof window !== 'undefined') {\r\n      const savedYear = localStorage.getItem('sola-selected-year')\r\n      return savedYear !== null ? parseInt(savedYear) : new Date().getFullYear()\r\n    }\r\n    return new Date().getFullYear()\r\n  })\r\n  const [selectedEntity, setSelectedEntity] = React.useState<string | null>(null)\r\n  const [showEntityUsers, setShowEntityUsers] = React.useState<boolean>(false)\r\n  const [descriptionFilter, setDescriptionFilter] = React.useState<string>('')\r\n  const [showFinished, setShowFinished] = React.useState<boolean>(false)\r\n  const [collapsedTables, setCollapsedTables] = React.useState<Record<string, boolean>>(() => {\r\n  // Initialize all tables as collapsed by default\r\n  const initialCollapsed: Record<string, boolean> = {}\r\n  const tableConfigs = [\r\n    { key: 'fixed-asset', name: 'Fixed Asset', accountCode: '' },\r\n    { key: 'prepaid-rent', name: 'Prepaid Rent', accountCode: '471 9005' },\r\n    { key: 'prepaid-expenses', name: 'Prepaid Expenses', accountCode: '471 9002' },\r\n    { key: 'other-insurances', name: 'Other Insurances', accountCode: '471 9001' },\r\n    { key: 'life-insurance', name: 'Life Insurance', accountCode: '471 9004' },\r\n    { key: 'medical-insurance', name: 'Medical Insurance', accountCode: '471 9003' }\r\n  ]\r\n  tableConfigs.forEach(config => {\r\n    initialCollapsed[config.key] = true\r\n  })\r\n  return initialCollapsed\r\n})\r\n  const [tableRecords, setTableRecords] = React.useState<Record<string, ScheduledRecord[]>>({})\r\n  const [isClient, setIsClient] = React.useState<boolean>(false)\r\n\r\n  // Save month/year to localStorage when they change\r\n  React.useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      localStorage.setItem('sola-selected-month', selectedMonth.toString())\r\n      localStorage.setItem('sola-selected-year', selectedYear.toString())\r\n    }\r\n  }, [selectedMonth, selectedYear])\r\n\r\n  // Handle client-side hydration\r\n  React.useEffect(() => {\r\n    setIsClient(true)\r\n    \r\n    // Load user role\r\n    const systemUser = getCurrentSystemUser()\r\n    if (systemUser) {\r\n      setCurrentUserRole(systemUser.role)\r\n    }\r\n  }, [])\r\n\r\n  // Load records from localStorage for each table\r\n  React.useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const allTableRecords: Record<string, ScheduledRecord[]> = {}\r\n      tableConfigs.forEach(config => {\r\n        const savedRecords = localStorage.getItem(`sola-scheduled-records-${config.key}`)\r\n        if (savedRecords) {\r\n          try {\r\n            allTableRecords[config.key] = JSON.parse(savedRecords)\r\n          } catch (error) {\r\n            console.error(`Error parsing ${config.name} records:`, error)\r\n            allTableRecords[config.key] = []\r\n          }\r\n        } else {\r\n          allTableRecords[config.key] = []\r\n        }\r\n      })\r\n      setTableRecords(allTableRecords)\r\n    }\r\n  }, []) // Load on mount only\r\n\r\n  // Save records to localStorage for each table\r\n  React.useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      Object.entries(tableRecords).forEach(([tableKey, records]) => {\r\n        localStorage.setItem(`sola-scheduled-records-${tableKey}`, JSON.stringify(records))\r\n      })\r\n    }\r\n  }, [tableRecords]) // Save when tableRecords change\r\n\r\n  // Add new record to a specific table\r\n  const addRecord = (tableKey: string) => {\r\n    const newRecord: ScheduledRecord = {\r\n      id: Date.now().toString(),\r\n      purchaseDate: new Date().toISOString().split('T')[0],\r\n      description: '',\r\n      currency: 'USD',\r\n      amount: 0,\r\n      usdAmount: 0,\r\n      usefulMonths: 12,\r\n      monthlyCost: 0,\r\n      disposalDate: '',\r\n      isFinished: false,\r\n      isEditing: true\r\n    }\r\n    \r\n    setTableRecords(prev => ({\r\n      ...prev,\r\n      [tableKey]: [...(prev[tableKey] || []), newRecord]\r\n    }))\r\n  }\r\n\r\n  // Update record in a specific table\r\n  const updateRecord = (tableKey: string, recordId: string, field: keyof ScheduledRecord, value: any) => {\r\n    setTableRecords(prev => ({\r\n      ...prev,\r\n      [tableKey]: prev[tableKey].map(record => {\r\n        if (record.id === recordId) {\r\n          const updatedRecord = { ...record, [field]: value }\r\n          \r\n          // Auto-calculate monthly cost and USD amount\r\n          if (field === 'amount' || field === 'usdAmount' || field === 'usefulMonths') {\r\n            const usdAmount = field === 'usdAmount' ? value : updatedRecord.usdAmount\r\n            const usefulMonths = field === 'usefulMonths' ? value : updatedRecord.usefulMonths\r\n            updatedRecord.monthlyCost = usefulMonths > 0 ? usdAmount / usefulMonths : 0\r\n          }\r\n          \r\n          return updatedRecord\r\n        }\r\n        return record\r\n      })\r\n    }))\r\n  }\r\n\r\n  // Toggle edit mode for a record in a specific table\r\n  const toggleEdit = (tableKey: string, recordId: string) => {\r\n    setTableRecords(prev => ({\r\n      ...prev,\r\n      [tableKey]: prev[tableKey].map(record => \r\n        record.id === recordId ? { ...record, isEditing: !record.isEditing } : record\r\n      )\r\n    }))\r\n  }\r\n\r\n  // Save record (exit edit mode) in a specific table\r\n  const saveRecord = (tableKey: string, recordId: string) => {\r\n    setTableRecords(prev => ({\r\n      ...prev,\r\n      [tableKey]: prev[tableKey].map(record => \r\n        record.id === recordId ? { ...record, isEditing: false } : record\r\n      )\r\n    }))\r\n  }\r\n\r\n  // Delete record from a specific table\r\n  const deleteRecord = (tableKey: string, recordId: string) => {\r\n    setTableRecords(prev => ({\r\n      ...prev,\r\n      [tableKey]: prev[tableKey].filter(record => record.id !== recordId)\r\n    }))\r\n  }\r\n\r\n  // Toggle table collapse\r\n  const toggleCollapse = (tableKey: string) => {\r\n    setCollapsedTables(prev => ({\r\n      ...prev,\r\n      [tableKey]: !prev[tableKey]\r\n    }))\r\n  }\r\n\r\n  // Table configurations\r\n  const tableConfigs = [\r\n    { key: 'fixed-asset', name: 'Fixed Asset', accountCode: '' },\r\n    { key: 'prepaid-rent', name: 'Prepaid Rent', accountCode: '471 9005' },\r\n    { key: 'prepaid-expenses', name: 'Prepaid Expenses', accountCode: '471 9002' },\r\n    { key: 'other-insurances', name: 'Other Insurances', accountCode: '471 9001' },\r\n    { key: 'life-insurance', name: 'Life Insurance', accountCode: '471 9004' },\r\n    { key: 'medical-insurance', name: 'Medical Insurance', accountCode: '471 9003' }\r\n  ]\r\n\r\n  // Render a single table\r\n  const renderTable = (config: typeof tableConfigs[0]) => {\r\n    const isCollapsed = collapsedTables[config.key] || false\r\n    const currentRecords = tableRecords[config.key] || []\r\n    \r\n    // Calculate remaining balance as of selected date\r\n    const calculateRemainingBalance = () => {\r\n      let totalRemaining = 0\r\n      const selectedDate = new Date(selectedYear, selectedMonth, 1)\r\n      \r\n      currentRecords.forEach(record => {\r\n        // Skip finished records\r\n        if (record.isFinished) return\r\n        \r\n        const allocations = calculateMonthlyAllocations(record)\r\n        \r\n        // Add allocations for selected month and all future months\r\n        monthColumns.forEach((column, index) => {\r\n          const columnDate = new Date(column.year, column.month, 1)\r\n          if (columnDate >= selectedDate) {\r\n            totalRemaining += allocations[column.key] || 0\r\n          }\r\n        })\r\n      })\r\n      \r\n      return totalRemaining\r\n    }\r\n    \r\n    const remainingBalance = calculateRemainingBalance()\r\n    \r\n    // Filter records for this table (moved outside of useMemo)\r\n    const getFilteredRecords = () => {\r\n      let filtered = currentRecords\r\n      \r\n      // Handle showFinished filter\r\n      if (showFinished) {\r\n        // Show all records when \"Show Finished\" is checked\r\n        return filtered\r\n      } else {\r\n        // Show only unfinished records when \"Show Finished\" is unchecked\r\n        return filtered.filter(record => !record.isFinished)\r\n      }\r\n    }\r\n\r\n    const filteredRecords = getFilteredRecords()\r\n\r\n    // Check if any record is in edit mode for this table\r\n    const hasEditingRecord = currentRecords.some(record => record.isEditing)\r\n\r\n    // Calculate totals for this table\r\n    const calculateTotals = () => {\r\n      const totals: Record<string, number> = { usdAmount: 0, monthlyCost: 0 }\r\n      \r\n      // Calculate USD Amount and Monthly Cost totals\r\n      currentRecords.forEach(record => {\r\n        totals.usdAmount += record.usdAmount\r\n        totals.monthlyCost += record.monthlyCost\r\n      })\r\n      \r\n      // Calculate totals for each month column\r\n      monthColumns.forEach(column => {\r\n        totals[column.key] = 0\r\n        currentRecords.forEach(record => {\r\n          const allocations = calculateMonthlyAllocations(record)\r\n          totals[column.key] += allocations[column.key] || 0\r\n        })\r\n      })\r\n      \r\n      return totals\r\n    }\r\n\r\n    // Calculate balance for this table\r\n    const calculateBalances = () => {\r\n      const balances: Record<string, number> = {}\r\n      \r\n      monthColumns.forEach((column, index) => {\r\n        let remainingTotal = 0\r\n        currentRecords.forEach(record => {\r\n          const allocations = calculateMonthlyAllocations(record)\r\n          \r\n          // Add allocations for this month and all future months\r\n          for (let i = index; i < monthColumns.length; i++) {\r\n            const futureColumn = monthColumns[i]\r\n            remainingTotal += allocations[futureColumn.key] || 0\r\n          }\r\n        })\r\n        \r\n        balances[column.key] = remainingTotal\r\n      })\r\n      \r\n      return balances\r\n    }\r\n\r\n    // Calculate total carried over for this table\r\n    const calculateTotalCarriedOver = () => {\r\n      let totalCarriedOver = 0\r\n      currentRecords.forEach(record => {\r\n        totalCarriedOver += calculateCarriedOver(record)\r\n      })\r\n      return totalCarriedOver\r\n    }\r\n\r\n    const totals = calculateTotals()\r\n    const balances = calculateBalances()\r\n    \r\n    return (\r\n      <div key={config.key} className=\"mb-8\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <div>\r\n            <h3 className=\"text-xl font-bold text-gray-900\">\r\n              {config.name}\r\n              {config.accountCode && <span className=\"ml-2 text-sm text-gray-500\">({config.accountCode})</span>}\r\n              <span className=\"ml-2 text-sm text-blue-600 font-medium\">(${remainingBalance.toFixed(2)})</span>\r\n            </h3>\r\n          </div>\r\n          <div className=\"flex items-center gap-2\">\r\n            {canEdit && (\r\n              <Button onClick={() => addRecord(config.key)} variant=\"outline\" size=\"sm\">\r\n                + Add Record\r\n              </Button>\r\n            )}\r\n            <button\r\n              onClick={() => toggleCollapse(config.key)}\r\n              className=\"flex items-center gap-2 px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50\"\r\n            >\r\n              {isCollapsed ? (\r\n                <>\r\n                  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\r\n                  </svg>\r\n                  Expand\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 15l7-7 7 7\" />\r\n                  </svg>\r\n                  Collapse\r\n                </>\r\n              )}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {!isCollapsed && (\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"w-full border-collapse border border-gray-300 text-xs\">\r\n              <thead>\r\n                <tr>\r\n                  <th className=\"border border-gray-300 p-1 bg-gray-50 text-left text-xs font-semibold w-20\">Purchase Date</th>\r\n                  <th className=\"border border-gray-300 p-1 bg-gray-50 text-left text-xs font-semibold\">Description</th>\r\n                  <th className=\"border border-gray-300 p-1 bg-gray-50 text-left text-xs font-semibold w-16\">Currency</th>\r\n                  <th className=\"border border-gray-300 p-1 bg-gray-50 text-right text-xs font-semibold w-20\">Amount</th>\r\n                  <th className=\"border border-gray-300 p-1 bg-gray-50 text-right text-xs font-semibold w-20\">USD Amount</th>\r\n                  <th className=\"border border-gray-300 p-1 bg-gray-50 text-center text-xs font-semibold w-16\">Useful</th>\r\n                  <th className=\"border border-gray-300 p-1 bg-gray-50 text-right text-xs font-semibold w-20\">Monthly</th>\r\n                  <th className=\"border border-gray-300 p-1 bg-gray-50 text-right text-xs font-semibold w-20\">Carried</th>\r\n                  {hasEditingRecord && (\r\n                    <th className=\"border border-gray-300 p-1 bg-gray-50 text-left text-xs font-semibold w-20\">Disposal</th>\r\n                  )}\r\n                  {hasEditingRecord && (\r\n                    <th className=\"border border-gray-300 p-1 bg-gray-50 text-center text-xs font-semibold w-12\">Done</th>\r\n                  )}\r\n                  {monthColumns.map(column => (\r\n                    <th key={`${config.key}-${column.key}`} className=\"border border-gray-300 p-1 bg-gray-50 text-right text-xs font-semibold whitespace-nowrap w-14\">\r\n                      {column.label}\r\n                    </th>\r\n                  ))}\r\n                  <th className=\"border border-gray-300 p-1 bg-gray-50 text-center text-xs font-semibold w-16\">Actions</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {filteredRecords.map((record) => {\r\n                  const allocations = calculateMonthlyAllocations(record)\r\n                  const carriedOver = calculateCarriedOver(record)\r\n                  const hasDisposalDate = record.disposalDate && record.disposalDate !== ''\r\n                  const isFinished = record.isFinished\r\n                  return (\r\n                    <tr key={`${config.key}-${record.id}`} className={\r\n                      hasDisposalDate ? 'bg-red-50' : \r\n                      isFinished ? 'bg-gray-100' : ''\r\n                    }>\r\n                      <td className=\"border border-gray-300 p-0.5 w-20\">\r\n                        {canEdit && record.isEditing ? (\r\n                          <input\r\n                            type=\"date\"\r\n                            value={record.purchaseDate}\r\n                            onChange={(e) => updateRecord(config.key, record.id, 'purchaseDate', e.target.value)}\r\n                            className=\"w-full border-0 bg-transparent focus:outline-none focus:ring-1 focus:ring-blue-500 rounded text-xs\"\r\n                          />\r\n                        ) : (\r\n                          <span className=\"text-xs\">{record.purchaseDate}</span>\r\n                        )}\r\n                      </td>\r\n                      <td className=\"border border-gray-300 p-0.5\">\r\n                        {canEdit && record.isEditing ? (\r\n                          <input\r\n                            type=\"text\"\r\n                            value={record.description}\r\n                            onChange={(e) => updateRecord(config.key, record.id, 'description', e.target.value)}\r\n                            className=\"w-full border-0 bg-transparent focus:outline-none focus:ring-1 focus:ring-blue-500 rounded text-xs\"\r\n                            placeholder=\"Enter description\"\r\n                          />\r\n                        ) : (\r\n                          <span className=\"text-xs\">{record.description}</span>\r\n                        )}\r\n                      </td>\r\n                      <td className=\"border border-gray-300 p-0.5 w-16\">\r\n                        {canEdit && record.isEditing ? (\r\n                          <input\r\n                            type=\"text\"\r\n                            value={record.currency}\r\n                            onChange={(e) => updateRecord(config.key, record.id, 'currency', e.target.value)}\r\n                            className=\"w-full border-0 bg-transparent focus:outline-none focus:ring-1 focus:ring-blue-500 rounded text-xs text-center\"\r\n                            placeholder=\"USD\"\r\n                            maxLength={3}\r\n                          />\r\n                        ) : (\r\n                          <span className=\"text-xs text-center block\">{record.currency}</span>\r\n                        )}\r\n                      </td>\r\n                      <td className=\"border border-gray-300 p-0.5 w-20\">\r\n                        {canEdit && record.isEditing ? (\r\n                          <input\r\n                            type=\"number\"\r\n                            value={record.amount}\r\n                            onChange={(e) => updateRecord(config.key, record.id, 'amount', parseFloat(e.target.value) || 0)}\r\n                            className=\"w-full text-right border-0 bg-transparent focus:outline-none focus:ring-1 focus:ring-blue-500 rounded text-xs\"\r\n                            placeholder=\"0.00\"\r\n                            step=\"0.01\"\r\n                            min=\"0\"\r\n                          />\r\n                        ) : (\r\n                          <span className=\"text-xs text-right block\">{record.amount.toFixed(2)}</span>\r\n                        )}\r\n                      </td>\r\n                      <td className=\"border border-gray-300 p-0.5 w-20\">\r\n                        {canEdit && record.isEditing ? (\r\n                          <input\r\n                            type=\"number\"\r\n                            value={record.usdAmount}\r\n                            onChange={(e) => updateRecord(config.key, record.id, 'usdAmount', parseFloat(e.target.value) || 0)}\r\n                            className=\"w-full text-right border-0 bg-transparent focus:outline-none focus:ring-1 focus:ring-blue-500 rounded text-xs\"\r\n                            placeholder=\"0.00\"\r\n                            step=\"0.01\"\r\n                            min=\"0\"\r\n                          />\r\n                        ) : (\r\n                          <span className=\"text-xs text-right block\">{record.usdAmount.toFixed(2)}</span>\r\n                        )}\r\n                      </td>\r\n                      <td className=\"border border-gray-300 p-0.5 w-16\">\r\n                        {canEdit && record.isEditing ? (\r\n                          <input\r\n                            type=\"number\"\r\n                            value={record.usefulMonths}\r\n                            onChange={(e) => updateRecord(config.key, record.id, 'usefulMonths', parseInt(e.target.value) || 1)}\r\n                            className=\"w-full text-center border-0 bg-transparent focus:outline-none focus:ring-1 focus:ring-blue-500 rounded text-xs\"\r\n                            min=\"1\"\r\n                            max=\"360\"\r\n                          />\r\n                        ) : (\r\n                          <span className=\"text-xs\">{record.usefulMonths}</span>\r\n                        )}\r\n                      </td>\r\n                      <td className=\"border border-gray-300 p-0.5 w-20 text-right\">\r\n                        <span className=\"text-xs\">{record.monthlyCost.toFixed(2)}</span>\r\n                      </td>\r\n                      <td className=\"border border-gray-300 p-0.5 w-20 text-right\">\r\n                        <span className=\"text-xs\">{carriedOver.toFixed(2)}</span>\r\n                      </td>\r\n                      {hasEditingRecord && (\r\n                        <td className=\"border border-gray-300 p-0.5 w-20\">\r\n                          {canEdit && record.isEditing ? (\r\n                            <input\r\n                              type=\"date\"\r\n                              value={record.disposalDate || ''}\r\n                              onChange={(e) => updateRecord(config.key, record.id, 'disposalDate', e.target.value)}\r\n                              className=\"w-full border-0 bg-transparent focus:outline-none focus:ring-1 focus:ring-blue-500 rounded text-xs\"\r\n                            />\r\n                          ) : (\r\n                            <span className=\"text-xs\">{record.disposalDate || ''}</span>\r\n                          )}\r\n                        </td>\r\n                      )}\r\n                      {hasEditingRecord && (\r\n                        <td className=\"border border-gray-300 p-0.5 w-12 text-center\">\r\n                          {canEdit && (\r\n                            <input\r\n                              type=\"checkbox\"\r\n                              checked={record.isFinished}\r\n                              onChange={(e) => updateRecord(config.key, record.id, 'isFinished', e.target.checked)}\r\n                              className=\"w-3 h-3 text-blue-600 rounded focus:ring-blue-500\"\r\n                            />\r\n                          )}\r\n                        </td>\r\n                      )}\r\n                      {monthColumns.map(column => (\r\n                        <td key={`${config.key}-${column.key}`} className=\"border border-gray-300 p-0.5 text-right w-14\">\r\n                          <span className=\"text-xs\">{allocations[column.key]?.toFixed(2) || ''}</span>\r\n                        </td>\r\n                      ))}\r\n                      <td className=\"border border-gray-300 p-0.5 text-center w-16\">\r\n                        {canEdit && (\r\n                          <>\r\n                            {record.isEditing ? (\r\n                              <div className=\"flex gap-1 justify-center\">\r\n                                <Button\r\n                                  onClick={() => saveRecord(config.key, record.id)}\r\n                                  variant=\"outline\"\r\n                                  size=\"sm\"\r\n                                  className=\"text-green-600 hover:text-green-800 text-xs px-1 py-0.5 h-5\"\r\n                                >\r\n                                  Save\r\n                                </Button>\r\n                                <Button\r\n                                  onClick={() => deleteRecord(config.key, record.id)}\r\n                                  variant=\"outline\"\r\n                                  size=\"sm\"\r\n                                  className=\"text-red-600 hover:text-red-800 text-xs px-1 py-0.5 h-5\"\r\n                                >\r\n                                  Del\r\n                                </Button>\r\n                              </div>\r\n                            ) : (\r\n                              <Button\r\n                                onClick={() => toggleEdit(config.key, record.id)}\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                className=\"text-blue-600 hover:text-blue-800 text-xs px-1 py-0.5 h-5\"\r\n                              >\r\n                                Edit\r\n                              </Button>\r\n                            )}\r\n                          </>\r\n                        )}\r\n                      </td>\r\n                    </tr>\r\n                  )\r\n                })}\r\n                \r\n                {/* Totals Row */}\r\n                <tr className=\"bg-gray-50 font-semibold\">\r\n                  <td className=\"border border-gray-300 p-0.5 text-xs text-center\" colSpan={4}>Total</td>\r\n                  <td className=\"border border-gray-300 p-0.5 text-right text-xs w-20\">{totals.usdAmount.toFixed(2)}</td>\r\n                  <td className=\"border border-gray-300 p-0.5 text-center text-xs w-16\">-</td>\r\n                  <td className=\"border border-gray-300 p-0.5 text-right text-xs w-20\">{totals.monthlyCost.toFixed(2)}</td>\r\n                  <td className=\"border border-gray-300 p-0.5 text-right text-xs w-20\">{calculateTotalCarriedOver().toFixed(2)}</td>\r\n                  {hasEditingRecord && (\r\n                    <td className=\"border border-gray-300 p-0.5 text-center text-xs w-20\">-</td>\r\n                  )}\r\n                  {hasEditingRecord && (\r\n                    <td className=\"border border-gray-300 p-0.5 text-center text-xs w-12\">-</td>\r\n                  )}\r\n                  {monthColumns.map(column => (\r\n                    <td key={`total-${config.key}-${column.key}`} className=\"border border-gray-300 p-0.5 text-right text-xs w-14\">\r\n                      {totals[column.key]?.toFixed(2) || '0.00'}\r\n                    </td>\r\n                  ))}\r\n                  <td className=\"border border-gray-300 p-0.5 text-center text-xs w-16\">-</td>\r\n                </tr>\r\n                \r\n                {/* Balance Row */}\r\n                <tr className=\"bg-blue-50 font-semibold\">\r\n                  <td className=\"border border-gray-300 p-0.5 text-xs text-center\" colSpan={8 + (hasEditingRecord ? 2 : 0)}>Balance (Remaining)</td>\r\n                  {monthColumns.map(column => (\r\n                    <td key={`balance-${config.key}-${column.key}`} className=\"border border-gray-300 p-0.5 text-right text-xs w-14\">\r\n                      {balances[column.key]?.toFixed(2) || '0.00'}\r\n                    </td>\r\n                  ))}\r\n                  <td className=\"border border-gray-300 p-0.5 text-center text-xs w-16\">-</td>\r\n                </tr>\r\n                \r\n                {filteredRecords.length === 0 && (\r\n                  <tr>\r\n                    <td colSpan={8 + (hasEditingRecord ? 2 : 0) + monthColumns.length} className=\"border border-gray-300 p-8 text-center text-gray-500\">\r\n                      {showFinished \r\n                        ? 'No records found.' \r\n                        : 'No unfinished records found. Click \\'Show Finished\\' to see all records.'\r\n                      }\r\n                    </td>\r\n                  </tr>\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        )}\r\n      </div>\r\n    )\r\n  }\r\n  const calculateMonthlyAllocations = (record: ScheduledRecord) => {\r\n    const allocations: Record<string, number> = {}\r\n    \r\n    if (!record.purchaseDate || record.usefulMonths <= 0 || record.monthlyCost <= 0) {\r\n      return allocations\r\n    }\r\n\r\n    // If disposal date is set, keep previous months same and allocate remaining to disposal month\r\n    if (record.disposalDate) {\r\n      const disposalDateObj = new Date(record.disposalDate)\r\n      const purchaseDate = new Date(record.purchaseDate)\r\n      \r\n      // Calculate the month number for each date (0 = purchase month)\r\n      const getMonthNumber = (date: Date) => {\r\n        let yearDiff = date.getFullYear() - purchaseDate.getFullYear()\r\n        let monthDiff = date.getMonth() - purchaseDate.getMonth()\r\n        return yearDiff * 12 + monthDiff\r\n      }\r\n      \r\n      const disposalMonthNumber = getMonthNumber(disposalDateObj)\r\n      \r\n      monthColumns.forEach(column => {\r\n        const columnDate = new Date(column.year, column.month, 1)\r\n        const columnMonthNumber = getMonthNumber(columnDate)\r\n        \r\n        if (columnMonthNumber < 0) {\r\n          // Before purchase date: 0\r\n          allocations[column.key] = 0\r\n        } else if (columnMonthNumber < disposalMonthNumber) {\r\n          // Before disposal date: normal monthly cost (if within useful months)\r\n          if (columnMonthNumber < record.usefulMonths) {\r\n            allocations[column.key] = record.monthlyCost\r\n          } else {\r\n            allocations[column.key] = 0\r\n          }\r\n        } else if (columnMonthNumber === disposalMonthNumber) {\r\n          // Disposal month: remaining amount\r\n          const monthsAllocatedBefore = Math.min(disposalMonthNumber, record.usefulMonths)\r\n          const alreadyAllocated = monthsAllocatedBefore * record.monthlyCost\r\n          const remainingAmount = record.usdAmount - alreadyAllocated\r\n          allocations[column.key] = remainingAmount\r\n        } else {\r\n          // After disposal date: 0\r\n          allocations[column.key] = 0\r\n        }\r\n      })\r\n      \r\n      return allocations\r\n    }\r\n\r\n    // Normal allocation logic\r\n    const purchaseDate = new Date(record.purchaseDate)\r\n    const startMonth = purchaseDate.getMonth()\r\n    const startYear = purchaseDate.getFullYear()\r\n    \r\n    // Show allocation in every month column based on finished status\r\n    monthColumns.forEach(column => {\r\n      const columnDate = new Date(column.year, column.month, 1)\r\n      \r\n      // If not finished, show in all future months from purchase date\r\n      if (!record.isFinished && columnDate >= purchaseDate) {\r\n        let monthsElapsed = 0\r\n        let currentMonth = startMonth\r\n        let currentYear = startYear\r\n        \r\n        while (currentYear < column.year || (currentYear === column.year && currentMonth <= column.month)) {\r\n          if (monthsElapsed < record.usefulMonths) {\r\n            allocations[column.key] = record.monthlyCost\r\n          } else {\r\n            allocations[column.key] = 0 // Show 0 after useful months\r\n          }\r\n          monthsElapsed++\r\n          currentMonth++\r\n          if (currentMonth > 11) {\r\n            currentMonth = 0\r\n            currentYear++\r\n          }\r\n        }\r\n      } else if (record.isFinished) {\r\n        // If finished, don't show any allocations\r\n        allocations[column.key] = 0\r\n      } else {\r\n        // Before purchase date\r\n        allocations[column.key] = 0\r\n      }\r\n    })\r\n    \r\n    return allocations\r\n  }\r\n\r\n  // Calculate carried over amounts for each record (total of upcoming months)\r\n  const calculateCarriedOver = (record: ScheduledRecord) => {\r\n    const allocations = calculateMonthlyAllocations(record)\r\n    let upcomingTotal = 0\r\n    \r\n    // Calculate total of upcoming months from selected month filter\r\n    const selectedDate = new Date(selectedYear, selectedMonth, 1)\r\n    const purchaseDate = new Date(record.purchaseDate)\r\n    \r\n    // Only calculate for records that are not finished and purchase date is before or at selected month\r\n    if (!record.isFinished && purchaseDate <= selectedDate) {\r\n      monthColumns.forEach(column => {\r\n        const columnDate = new Date(column.year, column.month, 1)\r\n        \r\n        // Add allocations for this month and all future months\r\n        if (columnDate >= selectedDate && allocations[column.key] && allocations[column.key] > 0) {\r\n          upcomingTotal += allocations[column.key]\r\n        }\r\n      })\r\n    }\r\n    \r\n    return upcomingTotal\r\n  }\r\n\r\n  // Generate 12 month columns starting from selected month\r\n  const generateMonthColumns = () => {\r\n    const columns = []\r\n    let currentMonth = selectedMonth\r\n    let currentYear = selectedYear\r\n    \r\n    for (let i = 0; i < 12; i++) {\r\n      const monthKey = `${currentYear}-${currentMonth}`\r\n      columns.push({\r\n        key: monthKey,\r\n        label: `${MONTHS[currentMonth].substring(0, 3)} ${currentYear.toString().substring(2)}`,\r\n        month: currentMonth,\r\n        year: currentYear\r\n      })\r\n      \r\n      currentMonth++\r\n      if (currentMonth > 11) {\r\n        currentMonth = 0\r\n        currentYear++\r\n      }\r\n    }\r\n    \r\n    return columns\r\n  }\r\n\r\n  const monthColumns = generateMonthColumns()\r\n\r\n  // Check if current user has permission for editing\r\n  const canEdit = currentUserRole ? canEditPage(currentUserRole, 'scheduledRecords') : false\r\n\r\n  if (!isClient) {\r\n    return null\r\n  }\r\n\r\n  return (\r\n    <main className=\"min-h-screen bg-background\">\r\n      <Navigation currentPage=\"/scheduled-records\" />\r\n      <div className=\"flex justify-between items-center mb-4 p-6\">\r\n        <h2 className=\"text-xl font-semibold text-gray-800\">Scheduled Records</h2>\r\n        <div className=\"flex gap-3 items-end\">\r\n          <div className=\"space-y-1\">\r\n            <label className=\"block text-xs font-medium\">Start Month</label>\r\n            <select\r\n              value={selectedMonth}\r\n              onChange={(e) => setSelectedMonth(Number(e.target.value))}\r\n              className=\"border border-gray-300 rounded px-2 py-1 text-sm\"\r\n            >\r\n              {MONTHS.map((month, idx) => (\r\n                <option key={idx} value={idx}>{month}</option>\r\n              ))}\r\n            </select>\r\n            <select\r\n              value={selectedYear}\r\n              onChange={(e) => setSelectedYear(Number(e.target.value))}\r\n              className=\"border border-gray-300 rounded px-2 py-1 text-sm\"\r\n            >\r\n              {Array.from({ length: 10 }, (_, i) => new Date().getFullYear() - 5 + i).map((year: number) => (\r\n                <option key={year} value={year}>{year}</option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n\r\n          <div className=\"flex gap-4\">\r\n            <label className=\"flex items-center gap-2 text-sm\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={showFinished}\r\n                onChange={(e) => setShowFinished(e.target.checked)}\r\n                className=\"w-4 h-4 text-blue-600 rounded focus:ring-blue-500\"\r\n              />\r\n              Show Finished\r\n            </label>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"p-6\">\r\n        {/* Render all tables */}\r\n        {tableConfigs.map(config => renderTable(config))}\r\n      </div>\r\n    </main>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAEA;;;AAPA;;;;;;AASA,MAAM,SAAS;IACb;IAAW;IAAY;IAAS;IAAS;IAAO;IAChD;IAAQ;IAAU;IAAa;IAAW;IAAY;CACvD;AAgBc,SAAS;;IACtB,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,wSAAc,CAAkB;IAC9E,MAAM,CAAC,eAAe,iBAAiB,GAAG,wSAAc;yCAAS;YAC/D,0DAA0D;YAC1D,wCAAmC;gBACjC,MAAM,aAAa,aAAa,OAAO,CAAC;gBACxC,OAAO,eAAe,OAAO,SAAS,cAAc,IAAI,OAAO,QAAQ;YACzE;;;QAEF;;IACA,MAAM,CAAC,cAAc,gBAAgB,GAAG,wSAAc;yCAAS;YAC7D,wDAAwD;YACxD,wCAAmC;gBACjC,MAAM,YAAY,aAAa,OAAO,CAAC;gBACvC,OAAO,cAAc,OAAO,SAAS,aAAa,IAAI,OAAO,WAAW;YAC1E;;;QAEF;;IACA,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,wSAAc,CAAgB;IAC1E,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,wSAAc,CAAU;IACtE,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,wSAAc,CAAS;IACzE,MAAM,CAAC,cAAc,gBAAgB,GAAG,wSAAc,CAAU;IAChE,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,wSAAc;yCAA0B;YACtF,gDAAgD;YAChD,MAAM,mBAA4C,CAAC;YACnD,MAAM,eAAe;gBACnB;oBAAE,KAAK;oBAAe,MAAM;oBAAe,aAAa;gBAAG;gBAC3D;oBAAE,KAAK;oBAAgB,MAAM;oBAAgB,aAAa;gBAAW;gBACrE;oBAAE,KAAK;oBAAoB,MAAM;oBAAoB,aAAa;gBAAW;gBAC7E;oBAAE,KAAK;oBAAoB,MAAM;oBAAoB,aAAa;gBAAW;gBAC7E;oBAAE,KAAK;oBAAkB,MAAM;oBAAkB,aAAa;gBAAW;gBACzE;oBAAE,KAAK;oBAAqB,MAAM;oBAAqB,aAAa;gBAAW;aAChF;YACD,aAAa,OAAO;iDAAC,CAAA;oBACnB,gBAAgB,CAAC,OAAO,GAAG,CAAC,GAAG;gBACjC;;YACA,OAAO;QACT;;IACE,MAAM,CAAC,cAAc,gBAAgB,GAAG,wSAAc,CAAoC,CAAC;IAC3F,MAAM,CAAC,UAAU,YAAY,GAAG,wSAAc,CAAU;IAExD,mDAAmD;IACnD,ySAAe;0CAAC;YACd,wCAAmC;gBACjC,aAAa,OAAO,CAAC,uBAAuB,cAAc,QAAQ;gBAClE,aAAa,OAAO,CAAC,sBAAsB,aAAa,QAAQ;YAClE;QACF;yCAAG;QAAC;QAAe;KAAa;IAEhC,+BAA+B;IAC/B,ySAAe;0CAAC;YACd,YAAY;YAEZ,iBAAiB;YACjB,MAAM,aAAa,IAAA,yIAAoB;YACvC,IAAI,YAAY;gBACd,mBAAmB,WAAW,IAAI;YACpC;QACF;yCAAG,EAAE;IAEL,gDAAgD;IAChD,ySAAe;0CAAC;YACd,wCAAmC;gBACjC,MAAM,kBAAqD,CAAC;gBAC5D,aAAa,OAAO;sDAAC,CAAA;wBACnB,MAAM,eAAe,aAAa,OAAO,CAAC,CAAC,uBAAuB,EAAE,OAAO,GAAG,EAAE;wBAChF,IAAI,cAAc;4BAChB,IAAI;gCACF,eAAe,CAAC,OAAO,GAAG,CAAC,GAAG,KAAK,KAAK,CAAC;4BAC3C,EAAE,OAAO,OAAO;gCACd,QAAQ,KAAK,CAAC,CAAC,cAAc,EAAE,OAAO,IAAI,CAAC,SAAS,CAAC,EAAE;gCACvD,eAAe,CAAC,OAAO,GAAG,CAAC,GAAG,EAAE;4BAClC;wBACF,OAAO;4BACL,eAAe,CAAC,OAAO,GAAG,CAAC,GAAG,EAAE;wBAClC;oBACF;;gBACA,gBAAgB;YAClB;QACF;yCAAG,EAAE,GAAE,qBAAqB;IAE5B,8CAA8C;IAC9C,ySAAe;0CAAC;YACd,wCAAmC;gBACjC,OAAO,OAAO,CAAC,cAAc,OAAO;sDAAC,CAAC,CAAC,UAAU,QAAQ;wBACvD,aAAa,OAAO,CAAC,CAAC,uBAAuB,EAAE,UAAU,EAAE,KAAK,SAAS,CAAC;oBAC5E;;YACF;QACF;yCAAG;QAAC;KAAa,GAAE,gCAAgC;IAEnD,qCAAqC;IACrC,MAAM,YAAY,CAAC;QACjB,MAAM,YAA6B;YACjC,IAAI,KAAK,GAAG,GAAG,QAAQ;YACvB,cAAc,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;YACpD,aAAa;YACb,UAAU;YACV,QAAQ;YACR,WAAW;YACX,cAAc;YACd,aAAa;YACb,cAAc;YACd,YAAY;YACZ,WAAW;QACb;QAEA,gBAAgB,CAAA,OAAQ,CAAC;gBACvB,GAAG,IAAI;gBACP,CAAC,SAAS,EAAE;uBAAK,IAAI,CAAC,SAAS,IAAI,EAAE;oBAAG;iBAAU;YACpD,CAAC;IACH;IAEA,oCAAoC;IACpC,MAAM,eAAe,CAAC,UAAkB,UAAkB,OAA8B;QACtF,gBAAgB,CAAA,OAAQ,CAAC;gBACvB,GAAG,IAAI;gBACP,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAA;oBAC7B,IAAI,OAAO,EAAE,KAAK,UAAU;wBAC1B,MAAM,gBAAgB;4BAAE,GAAG,MAAM;4BAAE,CAAC,MAAM,EAAE;wBAAM;wBAElD,6CAA6C;wBAC7C,IAAI,UAAU,YAAY,UAAU,eAAe,UAAU,gBAAgB;4BAC3E,MAAM,YAAY,UAAU,cAAc,QAAQ,cAAc,SAAS;4BACzE,MAAM,eAAe,UAAU,iBAAiB,QAAQ,cAAc,YAAY;4BAClF,cAAc,WAAW,GAAG,eAAe,IAAI,YAAY,eAAe;wBAC5E;wBAEA,OAAO;oBACT;oBACA,OAAO;gBACT;YACF,CAAC;IACH;IAEA,oDAAoD;IACpD,MAAM,aAAa,CAAC,UAAkB;QACpC,gBAAgB,CAAA,OAAQ,CAAC;gBACvB,GAAG,IAAI;gBACP,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAA,SAC7B,OAAO,EAAE,KAAK,WAAW;wBAAE,GAAG,MAAM;wBAAE,WAAW,CAAC,OAAO,SAAS;oBAAC,IAAI;YAE3E,CAAC;IACH;IAEA,mDAAmD;IACnD,MAAM,aAAa,CAAC,UAAkB;QACpC,gBAAgB,CAAA,OAAQ,CAAC;gBACvB,GAAG,IAAI;gBACP,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAA,SAC7B,OAAO,EAAE,KAAK,WAAW;wBAAE,GAAG,MAAM;wBAAE,WAAW;oBAAM,IAAI;YAE/D,CAAC;IACH;IAEA,sCAAsC;IACtC,MAAM,eAAe,CAAC,UAAkB;QACtC,gBAAgB,CAAA,OAAQ,CAAC;gBACvB,GAAG,IAAI;gBACP,CAAC,SAAS,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAA,SAAU,OAAO,EAAE,KAAK;YAC5D,CAAC;IACH;IAEA,wBAAwB;IACxB,MAAM,iBAAiB,CAAC;QACtB,mBAAmB,CAAA,OAAQ,CAAC;gBAC1B,GAAG,IAAI;gBACP,CAAC,SAAS,EAAE,CAAC,IAAI,CAAC,SAAS;YAC7B,CAAC;IACH;IAEA,uBAAuB;IACvB,MAAM,eAAe;QACnB;YAAE,KAAK;YAAe,MAAM;YAAe,aAAa;QAAG;QAC3D;YAAE,KAAK;YAAgB,MAAM;YAAgB,aAAa;QAAW;QACrE;YAAE,KAAK;YAAoB,MAAM;YAAoB,aAAa;QAAW;QAC7E;YAAE,KAAK;YAAoB,MAAM;YAAoB,aAAa;QAAW;QAC7E;YAAE,KAAK;YAAkB,MAAM;YAAkB,aAAa;QAAW;QACzE;YAAE,KAAK;YAAqB,MAAM;YAAqB,aAAa;QAAW;KAChF;IAED,wBAAwB;IACxB,MAAM,cAAc,CAAC;QACnB,MAAM,cAAc,eAAe,CAAC,OAAO,GAAG,CAAC,IAAI;QACnD,MAAM,iBAAiB,YAAY,CAAC,OAAO,GAAG,CAAC,IAAI,EAAE;QAErD,kDAAkD;QAClD,MAAM,4BAA4B;YAChC,IAAI,iBAAiB;YACrB,MAAM,eAAe,IAAI,KAAK,cAAc,eAAe;YAE3D,eAAe,OAAO,CAAC,CAAA;gBACrB,wBAAwB;gBACxB,IAAI,OAAO,UAAU,EAAE;gBAEvB,MAAM,cAAc,4BAA4B;gBAEhD,2DAA2D;gBAC3D,aAAa,OAAO,CAAC,CAAC,QAAQ;oBAC5B,MAAM,aAAa,IAAI,KAAK,OAAO,IAAI,EAAE,OAAO,KAAK,EAAE;oBACvD,IAAI,cAAc,cAAc;wBAC9B,kBAAkB,WAAW,CAAC,OAAO,GAAG,CAAC,IAAI;oBAC/C;gBACF;YACF;YAEA,OAAO;QACT;QAEA,MAAM,mBAAmB;QAEzB,2DAA2D;QAC3D,MAAM,qBAAqB;YACzB,IAAI,WAAW;YAEf,6BAA6B;YAC7B,IAAI,cAAc;gBAChB,mDAAmD;gBACnD,OAAO;YACT,OAAO;gBACL,iEAAiE;gBACjE,OAAO,SAAS,MAAM,CAAC,CAAA,SAAU,CAAC,OAAO,UAAU;YACrD;QACF;QAEA,MAAM,kBAAkB;QAExB,qDAAqD;QACrD,MAAM,mBAAmB,eAAe,IAAI,CAAC,CAAA,SAAU,OAAO,SAAS;QAEvE,kCAAkC;QAClC,MAAM,kBAAkB;YACtB,MAAM,SAAiC;gBAAE,WAAW;gBAAG,aAAa;YAAE;YAEtE,+CAA+C;YAC/C,eAAe,OAAO,CAAC,CAAA;gBACrB,OAAO,SAAS,IAAI,OAAO,SAAS;gBACpC,OAAO,WAAW,IAAI,OAAO,WAAW;YAC1C;YAEA,yCAAyC;YACzC,aAAa,OAAO,CAAC,CAAA;gBACnB,MAAM,CAAC,OAAO,GAAG,CAAC,GAAG;gBACrB,eAAe,OAAO,CAAC,CAAA;oBACrB,MAAM,cAAc,4BAA4B;oBAChD,MAAM,CAAC,OAAO,GAAG,CAAC,IAAI,WAAW,CAAC,OAAO,GAAG,CAAC,IAAI;gBACnD;YACF;YAEA,OAAO;QACT;QAEA,mCAAmC;QACnC,MAAM,oBAAoB;YACxB,MAAM,WAAmC,CAAC;YAE1C,aAAa,OAAO,CAAC,CAAC,QAAQ;gBAC5B,IAAI,iBAAiB;gBACrB,eAAe,OAAO,CAAC,CAAA;oBACrB,MAAM,cAAc,4BAA4B;oBAEhD,uDAAuD;oBACvD,IAAK,IAAI,IAAI,OAAO,IAAI,aAAa,MAAM,EAAE,IAAK;wBAChD,MAAM,eAAe,YAAY,CAAC,EAAE;wBACpC,kBAAkB,WAAW,CAAC,aAAa,GAAG,CAAC,IAAI;oBACrD;gBACF;gBAEA,QAAQ,CAAC,OAAO,GAAG,CAAC,GAAG;YACzB;YAEA,OAAO;QACT;QAEA,8CAA8C;QAC9C,MAAM,4BAA4B;YAChC,IAAI,mBAAmB;YACvB,eAAe,OAAO,CAAC,CAAA;gBACrB,oBAAoB,qBAAqB;YAC3C;YACA,OAAO;QACT;QAEA,MAAM,SAAS;QACf,MAAM,WAAW;QAEjB,qBACE,4TAAC;YAAqB,WAAU;;8BAC9B,4TAAC;oBAAI,WAAU;;sCACb,4TAAC;sCACC,cAAA,4TAAC;gCAAG,WAAU;;oCACX,OAAO,IAAI;oCACX,OAAO,WAAW,kBAAI,4TAAC;wCAAK,WAAU;;4CAA6B;4CAAE,OAAO,WAAW;4CAAC;;;;;;;kDACzF,4TAAC;wCAAK,WAAU;;4CAAyC;4CAAG,iBAAiB,OAAO,CAAC;4CAAG;;;;;;;;;;;;;;;;;;sCAG5F,4TAAC;4BAAI,WAAU;;gCACZ,yBACC,4TAAC,wIAAM;oCAAC,SAAS,IAAM,UAAU,OAAO,GAAG;oCAAG,SAAQ;oCAAU,MAAK;8CAAK;;;;;;8CAI5E,4TAAC;oCACC,SAAS,IAAM,eAAe,OAAO,GAAG;oCACxC,WAAU;8CAET,4BACC;;0DACE,4TAAC;gDAAI,WAAU;gDAAU,MAAK;gDAAO,QAAO;gDAAe,SAAQ;0DACjE,cAAA,4TAAC;oDAAK,eAAc;oDAAQ,gBAAe;oDAAQ,aAAa;oDAAG,GAAE;;;;;;;;;;;4CACjE;;qEAIR;;0DACE,4TAAC;gDAAI,WAAU;gDAAU,MAAK;gDAAO,QAAO;gDAAe,SAAQ;0DACjE,cAAA,4TAAC;oDAAK,eAAc;oDAAQ,gBAAe;oDAAQ,aAAa;oDAAG,GAAE;;;;;;;;;;;4CACjE;;;;;;;;;;;;;;;;;;;;gBAQf,CAAC,6BACA,4TAAC;oBAAI,WAAU;8BACb,cAAA,4TAAC;wBAAM,WAAU;;0CACf,4TAAC;0CACC,cAAA,4TAAC;;sDACC,4TAAC;4CAAG,WAAU;sDAA6E;;;;;;sDAC3F,4TAAC;4CAAG,WAAU;sDAAwE;;;;;;sDACtF,4TAAC;4CAAG,WAAU;sDAA6E;;;;;;sDAC3F,4TAAC;4CAAG,WAAU;sDAA8E;;;;;;sDAC5F,4TAAC;4CAAG,WAAU;sDAA8E;;;;;;sDAC5F,4TAAC;4CAAG,WAAU;sDAA+E;;;;;;sDAC7F,4TAAC;4CAAG,WAAU;sDAA8E;;;;;;sDAC5F,4TAAC;4CAAG,WAAU;sDAA8E;;;;;;wCAC3F,kCACC,4TAAC;4CAAG,WAAU;sDAA6E;;;;;;wCAE5F,kCACC,4TAAC;4CAAG,WAAU;sDAA+E;;;;;;wCAE9F,aAAa,GAAG,CAAC,CAAA,uBAChB,4TAAC;gDAAuC,WAAU;0DAC/C,OAAO,KAAK;+CADN,GAAG,OAAO,GAAG,CAAC,CAAC,EAAE,OAAO,GAAG,EAAE;;;;;sDAIxC,4TAAC;4CAAG,WAAU;sDAA+E;;;;;;;;;;;;;;;;;0CAGjG,4TAAC;;oCACE,gBAAgB,GAAG,CAAC,CAAC;wCACpB,MAAM,cAAc,4BAA4B;wCAChD,MAAM,cAAc,qBAAqB;wCACzC,MAAM,kBAAkB,OAAO,YAAY,IAAI,OAAO,YAAY,KAAK;wCACvE,MAAM,aAAa,OAAO,UAAU;wCACpC,qBACE,4TAAC;4CAAsC,WACrC,kBAAkB,cAClB,aAAa,gBAAgB;;8DAE7B,4TAAC;oDAAG,WAAU;8DACX,WAAW,OAAO,SAAS,iBAC1B,4TAAC;wDACC,MAAK;wDACL,OAAO,OAAO,YAAY;wDAC1B,UAAU,CAAC,IAAM,aAAa,OAAO,GAAG,EAAE,OAAO,EAAE,EAAE,gBAAgB,EAAE,MAAM,CAAC,KAAK;wDACnF,WAAU;;;;;6EAGZ,4TAAC;wDAAK,WAAU;kEAAW,OAAO,YAAY;;;;;;;;;;;8DAGlD,4TAAC;oDAAG,WAAU;8DACX,WAAW,OAAO,SAAS,iBAC1B,4TAAC;wDACC,MAAK;wDACL,OAAO,OAAO,WAAW;wDACzB,UAAU,CAAC,IAAM,aAAa,OAAO,GAAG,EAAE,OAAO,EAAE,EAAE,eAAe,EAAE,MAAM,CAAC,KAAK;wDAClF,WAAU;wDACV,aAAY;;;;;6EAGd,4TAAC;wDAAK,WAAU;kEAAW,OAAO,WAAW;;;;;;;;;;;8DAGjD,4TAAC;oDAAG,WAAU;8DACX,WAAW,OAAO,SAAS,iBAC1B,4TAAC;wDACC,MAAK;wDACL,OAAO,OAAO,QAAQ;wDACtB,UAAU,CAAC,IAAM,aAAa,OAAO,GAAG,EAAE,OAAO,EAAE,EAAE,YAAY,EAAE,MAAM,CAAC,KAAK;wDAC/E,WAAU;wDACV,aAAY;wDACZ,WAAW;;;;;6EAGb,4TAAC;wDAAK,WAAU;kEAA6B,OAAO,QAAQ;;;;;;;;;;;8DAGhE,4TAAC;oDAAG,WAAU;8DACX,WAAW,OAAO,SAAS,iBAC1B,4TAAC;wDACC,MAAK;wDACL,OAAO,OAAO,MAAM;wDACpB,UAAU,CAAC,IAAM,aAAa,OAAO,GAAG,EAAE,OAAO,EAAE,EAAE,UAAU,WAAW,EAAE,MAAM,CAAC,KAAK,KAAK;wDAC7F,WAAU;wDACV,aAAY;wDACZ,MAAK;wDACL,KAAI;;;;;6EAGN,4TAAC;wDAAK,WAAU;kEAA4B,OAAO,MAAM,CAAC,OAAO,CAAC;;;;;;;;;;;8DAGtE,4TAAC;oDAAG,WAAU;8DACX,WAAW,OAAO,SAAS,iBAC1B,4TAAC;wDACC,MAAK;wDACL,OAAO,OAAO,SAAS;wDACvB,UAAU,CAAC,IAAM,aAAa,OAAO,GAAG,EAAE,OAAO,EAAE,EAAE,aAAa,WAAW,EAAE,MAAM,CAAC,KAAK,KAAK;wDAChG,WAAU;wDACV,aAAY;wDACZ,MAAK;wDACL,KAAI;;;;;6EAGN,4TAAC;wDAAK,WAAU;kEAA4B,OAAO,SAAS,CAAC,OAAO,CAAC;;;;;;;;;;;8DAGzE,4TAAC;oDAAG,WAAU;8DACX,WAAW,OAAO,SAAS,iBAC1B,4TAAC;wDACC,MAAK;wDACL,OAAO,OAAO,YAAY;wDAC1B,UAAU,CAAC,IAAM,aAAa,OAAO,GAAG,EAAE,OAAO,EAAE,EAAE,gBAAgB,SAAS,EAAE,MAAM,CAAC,KAAK,KAAK;wDACjG,WAAU;wDACV,KAAI;wDACJ,KAAI;;;;;6EAGN,4TAAC;wDAAK,WAAU;kEAAW,OAAO,YAAY;;;;;;;;;;;8DAGlD,4TAAC;oDAAG,WAAU;8DACZ,cAAA,4TAAC;wDAAK,WAAU;kEAAW,OAAO,WAAW,CAAC,OAAO,CAAC;;;;;;;;;;;8DAExD,4TAAC;oDAAG,WAAU;8DACZ,cAAA,4TAAC;wDAAK,WAAU;kEAAW,YAAY,OAAO,CAAC;;;;;;;;;;;gDAEhD,kCACC,4TAAC;oDAAG,WAAU;8DACX,WAAW,OAAO,SAAS,iBAC1B,4TAAC;wDACC,MAAK;wDACL,OAAO,OAAO,YAAY,IAAI;wDAC9B,UAAU,CAAC,IAAM,aAAa,OAAO,GAAG,EAAE,OAAO,EAAE,EAAE,gBAAgB,EAAE,MAAM,CAAC,KAAK;wDACnF,WAAU;;;;;6EAGZ,4TAAC;wDAAK,WAAU;kEAAW,OAAO,YAAY,IAAI;;;;;;;;;;;gDAIvD,kCACC,4TAAC;oDAAG,WAAU;8DACX,yBACC,4TAAC;wDACC,MAAK;wDACL,SAAS,OAAO,UAAU;wDAC1B,UAAU,CAAC,IAAM,aAAa,OAAO,GAAG,EAAE,OAAO,EAAE,EAAE,cAAc,EAAE,MAAM,CAAC,OAAO;wDACnF,WAAU;;;;;;;;;;;gDAKjB,aAAa,GAAG,CAAC,CAAA,uBAChB,4TAAC;wDAAuC,WAAU;kEAChD,cAAA,4TAAC;4DAAK,WAAU;sEAAW,WAAW,CAAC,OAAO,GAAG,CAAC,EAAE,QAAQ,MAAM;;;;;;uDAD3D,GAAG,OAAO,GAAG,CAAC,CAAC,EAAE,OAAO,GAAG,EAAE;;;;;8DAIxC,4TAAC;oDAAG,WAAU;8DACX,yBACC;kEACG,OAAO,SAAS,iBACf,4TAAC;4DAAI,WAAU;;8EACb,4TAAC,wIAAM;oEACL,SAAS,IAAM,WAAW,OAAO,GAAG,EAAE,OAAO,EAAE;oEAC/C,SAAQ;oEACR,MAAK;oEACL,WAAU;8EACX;;;;;;8EAGD,4TAAC,wIAAM;oEACL,SAAS,IAAM,aAAa,OAAO,GAAG,EAAE,OAAO,EAAE;oEACjD,SAAQ;oEACR,MAAK;oEACL,WAAU;8EACX;;;;;;;;;;;iFAKH,4TAAC,wIAAM;4DACL,SAAS,IAAM,WAAW,OAAO,GAAG,EAAE,OAAO,EAAE;4DAC/C,SAAQ;4DACR,MAAK;4DACL,WAAU;sEACX;;;;;;;;;;;;;2CAxJF,GAAG,OAAO,GAAG,CAAC,CAAC,EAAE,OAAO,EAAE,EAAE;;;;;oCAiKzC;kDAGA,4TAAC;wCAAG,WAAU;;0DACZ,4TAAC;gDAAG,WAAU;gDAAmD,SAAS;0DAAG;;;;;;0DAC7E,4TAAC;gDAAG,WAAU;0DAAwD,OAAO,SAAS,CAAC,OAAO,CAAC;;;;;;0DAC/F,4TAAC;gDAAG,WAAU;0DAAwD;;;;;;0DACtE,4TAAC;gDAAG,WAAU;0DAAwD,OAAO,WAAW,CAAC,OAAO,CAAC;;;;;;0DACjG,4TAAC;gDAAG,WAAU;0DAAwD,4BAA4B,OAAO,CAAC;;;;;;4CACzG,kCACC,4TAAC;gDAAG,WAAU;0DAAwD;;;;;;4CAEvE,kCACC,4TAAC;gDAAG,WAAU;0DAAwD;;;;;;4CAEvE,aAAa,GAAG,CAAC,CAAA,uBAChB,4TAAC;oDAA6C,WAAU;8DACrD,MAAM,CAAC,OAAO,GAAG,CAAC,EAAE,QAAQ,MAAM;mDAD5B,CAAC,MAAM,EAAE,OAAO,GAAG,CAAC,CAAC,EAAE,OAAO,GAAG,EAAE;;;;;0DAI9C,4TAAC;gDAAG,WAAU;0DAAwD;;;;;;;;;;;;kDAIxE,4TAAC;wCAAG,WAAU;;0DACZ,4TAAC;gDAAG,WAAU;gDAAmD,SAAS,IAAI,CAAC,mBAAmB,IAAI,CAAC;0DAAG;;;;;;4CACzG,aAAa,GAAG,CAAC,CAAA,uBAChB,4TAAC;oDAA+C,WAAU;8DACvD,QAAQ,CAAC,OAAO,GAAG,CAAC,EAAE,QAAQ,MAAM;mDAD9B,CAAC,QAAQ,EAAE,OAAO,GAAG,CAAC,CAAC,EAAE,OAAO,GAAG,EAAE;;;;;0DAIhD,4TAAC;gDAAG,WAAU;0DAAwD;;;;;;;;;;;;oCAGvE,gBAAgB,MAAM,KAAK,mBAC1B,4TAAC;kDACC,cAAA,4TAAC;4CAAG,SAAS,IAAI,CAAC,mBAAmB,IAAI,CAAC,IAAI,aAAa,MAAM;4CAAE,WAAU;sDAC1E,eACG,sBACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;WAhRV,OAAO,GAAG;;;;;IA2RxB;IACA,MAAM,8BAA8B,CAAC;QACnC,MAAM,cAAsC,CAAC;QAE7C,IAAI,CAAC,OAAO,YAAY,IAAI,OAAO,YAAY,IAAI,KAAK,OAAO,WAAW,IAAI,GAAG;YAC/E,OAAO;QACT;QAEA,8FAA8F;QAC9F,IAAI,OAAO,YAAY,EAAE;YACvB,MAAM,kBAAkB,IAAI,KAAK,OAAO,YAAY;YACpD,MAAM,eAAe,IAAI,KAAK,OAAO,YAAY;YAEjD,gEAAgE;YAChE,MAAM,iBAAiB,CAAC;gBACtB,IAAI,WAAW,KAAK,WAAW,KAAK,aAAa,WAAW;gBAC5D,IAAI,YAAY,KAAK,QAAQ,KAAK,aAAa,QAAQ;gBACvD,OAAO,WAAW,KAAK;YACzB;YAEA,MAAM,sBAAsB,eAAe;YAE3C,aAAa,OAAO,CAAC,CAAA;gBACnB,MAAM,aAAa,IAAI,KAAK,OAAO,IAAI,EAAE,OAAO,KAAK,EAAE;gBACvD,MAAM,oBAAoB,eAAe;gBAEzC,IAAI,oBAAoB,GAAG;oBACzB,0BAA0B;oBAC1B,WAAW,CAAC,OAAO,GAAG,CAAC,GAAG;gBAC5B,OAAO,IAAI,oBAAoB,qBAAqB;oBAClD,sEAAsE;oBACtE,IAAI,oBAAoB,OAAO,YAAY,EAAE;wBAC3C,WAAW,CAAC,OAAO,GAAG,CAAC,GAAG,OAAO,WAAW;oBAC9C,OAAO;wBACL,WAAW,CAAC,OAAO,GAAG,CAAC,GAAG;oBAC5B;gBACF,OAAO,IAAI,sBAAsB,qBAAqB;oBACpD,mCAAmC;oBACnC,MAAM,wBAAwB,KAAK,GAAG,CAAC,qBAAqB,OAAO,YAAY;oBAC/E,MAAM,mBAAmB,wBAAwB,OAAO,WAAW;oBACnE,MAAM,kBAAkB,OAAO,SAAS,GAAG;oBAC3C,WAAW,CAAC,OAAO,GAAG,CAAC,GAAG;gBAC5B,OAAO;oBACL,yBAAyB;oBACzB,WAAW,CAAC,OAAO,GAAG,CAAC,GAAG;gBAC5B;YACF;YAEA,OAAO;QACT;QAEA,0BAA0B;QAC1B,MAAM,eAAe,IAAI,KAAK,OAAO,YAAY;QACjD,MAAM,aAAa,aAAa,QAAQ;QACxC,MAAM,YAAY,aAAa,WAAW;QAE1C,iEAAiE;QACjE,aAAa,OAAO,CAAC,CAAA;YACnB,MAAM,aAAa,IAAI,KAAK,OAAO,IAAI,EAAE,OAAO,KAAK,EAAE;YAEvD,gEAAgE;YAChE,IAAI,CAAC,OAAO,UAAU,IAAI,cAAc,cAAc;gBACpD,IAAI,gBAAgB;gBACpB,IAAI,eAAe;gBACnB,IAAI,cAAc;gBAElB,MAAO,cAAc,OAAO,IAAI,IAAK,gBAAgB,OAAO,IAAI,IAAI,gBAAgB,OAAO,KAAK,CAAG;oBACjG,IAAI,gBAAgB,OAAO,YAAY,EAAE;wBACvC,WAAW,CAAC,OAAO,GAAG,CAAC,GAAG,OAAO,WAAW;oBAC9C,OAAO;wBACL,WAAW,CAAC,OAAO,GAAG,CAAC,GAAG,GAAE,6BAA6B;oBAC3D;oBACA;oBACA;oBACA,IAAI,eAAe,IAAI;wBACrB,eAAe;wBACf;oBACF;gBACF;YACF,OAAO,IAAI,OAAO,UAAU,EAAE;gBAC5B,0CAA0C;gBAC1C,WAAW,CAAC,OAAO,GAAG,CAAC,GAAG;YAC5B,OAAO;gBACL,uBAAuB;gBACvB,WAAW,CAAC,OAAO,GAAG,CAAC,GAAG;YAC5B;QACF;QAEA,OAAO;IACT;IAEA,4EAA4E;IAC5E,MAAM,uBAAuB,CAAC;QAC5B,MAAM,cAAc,4BAA4B;QAChD,IAAI,gBAAgB;QAEpB,gEAAgE;QAChE,MAAM,eAAe,IAAI,KAAK,cAAc,eAAe;QAC3D,MAAM,eAAe,IAAI,KAAK,OAAO,YAAY;QAEjD,oGAAoG;QACpG,IAAI,CAAC,OAAO,UAAU,IAAI,gBAAgB,cAAc;YACtD,aAAa,OAAO,CAAC,CAAA;gBACnB,MAAM,aAAa,IAAI,KAAK,OAAO,IAAI,EAAE,OAAO,KAAK,EAAE;gBAEvD,uDAAuD;gBACvD,IAAI,cAAc,gBAAgB,WAAW,CAAC,OAAO,GAAG,CAAC,IAAI,WAAW,CAAC,OAAO,GAAG,CAAC,GAAG,GAAG;oBACxF,iBAAiB,WAAW,CAAC,OAAO,GAAG,CAAC;gBAC1C;YACF;QACF;QAEA,OAAO;IACT;IAEA,yDAAyD;IACzD,MAAM,uBAAuB;QAC3B,MAAM,UAAU,EAAE;QAClB,IAAI,eAAe;QACnB,IAAI,cAAc;QAElB,IAAK,IAAI,IAAI,GAAG,IAAI,IAAI,IAAK;YAC3B,MAAM,WAAW,GAAG,YAAY,CAAC,EAAE,cAAc;YACjD,QAAQ,IAAI,CAAC;gBACX,KAAK;gBACL,OAAO,GAAG,MAAM,CAAC,aAAa,CAAC,SAAS,CAAC,GAAG,GAAG,CAAC,EAAE,YAAY,QAAQ,GAAG,SAAS,CAAC,IAAI;gBACvF,OAAO;gBACP,MAAM;YACR;YAEA;YACA,IAAI,eAAe,IAAI;gBACrB,eAAe;gBACf;YACF;QACF;QAEA,OAAO;IACT;IAEA,MAAM,eAAe;IAErB,mDAAmD;IACnD,MAAM,UAAU,kBAAkB,IAAA,oIAAW,EAAC,iBAAiB,sBAAsB;IAErF,IAAI,CAAC,UAAU;QACb,OAAO;IACT;IAEA,qBACE,4TAAC;QAAK,WAAU;;0BACd,4TAAC,0IAAU;gBAAC,aAAY;;;;;;0BACxB,4TAAC;gBAAI,WAAU;;kCACb,4TAAC;wBAAG,WAAU;kCAAsC;;;;;;kCACpD,4TAAC;wBAAI,WAAU;;0CACb,4TAAC;gCAAI,WAAU;;kDACb,4TAAC;wCAAM,WAAU;kDAA4B;;;;;;kDAC7C,4TAAC;wCACC,OAAO;wCACP,UAAU,CAAC,IAAM,iBAAiB,OAAO,EAAE,MAAM,CAAC,KAAK;wCACvD,WAAU;kDAET,OAAO,GAAG,CAAC,CAAC,OAAO,oBAClB,4TAAC;gDAAiB,OAAO;0DAAM;+CAAlB;;;;;;;;;;kDAGjB,4TAAC;wCACC,OAAO;wCACP,UAAU,CAAC,IAAM,gBAAgB,OAAO,EAAE,MAAM,CAAC,KAAK;wCACtD,WAAU;kDAET,MAAM,IAAI,CAAC;4CAAE,QAAQ;wCAAG,GAAG,CAAC,GAAG,IAAM,IAAI,OAAO,WAAW,KAAK,IAAI,GAAG,GAAG,CAAC,CAAC,qBAC3E,4TAAC;gDAAkB,OAAO;0DAAO;+CAApB;;;;;;;;;;;;;;;;0CAKnB,4TAAC;gCAAI,WAAU;0CACb,cAAA,4TAAC;oCAAM,WAAU;;sDACf,4TAAC;4CACC,MAAK;4CACL,SAAS;4CACT,UAAU,CAAC,IAAM,gBAAgB,EAAE,MAAM,CAAC,OAAO;4CACjD,WAAU;;;;;;wCACV;;;;;;;;;;;;;;;;;;;;;;;;0BAOV,4TAAC;gBAAI,WAAU;0BAEZ,aAAa,GAAG,CAAC,CAAA,SAAU,YAAY;;;;;;;;;;;;AAIhD;GA9vBwB;KAAA"}}]
}