{"version":3,"sources":["../../../../app/scheduled-records/page.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport Link from \"next/link\"\r\nimport { Button } from \"@/components/ui/button\"\r\n\r\nconst MONTHS = [\r\n  \"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\r\n  \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\r\n]\r\n\r\ninterface ScheduledRecord {\r\n  id: string\r\n  purchaseDate: string\r\n  description: string\r\n  currency: string\r\n  amount: number\r\n  usdAmount: number\r\n  usefulMonths: number\r\n  monthlyCost: number\r\n  disposalDate?: string\r\n  isFinished: boolean\r\n  isEditing?: boolean\r\n}\r\n\r\nexport default function ScheduledRecordsPage() {\r\n  const [selectedMonth, setSelectedMonth] = React.useState<number>(() => {\r\n    // Load saved month from localStorage or use current month\r\n    if (typeof window !== 'undefined') {\r\n      const savedMonth = localStorage.getItem('sola-selected-month')\r\n      return savedMonth !== null ? parseInt(savedMonth) : new Date().getMonth()\r\n    }\r\n    return new Date().getMonth()\r\n  })\r\n  const [selectedYear, setSelectedYear] = React.useState<number>(() => {\r\n    // Load saved year from localStorage or use current year\r\n    if (typeof window !== 'undefined') {\r\n      const savedYear = localStorage.getItem('sola-selected-year')\r\n      return savedYear !== null ? parseInt(savedYear) : new Date().getFullYear()\r\n    }\r\n    return new Date().getFullYear()\r\n  })\r\n  const [selectedEntity, setSelectedEntity] = React.useState<string | null>(null)\r\n  const [showEntityUsers, setShowEntityUsers] = React.useState<boolean>(false)\r\n  const [descriptionFilter, setDescriptionFilter] = React.useState<string>('')\r\n  const [showFinished, setShowFinished] = React.useState<boolean>(false)\r\n  const [collapsedTables, setCollapsedTables] = React.useState<Record<string, boolean>>(() => {\r\n  // Initialize all tables as collapsed by default\r\n  const initialCollapsed: Record<string, boolean> = {}\r\n  const tableConfigs = [\r\n    { key: 'fixed-asset', name: 'Fixed Asset', accountCode: '' },\r\n    { key: 'prepaid-rent', name: 'Prepaid Rent', accountCode: '471 9005' },\r\n    { key: 'prepaid-expenses', name: 'Prepaid Expenses', accountCode: '471 9002' },\r\n    { key: 'other-insurances', name: 'Other Insurances', accountCode: '471 9001' },\r\n    { key: 'life-insurance', name: 'Life Insurance', accountCode: '471 9004' },\r\n    { key: 'medical-insurance', name: 'Medical Insurance', accountCode: '471 9003' }\r\n  ]\r\n  tableConfigs.forEach(config => {\r\n    initialCollapsed[config.key] = true\r\n  })\r\n  return initialCollapsed\r\n})\r\n  const [tableRecords, setTableRecords] = React.useState<Record<string, ScheduledRecord[]>>({})\r\n  const [isClient, setIsClient] = React.useState<boolean>(false)\r\n\r\n  // Save month/year to localStorage when they change\r\n  React.useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      localStorage.setItem('sola-selected-month', selectedMonth.toString())\r\n      localStorage.setItem('sola-selected-year', selectedYear.toString())\r\n    }\r\n  }, [selectedMonth, selectedYear])\r\n\r\n  // Handle client-side hydration\r\n  React.useEffect(() => {\r\n    setIsClient(true)\r\n  }, [])\r\n\r\n  // Load records from localStorage for each table\r\n  React.useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const allTableRecords: Record<string, ScheduledRecord[]> = {}\r\n      tableConfigs.forEach(config => {\r\n        const savedRecords = localStorage.getItem(`sola-scheduled-records-${config.key}`)\r\n        if (savedRecords) {\r\n          try {\r\n            allTableRecords[config.key] = JSON.parse(savedRecords)\r\n          } catch (error) {\r\n            console.error(`Error parsing ${config.name} records:`, error)\r\n            allTableRecords[config.key] = []\r\n          }\r\n        } else {\r\n          allTableRecords[config.key] = []\r\n        }\r\n      })\r\n      setTableRecords(allTableRecords)\r\n    }\r\n  }, []) // Load on mount only\r\n\r\n  // Save records to localStorage for each table\r\n  React.useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      Object.entries(tableRecords).forEach(([tableKey, records]) => {\r\n        localStorage.setItem(`sola-scheduled-records-${tableKey}`, JSON.stringify(records))\r\n      })\r\n    }\r\n  }, [tableRecords]) // Save when tableRecords change\r\n\r\n  // Add new record to a specific table\r\n  const addRecord = (tableKey: string) => {\r\n    const newRecord: ScheduledRecord = {\r\n      id: Date.now().toString(),\r\n      purchaseDate: new Date().toISOString().split('T')[0],\r\n      description: '',\r\n      currency: 'USD',\r\n      amount: 0,\r\n      usdAmount: 0,\r\n      usefulMonths: 12,\r\n      monthlyCost: 0,\r\n      disposalDate: '',\r\n      isFinished: false,\r\n      isEditing: true\r\n    }\r\n    \r\n    setTableRecords(prev => ({\r\n      ...prev,\r\n      [tableKey]: [...(prev[tableKey] || []), newRecord]\r\n    }))\r\n  }\r\n\r\n  // Update record in a specific table\r\n  const updateRecord = (tableKey: string, recordId: string, field: keyof ScheduledRecord, value: any) => {\r\n    setTableRecords(prev => ({\r\n      ...prev,\r\n      [tableKey]: prev[tableKey].map(record => {\r\n        if (record.id === recordId) {\r\n          const updatedRecord = { ...record, [field]: value }\r\n          \r\n          // Auto-calculate monthly cost and USD amount\r\n          if (field === 'amount' || field === 'usdAmount' || field === 'usefulMonths') {\r\n            const usdAmount = field === 'usdAmount' ? value : updatedRecord.usdAmount\r\n            const usefulMonths = field === 'usefulMonths' ? value : updatedRecord.usefulMonths\r\n            updatedRecord.monthlyCost = usefulMonths > 0 ? usdAmount / usefulMonths : 0\r\n          }\r\n          \r\n          return updatedRecord\r\n        }\r\n        return record\r\n      })\r\n    }))\r\n  }\r\n\r\n  // Toggle edit mode for a record in a specific table\r\n  const toggleEdit = (tableKey: string, recordId: string) => {\r\n    setTableRecords(prev => ({\r\n      ...prev,\r\n      [tableKey]: prev[tableKey].map(record => \r\n        record.id === recordId ? { ...record, isEditing: !record.isEditing } : record\r\n      )\r\n    }))\r\n  }\r\n\r\n  // Save record (exit edit mode) in a specific table\r\n  const saveRecord = (tableKey: string, recordId: string) => {\r\n    setTableRecords(prev => ({\r\n      ...prev,\r\n      [tableKey]: prev[tableKey].map(record => \r\n        record.id === recordId ? { ...record, isEditing: false } : record\r\n      )\r\n    }))\r\n  }\r\n\r\n  // Delete record from a specific table\r\n  const deleteRecord = (tableKey: string, recordId: string) => {\r\n    setTableRecords(prev => ({\r\n      ...prev,\r\n      [tableKey]: prev[tableKey].filter(record => record.id !== recordId)\r\n    }))\r\n  }\r\n\r\n  // Toggle table collapse\r\n  const toggleCollapse = (tableKey: string) => {\r\n    setCollapsedTables(prev => ({\r\n      ...prev,\r\n      [tableKey]: !prev[tableKey]\r\n    }))\r\n  }\r\n\r\n  // Table configurations\r\n  const tableConfigs = [\r\n    { key: 'fixed-asset', name: 'Fixed Asset', accountCode: '' },\r\n    { key: 'prepaid-rent', name: 'Prepaid Rent', accountCode: '471 9005' },\r\n    { key: 'prepaid-expenses', name: 'Prepaid Expenses', accountCode: '471 9002' },\r\n    { key: 'other-insurances', name: 'Other Insurances', accountCode: '471 9001' },\r\n    { key: 'life-insurance', name: 'Life Insurance', accountCode: '471 9004' },\r\n    { key: 'medical-insurance', name: 'Medical Insurance', accountCode: '471 9003' }\r\n  ]\r\n\r\n  // Render a single table\r\n  const renderTable = (config: typeof tableConfigs[0]) => {\r\n    const isCollapsed = collapsedTables[config.key] || false\r\n    const currentRecords = tableRecords[config.key] || []\r\n    \r\n    // Calculate remaining balance as of selected date\r\n    const calculateRemainingBalance = () => {\r\n      let totalRemaining = 0\r\n      const selectedDate = new Date(selectedYear, selectedMonth, 1)\r\n      \r\n      currentRecords.forEach(record => {\r\n        // Skip finished records\r\n        if (record.isFinished) return\r\n        \r\n        const allocations = calculateMonthlyAllocations(record)\r\n        \r\n        // Add allocations for selected month and all future months\r\n        monthColumns.forEach((column, index) => {\r\n          const columnDate = new Date(column.year, column.month, 1)\r\n          if (columnDate >= selectedDate) {\r\n            totalRemaining += allocations[column.key] || 0\r\n          }\r\n        })\r\n      })\r\n      \r\n      return totalRemaining\r\n    }\r\n    \r\n    const remainingBalance = calculateRemainingBalance()\r\n    \r\n    // Filter records for this table (moved outside of useMemo)\r\n    const getFilteredRecords = () => {\r\n      let filtered = currentRecords\r\n      \r\n      // Handle showFinished filter\r\n      if (showFinished) {\r\n        // Show all records when \"Show Finished\" is checked\r\n        return filtered\r\n      } else {\r\n        // Show only unfinished records when \"Show Finished\" is unchecked\r\n        return filtered.filter(record => !record.isFinished)\r\n      }\r\n    }\r\n\r\n    const filteredRecords = getFilteredRecords()\r\n\r\n    // Check if any record is in edit mode for this table\r\n    const hasEditingRecord = currentRecords.some(record => record.isEditing)\r\n\r\n    // Calculate totals for this table\r\n    const calculateTotals = () => {\r\n      const totals: Record<string, number> = { usdAmount: 0, monthlyCost: 0 }\r\n      \r\n      // Calculate USD Amount and Monthly Cost totals\r\n      currentRecords.forEach(record => {\r\n        totals.usdAmount += record.usdAmount\r\n        totals.monthlyCost += record.monthlyCost\r\n      })\r\n      \r\n      // Calculate totals for each month column\r\n      monthColumns.forEach(column => {\r\n        totals[column.key] = 0\r\n        currentRecords.forEach(record => {\r\n          const allocations = calculateMonthlyAllocations(record)\r\n          totals[column.key] += allocations[column.key] || 0\r\n        })\r\n      })\r\n      \r\n      return totals\r\n    }\r\n\r\n    // Calculate balance for this table\r\n    const calculateBalances = () => {\r\n      const balances: Record<string, number> = {}\r\n      \r\n      monthColumns.forEach((column, index) => {\r\n        let remainingTotal = 0\r\n        currentRecords.forEach(record => {\r\n          const allocations = calculateMonthlyAllocations(record)\r\n          \r\n          // Add allocations for this month and all future months\r\n          for (let i = index; i < monthColumns.length; i++) {\r\n            const futureColumn = monthColumns[i]\r\n            remainingTotal += allocations[futureColumn.key] || 0\r\n          }\r\n        })\r\n        \r\n        balances[column.key] = remainingTotal\r\n      })\r\n      \r\n      return balances\r\n    }\r\n\r\n    // Calculate total carried over for this table\r\n    const calculateTotalCarriedOver = () => {\r\n      let totalCarriedOver = 0\r\n      currentRecords.forEach(record => {\r\n        totalCarriedOver += calculateCarriedOver(record)\r\n      })\r\n      return totalCarriedOver\r\n    }\r\n\r\n    const totals = calculateTotals()\r\n    const balances = calculateBalances()\r\n    \r\n    return (\r\n      <div key={config.key} className=\"mb-8\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <div>\r\n            <h3 className=\"text-xl font-bold text-gray-900\">\r\n              {config.name}\r\n              {config.accountCode && <span className=\"ml-2 text-sm text-gray-500\">({config.accountCode})</span>}\r\n              <span className=\"ml-2 text-sm text-blue-600 font-medium\">(${remainingBalance.toFixed(2)})</span>\r\n            </h3>\r\n          </div>\r\n          <div className=\"flex items-center gap-2\">\r\n            <Button onClick={() => addRecord(config.key)} variant=\"outline\" size=\"sm\">\r\n              + Add Record\r\n            </Button>\r\n            <button\r\n              onClick={() => toggleCollapse(config.key)}\r\n              className=\"flex items-center gap-2 px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50\"\r\n            >\r\n              {isCollapsed ? (\r\n                <>\r\n                  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\r\n                  </svg>\r\n                  Expand\r\n                </>\r\n              ) : (\r\n                <>\r\n                  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 15l7-7 7 7\" />\r\n                  </svg>\r\n                  Collapse\r\n                </>\r\n              )}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {!isCollapsed && (\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"w-full border-collapse border border-gray-300 text-xs\">\r\n              <thead>\r\n                <tr>\r\n                  <th className=\"border border-gray-300 p-1 bg-gray-50 text-left text-xs font-semibold w-20\">Purchase Date</th>\r\n                  <th className=\"border border-gray-300 p-1 bg-gray-50 text-left text-xs font-semibold\">Description</th>\r\n                  <th className=\"border border-gray-300 p-1 bg-gray-50 text-left text-xs font-semibold w-16\">Currency</th>\r\n                  <th className=\"border border-gray-300 p-1 bg-gray-50 text-right text-xs font-semibold w-20\">Amount</th>\r\n                  <th className=\"border border-gray-300 p-1 bg-gray-50 text-right text-xs font-semibold w-20\">USD Amount</th>\r\n                  <th className=\"border border-gray-300 p-1 bg-gray-50 text-center text-xs font-semibold w-16\">Useful</th>\r\n                  <th className=\"border border-gray-300 p-1 bg-gray-50 text-right text-xs font-semibold w-20\">Monthly</th>\r\n                  <th className=\"border border-gray-300 p-1 bg-gray-50 text-right text-xs font-semibold w-20\">Carried</th>\r\n                  {hasEditingRecord && (\r\n                    <th className=\"border border-gray-300 p-1 bg-gray-50 text-left text-xs font-semibold w-20\">Disposal</th>\r\n                  )}\r\n                  {hasEditingRecord && (\r\n                    <th className=\"border border-gray-300 p-1 bg-gray-50 text-center text-xs font-semibold w-12\">Done</th>\r\n                  )}\r\n                  {monthColumns.map(column => (\r\n                    <th key={`${config.key}-${column.key}`} className=\"border border-gray-300 p-1 bg-gray-50 text-right text-xs font-semibold whitespace-nowrap w-14\">\r\n                      {column.label}\r\n                    </th>\r\n                  ))}\r\n                  <th className=\"border border-gray-300 p-1 bg-gray-50 text-center text-xs font-semibold w-16\">Actions</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {filteredRecords.map((record) => {\r\n                  const allocations = calculateMonthlyAllocations(record)\r\n                  const carriedOver = calculateCarriedOver(record)\r\n                  const hasDisposalDate = record.disposalDate && record.disposalDate !== ''\r\n                  const isFinished = record.isFinished\r\n                  return (\r\n                    <tr key={`${config.key}-${record.id}`} className={\r\n                      hasDisposalDate ? 'bg-red-50' : \r\n                      isFinished ? 'bg-gray-100' : ''\r\n                    }>\r\n                      <td className=\"border border-gray-300 p-0.5 w-20\">\r\n                        {record.isEditing ? (\r\n                          <input\r\n                            type=\"date\"\r\n                            value={record.purchaseDate}\r\n                            onChange={(e) => updateRecord(config.key, record.id, 'purchaseDate', e.target.value)}\r\n                            className=\"w-full border-0 bg-transparent focus:outline-none focus:ring-1 focus:ring-blue-500 rounded text-xs\"\r\n                          />\r\n                        ) : (\r\n                          <span className=\"text-xs\">{record.purchaseDate}</span>\r\n                        )}\r\n                      </td>\r\n                      <td className=\"border border-gray-300 p-0.5\">\r\n                        {record.isEditing ? (\r\n                          <input\r\n                            type=\"text\"\r\n                            value={record.description}\r\n                            onChange={(e) => updateRecord(config.key, record.id, 'description', e.target.value)}\r\n                            className=\"w-full border-0 bg-transparent focus:outline-none focus:ring-1 focus:ring-blue-500 rounded text-xs\"\r\n                            placeholder=\"Enter description\"\r\n                          />\r\n                        ) : (\r\n                          <span className=\"text-xs\">{record.description}</span>\r\n                        )}\r\n                      </td>\r\n                      <td className=\"border border-gray-300 p-0.5 w-16\">\r\n                        {record.isEditing ? (\r\n                          <input\r\n                            type=\"text\"\r\n                            value={record.currency}\r\n                            onChange={(e) => updateRecord(config.key, record.id, 'currency', e.target.value)}\r\n                            className=\"w-full border-0 bg-transparent focus:outline-none focus:ring-1 focus:ring-blue-500 rounded text-xs text-center\"\r\n                            placeholder=\"USD\"\r\n                            maxLength={3}\r\n                          />\r\n                        ) : (\r\n                          <span className=\"text-xs text-center block\">{record.currency}</span>\r\n                        )}\r\n                      </td>\r\n                      <td className=\"border border-gray-300 p-0.5 w-20\">\r\n                        {record.isEditing ? (\r\n                          <input\r\n                            type=\"number\"\r\n                            value={record.amount}\r\n                            onChange={(e) => updateRecord(config.key, record.id, 'amount', parseFloat(e.target.value) || 0)}\r\n                            className=\"w-full text-right border-0 bg-transparent focus:outline-none focus:ring-1 focus:ring-blue-500 rounded text-xs\"\r\n                            placeholder=\"0.00\"\r\n                            step=\"0.01\"\r\n                            min=\"0\"\r\n                          />\r\n                        ) : (\r\n                          <span className=\"text-xs text-right block\">{record.amount.toFixed(2)}</span>\r\n                        )}\r\n                      </td>\r\n                      <td className=\"border border-gray-300 p-0.5 w-20\">\r\n                        {record.isEditing ? (\r\n                          <input\r\n                            type=\"number\"\r\n                            value={record.usdAmount}\r\n                            onChange={(e) => updateRecord(config.key, record.id, 'usdAmount', parseFloat(e.target.value) || 0)}\r\n                            className=\"w-full text-right border-0 bg-transparent focus:outline-none focus:ring-1 focus:ring-blue-500 rounded text-xs\"\r\n                            placeholder=\"0.00\"\r\n                            step=\"0.01\"\r\n                            min=\"0\"\r\n                          />\r\n                        ) : (\r\n                          <span className=\"text-xs text-right block\">{record.usdAmount.toFixed(2)}</span>\r\n                        )}\r\n                      </td>\r\n                      <td className=\"border border-gray-300 p-0.5 w-16\">\r\n                        {record.isEditing ? (\r\n                          <input\r\n                            type=\"number\"\r\n                            value={record.usefulMonths}\r\n                            onChange={(e) => updateRecord(config.key, record.id, 'usefulMonths', parseInt(e.target.value) || 1)}\r\n                            className=\"w-full text-center border-0 bg-transparent focus:outline-none focus:ring-1 focus:ring-blue-500 rounded text-xs\"\r\n                            min=\"1\"\r\n                          />\r\n                        ) : (\r\n                          <span className=\"text-xs text-center block\">{record.usefulMonths}</span>\r\n                        )}\r\n                      </td>\r\n                      <td className=\"border border-gray-300 p-0.5 w-20 text-right\">\r\n                        <span className=\"text-xs\">{record.monthlyCost.toFixed(2)}</span>\r\n                      </td>\r\n                      <td className=\"border border-gray-300 p-0.5 w-20 text-right\">\r\n                        <span className=\"text-xs\">{carriedOver.toFixed(2)}</span>\r\n                      </td>\r\n                      {hasEditingRecord && (\r\n                        <td className=\"border border-gray-300 p-0.5 w-20\">\r\n                          {record.isEditing ? (\r\n                            <input\r\n                              type=\"date\"\r\n                              value={record.disposalDate || ''}\r\n                              onChange={(e) => updateRecord(config.key, record.id, 'disposalDate', e.target.value)}\r\n                              className=\"w-full border-0 bg-transparent focus:outline-none focus:ring-1 focus:ring-blue-500 rounded text-xs\"\r\n                            />\r\n                          ) : (\r\n                            <span className=\"text-xs\">{record.disposalDate || ''}</span>\r\n                          )}\r\n                        </td>\r\n                      )}\r\n                      {hasEditingRecord && (\r\n                        <td className=\"border border-gray-300 p-0.5 w-12 text-center\">\r\n                          <input\r\n                            type=\"checkbox\"\r\n                            checked={record.isFinished}\r\n                            onChange={(e) => updateRecord(config.key, record.id, 'isFinished', e.target.checked)}\r\n                            className=\"w-3 h-3 text-blue-600 rounded focus:ring-blue-500\"\r\n                          />\r\n                        </td>\r\n                      )}\r\n                      {monthColumns.map(column => (\r\n                        <td key={`${config.key}-${column.key}`} className=\"border border-gray-300 p-0.5 text-right w-14\">\r\n                          <span className=\"text-xs\">{allocations[column.key]?.toFixed(2) || ''}</span>\r\n                        </td>\r\n                      ))}\r\n                      <td className=\"border border-gray-300 p-0.5 text-center w-16\">\r\n                        {record.isEditing ? (\r\n                          <div className=\"flex gap-1 justify-center\">\r\n                            <Button\r\n                              onClick={() => saveRecord(config.key, record.id)}\r\n                              variant=\"outline\"\r\n                              size=\"sm\"\r\n                              className=\"text-green-600 hover:text-green-800 text-xs px-1 py-0.5 h-5\"\r\n                            >\r\n                              Save\r\n                            </Button>\r\n                            <Button\r\n                              onClick={() => deleteRecord(config.key, record.id)}\r\n                              variant=\"outline\"\r\n                              size=\"sm\"\r\n                              className=\"text-red-600 hover:text-red-800 text-xs px-1 py-0.5 h-5\"\r\n                            >\r\n                              Del\r\n                            </Button>\r\n                          </div>\r\n                        ) : (\r\n                          <Button\r\n                            onClick={() => toggleEdit(config.key, record.id)}\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            className=\"text-blue-600 hover:text-blue-800 text-xs px-1 py-0.5 h-5\"\r\n                          >\r\n                            Edit\r\n                          </Button>\r\n                        )}\r\n                      </td>\r\n                    </tr>\r\n                  )\r\n                })}\r\n                \r\n                {/* Totals Row */}\r\n                <tr className=\"bg-gray-50 font-semibold\">\r\n                  <td className=\"border border-gray-300 p-0.5 text-xs text-center\" colSpan={4}>Total</td>\r\n                  <td className=\"border border-gray-300 p-0.5 text-right text-xs w-20\">{totals.usdAmount.toFixed(2)}</td>\r\n                  <td className=\"border border-gray-300 p-0.5 text-center text-xs w-16\">-</td>\r\n                  <td className=\"border border-gray-300 p-0.5 text-right text-xs w-20\">{totals.monthlyCost.toFixed(2)}</td>\r\n                  <td className=\"border border-gray-300 p-0.5 text-right text-xs w-20\">{calculateTotalCarriedOver().toFixed(2)}</td>\r\n                  {hasEditingRecord && (\r\n                    <td className=\"border border-gray-300 p-0.5 text-center text-xs w-20\">-</td>\r\n                  )}\r\n                  {hasEditingRecord && (\r\n                    <td className=\"border border-gray-300 p-0.5 text-center text-xs w-12\">-</td>\r\n                  )}\r\n                  {monthColumns.map(column => (\r\n                    <td key={`total-${config.key}-${column.key}`} className=\"border border-gray-300 p-0.5 text-right text-xs w-14\">\r\n                      {totals[column.key]?.toFixed(2) || '0.00'}\r\n                    </td>\r\n                  ))}\r\n                  <td className=\"border border-gray-300 p-0.5 text-center text-xs w-16\">-</td>\r\n                </tr>\r\n                \r\n                {/* Balance Row */}\r\n                <tr className=\"bg-blue-50 font-semibold\">\r\n                  <td className=\"border border-gray-300 p-0.5 text-xs text-center\" colSpan={8 + (hasEditingRecord ? 2 : 0)}>Balance (Remaining)</td>\r\n                  {monthColumns.map(column => (\r\n                    <td key={`balance-${config.key}-${column.key}`} className=\"border border-gray-300 p-0.5 text-right text-xs w-14\">\r\n                      {balances[column.key]?.toFixed(2) || '0.00'}\r\n                    </td>\r\n                  ))}\r\n                  <td className=\"border border-gray-300 p-0.5 text-center text-xs w-16\">-</td>\r\n                </tr>\r\n                \r\n                {filteredRecords.length === 0 && (\r\n                  <tr>\r\n                    <td colSpan={8 + (hasEditingRecord ? 2 : 0) + monthColumns.length} className=\"border border-gray-300 p-8 text-center text-gray-500\">\r\n                      {showFinished \r\n                        ? 'No records found.' \r\n                        : 'No unfinished records found. Click \\'Show Finished\\' to see all records.'\r\n                      }\r\n                    </td>\r\n                  </tr>\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        )}\r\n      </div>\r\n    )\r\n  }\r\n  const calculateMonthlyAllocations = (record: ScheduledRecord) => {\r\n    const allocations: Record<string, number> = {}\r\n    \r\n    if (!record.purchaseDate || record.usefulMonths <= 0 || record.monthlyCost <= 0) {\r\n      return allocations\r\n    }\r\n\r\n    // If disposal date is set, keep previous months same and allocate remaining to disposal month\r\n    if (record.disposalDate) {\r\n      const disposalDateObj = new Date(record.disposalDate)\r\n      const purchaseDate = new Date(record.purchaseDate)\r\n      \r\n      // Calculate the month number for each date (0 = purchase month)\r\n      const getMonthNumber = (date: Date) => {\r\n        let yearDiff = date.getFullYear() - purchaseDate.getFullYear()\r\n        let monthDiff = date.getMonth() - purchaseDate.getMonth()\r\n        return yearDiff * 12 + monthDiff\r\n      }\r\n      \r\n      const disposalMonthNumber = getMonthNumber(disposalDateObj)\r\n      \r\n      monthColumns.forEach(column => {\r\n        const columnDate = new Date(column.year, column.month, 1)\r\n        const columnMonthNumber = getMonthNumber(columnDate)\r\n        \r\n        if (columnMonthNumber < 0) {\r\n          // Before purchase date: 0\r\n          allocations[column.key] = 0\r\n        } else if (columnMonthNumber < disposalMonthNumber) {\r\n          // Before disposal date: normal monthly cost (if within useful months)\r\n          if (columnMonthNumber < record.usefulMonths) {\r\n            allocations[column.key] = record.monthlyCost\r\n          } else {\r\n            allocations[column.key] = 0\r\n          }\r\n        } else if (columnMonthNumber === disposalMonthNumber) {\r\n          // Disposal month: remaining amount\r\n          const monthsAllocatedBefore = Math.min(disposalMonthNumber, record.usefulMonths)\r\n          const alreadyAllocated = monthsAllocatedBefore * record.monthlyCost\r\n          const remainingAmount = record.usdAmount - alreadyAllocated\r\n          allocations[column.key] = remainingAmount\r\n        } else {\r\n          // After disposal date: 0\r\n          allocations[column.key] = 0\r\n        }\r\n      })\r\n      \r\n      return allocations\r\n    }\r\n\r\n    // Normal allocation logic\r\n    const purchaseDate = new Date(record.purchaseDate)\r\n    const startMonth = purchaseDate.getMonth()\r\n    const startYear = purchaseDate.getFullYear()\r\n    \r\n    // Show allocation in every month column based on finished status\r\n    monthColumns.forEach(column => {\r\n      const columnDate = new Date(column.year, column.month, 1)\r\n      \r\n      // If not finished, show in all future months from purchase date\r\n      if (!record.isFinished && columnDate >= purchaseDate) {\r\n        let monthsElapsed = 0\r\n        let currentMonth = startMonth\r\n        let currentYear = startYear\r\n        \r\n        while (currentYear < column.year || (currentYear === column.year && currentMonth <= column.month)) {\r\n          if (monthsElapsed < record.usefulMonths) {\r\n            allocations[column.key] = record.monthlyCost\r\n          } else {\r\n            allocations[column.key] = 0 // Show 0 after useful months\r\n          }\r\n          monthsElapsed++\r\n          currentMonth++\r\n          if (currentMonth > 11) {\r\n            currentMonth = 0\r\n            currentYear++\r\n          }\r\n        }\r\n      } else if (record.isFinished) {\r\n        // If finished, don't show any allocations\r\n        allocations[column.key] = 0\r\n      } else {\r\n        // Before purchase date\r\n        allocations[column.key] = 0\r\n      }\r\n    })\r\n    \r\n    return allocations\r\n  }\r\n\r\n  // Calculate carried over amounts for each record (total of upcoming months)\r\n  const calculateCarriedOver = (record: ScheduledRecord) => {\r\n    const allocations = calculateMonthlyAllocations(record)\r\n    let upcomingTotal = 0\r\n    \r\n    // Calculate total of upcoming months from selected month filter\r\n    const selectedDate = new Date(selectedYear, selectedMonth, 1)\r\n    const purchaseDate = new Date(record.purchaseDate)\r\n    \r\n    // Only calculate for records that are not finished and purchase date is before or at selected month\r\n    if (!record.isFinished && purchaseDate <= selectedDate) {\r\n      monthColumns.forEach(column => {\r\n        const columnDate = new Date(column.year, column.month, 1)\r\n        \r\n        // Add allocations for this month and all future months\r\n        if (columnDate >= selectedDate && allocations[column.key] && allocations[column.key] > 0) {\r\n          upcomingTotal += allocations[column.key]\r\n        }\r\n      })\r\n    }\r\n    \r\n    return upcomingTotal\r\n  }\r\n\r\n  // Generate 12 month columns starting from selected month\r\n  const generateMonthColumns = () => {\r\n    const columns = []\r\n    let currentMonth = selectedMonth\r\n    let currentYear = selectedYear\r\n    \r\n    for (let i = 0; i < 12; i++) {\r\n      const monthKey = `${currentYear}-${currentMonth}`\r\n      columns.push({\r\n        key: monthKey,\r\n        label: `${MONTHS[currentMonth].substring(0, 3)} ${currentYear.toString().substring(2)}`,\r\n        month: currentMonth,\r\n        year: currentYear\r\n      })\r\n      \r\n      currentMonth++\r\n      if (currentMonth > 11) {\r\n        currentMonth = 0\r\n        currentYear++\r\n      }\r\n    }\r\n    \r\n    return columns\r\n  }\r\n\r\n  const monthColumns = generateMonthColumns()\r\n\r\n  if (!isClient) {\r\n    return null\r\n  }\r\n\r\n  return (\r\n    <main className=\"min-h-screen bg-background\">\r\n      <nav className=\"bg-white border-b border-gray-200 px-6 py-3\">\r\n        <div className=\"flex items-center gap-6\">\r\n          <h1 className=\"text-lg font-semibold text-gray-900\">Sola</h1>\r\n          <div className=\"flex gap-4\">\r\n            <Link \r\n              href=\"/\" \r\n              className=\"text-gray-600 hover:text-gray-800 font-medium\"\r\n            >\r\n              Allocation\r\n            </Link>\r\n            <Link \r\n              href=\"/planning\" \r\n              className=\"text-gray-600 hover:text-gray-800 font-medium\"\r\n            >\r\n              Planning\r\n            </Link>\r\n            <Link \r\n              href=\"/actual-allocation\" \r\n              className=\"text-gray-600 hover:text-gray-800 font-medium\"\r\n            >\r\n              Payroll Allocation\r\n            </Link>\r\n            <Link \r\n              href=\"/expense-allocation\" \r\n              className=\"text-gray-600 hover:text-gray-800 font-medium\"\r\n            >\r\n              Expense Allocation\r\n            </Link>\r\n            <Link \r\n              href=\"/scheduled-records\" \r\n              className=\"text-blue-600 hover:text-blue-800 font-medium\"\r\n            >\r\n              Scheduled Records\r\n            </Link>\r\n          </div>\r\n          <div className=\"ml-auto flex items-center gap-2\">\r\n            <select\r\n              value={selectedMonth}\r\n              onChange={(e) => setSelectedMonth(Number(e.target.value))}\r\n              className=\"border border-gray-300 rounded px-2 py-1 text-sm\"\r\n            >\r\n              {MONTHS.map((month, idx) => (\r\n                <option key={idx} value={idx}>{month}</option>\r\n              ))}\r\n            </select>\r\n            <select\r\n              value={selectedYear}\r\n              onChange={(e) => setSelectedYear(Number(e.target.value))}\r\n              className=\"border border-gray-300 rounded px-2 py-1 text-sm\"\r\n            >\r\n              {Array.from({ length: 10 }, (_, i) => new Date().getFullYear() - 5 + i).map((year: number) => (\r\n                <option key={year} value={year}>{year}</option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n\r\n          <div className=\"flex gap-4\">\r\n            <label className=\"flex items-center gap-2 text-sm\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={showFinished}\r\n                onChange={(e) => setShowFinished(e.target.checked)}\r\n                className=\"w-4 h-4 text-blue-600 rounded focus:ring-blue-500\"\r\n              />\r\n              Show Finished\r\n            </label>\r\n          </div>\r\n        </div>\r\n      </nav>\r\n\r\n      <div className=\"p-6\">\r\n        {/* Render all tables */}\r\n        {tableConfigs.map(config => renderTable(config))}\r\n      </div>\r\n    </main>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}