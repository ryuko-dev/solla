{"version":3,"sources":["../../../../components/allocation-grid.tsx","../../../../components/allocation-cell.tsx","../../../../components/project-manager.tsx","../../../../components/user-management.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport React from \"react\"\r\nimport { useState, useEffect } from \"react\"\r\nimport type { Project, User, Allocation, Position, Entity } from \"../lib/types\"\r\nimport { Button } from \"./ui/button\"\r\nimport { AllocationCell } from \"./allocation-cell\"\r\nimport { ProjectManager } from \"./project-manager\"\r\nimport { getCurrentUser, clearCurrentUser, getCurrentUserData, setCurrentUserData, getCurrentSystemUser, getUserData, getSystemUsers } from \"../lib/storage\"\r\nimport { UserManagement } from \"./user-management\"\r\n\r\nconst MONTHS = [\r\n  \"January\",\r\n  \"February\",\r\n  \"March\",\r\n  \"April\",\r\n  \"May\",\r\n  \"June\",\r\n  \"July\",\r\n  \"August\",\r\n  \"September\",\r\n  \"October\",\r\n  \"November\",\r\n  \"December\",\r\n]\r\nconst YEARS = Array.from({ length: 10 }, (_, i) => 2024 + i)\r\n\r\nexport function AllocationGrid() {\r\n  // Check if user is logged in and get their role\r\n  const [currentUser, setCurrentUserState] = useState<string | null>(null)\r\n  const [currentUserRole, setCurrentUserRole] = useState<'admin' | 'editor' | 'viewer' | null>(null)\r\n  \r\n  // Load user-specific data on component mount\r\n  const [projects, setProjects] = useState<Project[]>(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const systemUser = getCurrentSystemUser()\r\n      \r\n      if (systemUser?.role === 'admin') {\r\n        // Admin loads their own data\r\n        const userData = getCurrentUserData()\r\n        console.log(\"[v0] Admin loading own data:\", userData.projects)\r\n        return userData.projects\r\n      } else {\r\n        // System users load admin's data\r\n        const systemUsers = getSystemUsers()\r\n        const adminUser = systemUsers.find(u => u.role === 'admin' && u.isActive)\r\n        \r\n        if (adminUser) {\r\n          const adminData = getUserData(adminUser.email)\r\n          console.log(\"[v0] System user loading admin data:\", adminData.projects)\r\n          return adminData.projects\r\n        }\r\n      }\r\n    }\r\n    return []\r\n  })\r\n\r\n  const [users, setUsers] = useState<User[]>(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const systemUser = getCurrentSystemUser()\r\n      \r\n      if (systemUser?.role === 'admin') {\r\n        // Admin loads their own data\r\n        const userData = getCurrentUserData()\r\n        return userData.users.length > 0 ? userData.users : [\r\n          { id: \"1\", name: \"John Doe\", department: \"Engineering\" },\r\n          { id: \"2\", name: \"Jane Smith\", department: \"Design\" },\r\n          { id: \"3\", name: \"Bob Johnson\", department: \"Product\" },\r\n        ]\r\n      } else {\r\n        // System users load admin's data\r\n        const systemUsers = getSystemUsers()\r\n        const adminUser = systemUsers.find(u => u.role === 'admin' && u.isActive)\r\n        \r\n        if (adminUser) {\r\n          const adminData = getUserData(adminUser.email)\r\n          return adminData.users.length > 0 ? adminData.users : [\r\n            { id: \"1\", name: \"John Doe\", department: \"Engineering\" },\r\n            { id: \"2\", name: \"Jane Smith\", department: \"Design\" },\r\n            { id: \"3\", name: \"Bob Johnson\", department: \"Product\" },\r\n          ]\r\n        }\r\n      }\r\n    }\r\n    return [\r\n      { id: \"1\", name: \"John Doe\", department: \"Engineering\" },\r\n      { id: \"2\", name: \"Jane Smith\", department: \"Design\" },\r\n      { id: \"3\", name: \"Bob Johnson\", department: \"Product\" },\r\n    ]\r\n  })\r\n\r\n  const [allocations, setAllocations] = useState<Allocation[]>(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const systemUser = getCurrentSystemUser()\r\n      \r\n      if (systemUser?.role === 'admin') {\r\n        // Admin loads their own data\r\n        const userData = getCurrentUserData()\r\n        return userData.allocations\r\n      } else {\r\n        // System users load admin's data\r\n        const systemUsers = getSystemUsers()\r\n        const adminUser = systemUsers.find(u => u.role === 'admin' && u.isActive)\r\n        \r\n        if (adminUser) {\r\n          const adminData = getUserData(adminUser.email)\r\n          return adminData.allocations\r\n        }\r\n      }\r\n    }\r\n    return []\r\n  })\r\n\r\n  const [positions, setPositions] = useState<Position[]>(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const systemUser = getCurrentSystemUser()\r\n      \r\n      if (systemUser?.role === 'admin') {\r\n        // Admin loads their own data\r\n        const userData = getCurrentUserData()\r\n        return userData.positions\r\n      } else {\r\n        // System users load admin's data\r\n        const systemUsers = getSystemUsers()\r\n        const adminUser = systemUsers.find(u => u.role === 'admin' && u.isActive)\r\n        \r\n        if (adminUser) {\r\n          const adminData = getUserData(adminUser.email)\r\n          return adminData.positions\r\n        }\r\n      }\r\n    }\r\n    return []\r\n  })\r\n\r\n  // Check login status and role on mount\r\n  useEffect(() => {\r\n    const user = getCurrentUser()\r\n    const systemUser = getCurrentSystemUser()\r\n    if (!user || !systemUser) {\r\n      window.location.href = \"/login\"\r\n    } else {\r\n      setCurrentUserState(user)\r\n      setCurrentUserRole(systemUser.role)\r\n    }\r\n  }, [])\r\n\r\n  // Save data to user-specific storage whenever it changes\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined' && currentUser) {\r\n      console.log(\"[v0] Saving projects for user:\", currentUser, projects)\r\n      setCurrentUserData({ projects })\r\n    }\r\n  }, [projects, currentUser])\r\n\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined' && currentUser) {\r\n      setCurrentUserData({ users })\r\n    }\r\n  }, [users, currentUser])\r\n\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined' && currentUser) {\r\n      setCurrentUserData({ allocations })\r\n    }\r\n  }, [allocations, currentUser])\r\n\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined' && currentUser) {\r\n      setCurrentUserData({ positions })\r\n    }\r\n  }, [positions, currentUser])\r\n\r\n  const [selectedMonth, setSelectedMonth] = useState<number | null>(null)\r\n\r\n  // Grid starting month/year (top-right selectors). Persist per user.\r\n  const [startMonth, setStartMonth] = useState(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const userData = getCurrentUserData()\r\n      return userData.startMonth ?? 0\r\n    }\r\n    return 0\r\n  })\r\n\r\n  const [startYear, setStartYear] = useState(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const userData = getCurrentUserData()\r\n      return userData.startYear ?? 2024\r\n    }\r\n    return 2024\r\n  })\r\n\r\n  // Persist starting month/year when they change\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined' && currentUser) {\r\n      setCurrentUserData({ startMonth, startYear })\r\n    }\r\n  }, [startMonth, startYear, currentUser])\r\n  const [editingId, setEditingId] = useState<string | null>(null)\r\n  const [editValue, setEditValue] = useState(0)\r\n  const [showUnallocatedModal, setShowUnallocatedModal] = useState(false)\r\n  const [pendingAllocation, setPendingAllocation] = useState<{ userId: string; monthIndex: number } | null>(null)\r\n  const [showUserModal, setShowUserModal] = useState(false)\r\n  const [editingUserId, setEditingUserId] = useState<string | null>(null)\r\n  const [editingUserName, setEditingUserName] = useState(\"\")\r\n  const [editingUserDept, setEditingUserDept] = useState(\"\")\r\n  const [editingUserEntity, setEditingUserEntity] = useState(\"\")\r\n  const [editingUserVendorAC, setEditingUserVendorAC] = useState(\"\")\r\n  const [editingUserStartDate, setEditingUserStartDate] = useState(\"\")\r\n  const [editingUserEndDate, setEditingUserEndDate] = useState(\"\")\r\n  const [editingUserWorkDays, setEditingUserWorkDays] = useState<'mon-fri' | 'sun-thu'>('mon-fri')\r\n  const [selectedCellMonth, setSelectedCellMonth] = useState<number | null>(null)\r\n  const [selectedCellUser, setSelectedCellUser] = useState<string | null>(null)\r\n  const [showPositionModal, setShowPositionModal] = useState(false)\r\n  const [showUserManagement, setShowUserManagement] = useState(false)\r\n  const [viewMode, setViewMode] = useState<'percentage' | 'days'>('percentage')\r\n  const [showMonthDetail, setShowMonthDetail] = useState(false)\r\n  const [selectedMonthForDetail, setSelectedMonthForDetail] = useState<{ year: number; month: number; globalIndex: number } | null>(null)\r\n  const [showGanttChart, setShowGanttChart] = useState(false)\r\n  const [ganttStartYear, setGanttStartYear] = useState(new Date().getFullYear())\r\n  const [customAllocationAmount, setCustomAllocationAmount] = useState<{ [key: string]: string }>({})\r\n  const [selectedPositionForCustom, setSelectedPositionForCustom] = useState<string | null>(null)\r\n  const [selectedProjectId, setSelectedProjectId] = useState<string | null>(null)\r\n  \r\n  // Load entities from localStorage for dropdown\r\n  const [entities, setEntities] = useState<Entity[]>(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const userData = getCurrentUserData()\r\n      return userData.entities || []\r\n    }\r\n    return []\r\n  })\r\n\r\n  // Check if current user has permission for specific actions\r\n  const canEdit = currentUserRole === 'admin'\r\n  const canView = currentUserRole === 'admin' || currentUserRole === 'editor' || currentUserRole === 'viewer'\r\n\r\n  // Filter projects to show only those active between starting month and starting month + 11 months\r\n  const filteredProjects = projects.filter(project => {\r\n    console.log('[DEBUG] Checking project:', project.name)\r\n    console.log('[DEBUG] Project dates:', {\r\n      startMonth: project.startMonth,\r\n      startYear: project.startYear,\r\n      endMonth: project.endMonth,\r\n      endYear: project.endYear,\r\n      hasEndMonth: !!project.endMonth,\r\n      hasEndYear: !!project.endYear,\r\n      endMonthType: typeof project.endMonth,\r\n      endYearType: typeof project.endYear\r\n    })\r\n    \r\n    // If project has no end date, include it\r\n    if (!project.endMonth || !project.endYear) {\r\n      console.log('[DEBUG] Project has no end date, including - endMonth:', project.endMonth, 'endYear:', project.endYear)\r\n      return true\r\n    }\r\n    \r\n    // Calculate project start date - ensure proper year handling\r\n    const projectStartYear = project.startYear || 2024\r\n    const projectEndYear = project.endYear || 2024\r\n    \r\n    console.log('[DEBUG] Using years:', {\r\n      projectStartYear,\r\n      projectEndYear\r\n    })\r\n    \r\n    // Create date objects\r\n    const projectStartDate = new Date(projectStartYear, project.startMonth || 0, 1)\r\n    const projectEndDate = new Date(projectEndYear, project.endMonth, 1)\r\n    \r\n    // Calculate staff allocation start and end dates\r\n    const staffStartDate = new Date(startYear, startMonth, 1)\r\n    const staffEndDate = new Date(startYear, startMonth + 11, 1)\r\n    \r\n    console.log('[DEBUG] Date comparison:', {\r\n      projectStartDate: projectStartDate.toISOString().split('T')[0],\r\n      projectEndDate: projectEndDate.toISOString().split('T')[0],\r\n      staffStartDate: staffStartDate.toISOString().split('T')[0],\r\n      staffEndDate: staffEndDate.toISOString().split('T')[0]\r\n    })\r\n    \r\n    // Check if project overlaps with staff allocation period\r\n    const overlaps = projectStartDate <= staffEndDate && projectEndDate >= staffStartDate\r\n    \r\n    console.log('[DEBUG] Overlap result:', {\r\n      projectStartBeforeStaffEnd: projectStartDate <= staffEndDate,\r\n      projectEndAfterStaffStart: projectEndDate >= staffStartDate,\r\n      overlaps: overlaps\r\n    })\r\n    \r\n    return overlaps\r\n  })\r\n\r\n  const MONTHS = [\r\n    \"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\r\n    \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\r\n  ]\r\n\r\n  const getContrastColor = (hex: string) => {\r\n    const r = parseInt(hex.slice(1, 3), 16)\r\n    const g = parseInt(hex.slice(3, 5), 16)\r\n    const b = parseInt(hex.slice(5, 7), 16)\r\n    const brightness = (r * 299 + g * 587 + b * 114) / 1000\r\n    return brightness > 128 ? \"#000\" : \"#fff\"\r\n  }\r\n\r\n  const addProject = (project: Project) => {\r\n    setProjects((prev) => [...prev, project])\r\n  }\r\n\r\n  // Export to Excel function\r\n  const exportToExcel = () => {\r\n    // Create CSV content\r\n    let csvContent = \"\"\r\n    \r\n    // Add header row\r\n    const headerRow = [\"Staff\", ...months.map(m => m.display)]\r\n    csvContent += headerRow.join(\",\") + \"\\n\"\r\n    \r\n    // Add department rows and user data\r\n    groupedUsers.forEach(group => {\r\n      // Add department header\r\n      csvContent += `${group.department},\\n`\r\n      \r\n      // Add users in this department\r\n      group.users.forEach(user => {\r\n        const userRow = [user.name]\r\n        \r\n        months.forEach(month => {\r\n          const userAllocations = allocations.filter(\r\n            a => a.userId === user.id && a.monthIndex === month.globalIndex\r\n          )\r\n          \r\n          if (userAllocations.length > 0) {\r\n            const totalAllocated = userAllocations.reduce((sum, a) => sum + (a.percentage || 0), 0)\r\n            let displayValue\r\n            \r\n            if (viewMode === 'days') {\r\n              displayValue = getDaysFromPercentage(user.id, month.globalIndex, totalAllocated)\r\n              userRow.push(`${displayValue} days`)\r\n            } else {\r\n              displayValue = Math.round(totalAllocated)\r\n              userRow.push(`${displayValue}%`)\r\n            }\r\n          } else {\r\n            // Check if user hasn't started or has ended\r\n            if (!isUserStartedInMonth(user.id, month.globalIndex)) {\r\n              userRow.push(\"not started\")\r\n            } else if (isUserEndedInMonth(user.id, month.globalIndex)) {\r\n              userRow.push(\"ended\")\r\n            } else {\r\n              userRow.push(\"\")\r\n            }\r\n          }\r\n        })\r\n        \r\n        csvContent += userRow.join(\",\") + \"\\n\"\r\n      })\r\n    })\r\n    \r\n    // Create and download the file\r\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' })\r\n    const link = document.createElement('a')\r\n    const url = URL.createObjectURL(blob)\r\n    \r\n    const fileName = `staff-allocation-${viewMode}-${new Date().toISOString().split('T')[0]}.csv`\r\n    link.setAttribute('href', url)\r\n    link.setAttribute('download', fileName)\r\n    link.style.visibility = 'hidden'\r\n    document.body.appendChild(link)\r\n    link.click()\r\n    document.body.removeChild(link)\r\n  }\r\n\r\n  // Export month detail to Excel function\r\n  const exportMonthDetailToExcel = () => {\r\n    if (!selectedMonthForDetail) return\r\n    \r\n    // Create CSV content for month detail view\r\n    let csvContent = \"\"\r\n    \r\n    // Add header row with projects\r\n    const headerRow = [\"Staff\", ...filteredProjects.map(p => p.name), \"Total\"]\r\n    csvContent += headerRow.join(\",\") + \"\\n\"\r\n    \r\n    // Add department rows and user data for the selected month\r\n    groupedUsers.forEach(group => {\r\n      // Add department header\r\n      csvContent += `${group.department},\\n`\r\n      \r\n      // Add users in this department\r\n      group.users.forEach(user => {\r\n        const userRow = [user.name]\r\n        \r\n        // Add allocations for each project\r\n        filteredProjects.forEach(project => {\r\n          const userAllocations = allocations.filter(\r\n            a => a.userId === user.id && \r\n            a.projectId === project.id && \r\n            a.monthIndex === selectedMonthForDetail.globalIndex\r\n          )\r\n          \r\n          if (userAllocations.length > 0) {\r\n            const totalAllocated = userAllocations.reduce((sum, a) => sum + (a.percentage || 0), 0)\r\n            let displayValue\r\n            \r\n            if (viewMode === 'days') {\r\n              displayValue = Math.round(getDaysFromPercentage(user.id, selectedMonthForDetail.globalIndex, totalAllocated))\r\n              userRow.push(`${displayValue} days`)\r\n            } else {\r\n              displayValue = Math.round(totalAllocated)\r\n              userRow.push(`${displayValue}%`)\r\n            }\r\n          } else {\r\n            userRow.push(\"\")\r\n          }\r\n        })\r\n        \r\n        // Add total column\r\n        const totalAllocated = allocations\r\n          .filter((a) => a.userId === user.id && a.monthIndex === selectedMonthForDetail.globalIndex)\r\n          .reduce((sum, a) => sum + (a.percentage || 0), 0)\r\n        \r\n        if (viewMode === 'days') {\r\n          const totalDays = Math.round(getDaysFromPercentage(user.id, selectedMonthForDetail.globalIndex, totalAllocated))\r\n          userRow.push(`${totalDays} days`)\r\n        } else {\r\n          userRow.push(`${Math.round(totalAllocated)}%`)\r\n        }\r\n        \r\n        csvContent += userRow.join(\",\") + \"\\n\"\r\n      })\r\n    })\r\n    \r\n    // Create and download the file\r\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' })\r\n    const link = document.createElement('a')\r\n    const url = URL.createObjectURL(blob)\r\n    \r\n    const fileName = `staff-allocation-detail-${MONTHS[selectedMonthForDetail.month]}-${selectedMonthForDetail.year}-${viewMode}-${new Date().toISOString().split('T')[0]}.csv`\r\n    link.setAttribute('href', url)\r\n    link.setAttribute('download', fileName)\r\n    link.style.visibility = 'hidden'\r\n    document.body.appendChild(link)\r\n    link.click()\r\n    document.body.removeChild(link)\r\n  }\r\n\r\n  const updateProject = (projectId: string, updates: Partial<Project>) => {\r\n    console.log(\"[v0] updateProject called:\", { projectId, updates })\r\n    console.trace(\"[v0] updateProject call stack\")\r\n    setProjects((prev) => {\r\n      const existing = prev.find((p) => p.id === projectId)\r\n      if (existing && Object.entries(updates).every(([key, value]) => existing[key as keyof Project] === value)) {\r\n        console.log(\"[v0] Skipping update: no actual changes detected\")\r\n        return prev\r\n      }\r\n      const next = prev.map((p) => (p.id === projectId ? { ...p, ...updates } : p))\r\n      console.log(\"[v0] projects after update:\", next)\r\n      return next\r\n    })\r\n  }\r\n\r\n  const deleteProject = (projectId: string) => {\r\n    setProjects((prev) => prev.filter((p) => p.id !== projectId))\r\n    setAllocations((prev) => prev.filter((a) => a.projectId !== projectId))\r\n  }\r\n\r\n  const addUser = () => {\r\n    setEditingUserId(null)\r\n    setEditingUserName(\"\")\r\n    setEditingUserDept(\"\")\r\n    setEditingUserEntity(\"\")\r\n    setEditingUserVendorAC(\"\")\r\n    setEditingUserStartDate(\"\")\r\n    setEditingUserEndDate(\"\")\r\n    setEditingUserWorkDays('mon-fri')\r\n    setShowUserModal(true)\r\n  }\r\n\r\n  const editUser = (userId: string) => {\r\n    const user = users.find((u) => u.id === userId)\r\n    if (user) {\r\n      setEditingUserId(userId)\r\n      setEditingUserName(user.name)\r\n      setEditingUserDept(user.department)\r\n      setEditingUserEntity(user.entity || \"\")\r\n      setEditingUserVendorAC(user.vendorAC || \"\")\r\n      setEditingUserStartDate(user.startDate || \"\")\r\n      setEditingUserEndDate(user.endDate || \"\")\r\n      setEditingUserWorkDays(user.workDays || 'mon-fri')\r\n      setShowUserModal(true)\r\n    }\r\n  }\r\n\r\n  const saveUserChanges = () => {\r\n    if (!editingUserName.trim()) return\r\n\r\n    if (editingUserId) {\r\n      setUsers((prev) =>\r\n        prev.map((u) =>\r\n          u.id === editingUserId\r\n            ? {\r\n                ...u,\r\n                name: editingUserName,\r\n                department: editingUserDept,\r\n                entity: editingUserEntity || undefined,\r\n                vendorAC: editingUserVendorAC || undefined,\r\n                startDate: editingUserStartDate || undefined,\r\n                endDate: editingUserEndDate || undefined,\r\n                workDays: editingUserWorkDays,\r\n              }\r\n            : u,\r\n        ),\r\n      )\r\n    } else {\r\n      const newUser: User = {\r\n        id: `user-${Date.now()}`,\r\n        name: editingUserName,\r\n        department: editingUserDept,\r\n        entity: editingUserEntity || undefined,\r\n        vendorAC: editingUserVendorAC || undefined,\r\n        startDate: editingUserStartDate || undefined,\r\n        endDate: editingUserEndDate || undefined,\r\n        workDays: editingUserWorkDays,\r\n      }\r\n      setUsers((prev) => [...prev, newUser])\r\n    }\r\n\r\n    setShowUserModal(false)\r\n    setEditingUserId(null)\r\n    setEditingUserName(\"\")\r\n    setEditingUserDept(\"\")\r\n    setEditingUserEntity(\"\")\r\n    setEditingUserVendorAC(\"\")\r\n    setEditingUserStartDate(\"\")\r\n    setEditingUserEndDate(\"\")\r\n    setEditingUserWorkDays('mon-fri')\r\n  }\r\n\r\n  const deleteUser = (userId: string) => {\r\n    setUsers((prev) => prev.filter((u) => u.id !== userId))\r\n    setAllocations((prev) => prev.filter((a) => a.userId !== userId))\r\n  }\r\n\r\n  const updatePositions = (newPositions: Position[]) => {\r\n    const updatedProjects = projects.map((project) => ({\r\n      ...project,\r\n      positions: newPositions.filter((p) => p.projectId === project.id),\r\n    }))\r\n    setProjects(updatedProjects)\r\n    \r\n    // Update allocations to match new position budgets\r\n    const updatedAllocations = allocations.map(allocation => {\r\n      const newPosition = newPositions.find(p => \r\n        p.projectId === allocation.projectId && \r\n        p.monthIndex === allocation.monthIndex && \r\n        p.name === allocation.positionName\r\n      )\r\n      \r\n      if (newPosition && allocation.percentage > newPosition.percentage) {\r\n        // Reduce allocation to match new budget\r\n        return {\r\n          ...allocation,\r\n          percentage: newPosition.percentage\r\n        }\r\n      }\r\n      \r\n      return allocation\r\n    })\r\n    \r\n    setAllocations(updatedAllocations)\r\n  }\r\n\r\n  const handleMonthClick = (monthIndex: number) => {\r\n    const year = Math.floor(monthIndex / 12) + 2024\r\n    const month = monthIndex % 12\r\n    setSelectedMonthForDetail({ year, month, globalIndex: monthIndex })\r\n    setShowMonthDetail(true)\r\n  }\r\n\r\n  // Months shown in the grid. The globalIndex here MUST match how ProjectManager\r\n  // stores position.monthIndex: (year - 2024) * 12 + month.\r\n  const months = Array.from({ length: 12 }, (_, i) => {\r\n    const date = new Date(startYear, startMonth + i, 1)\r\n    const month = date.getMonth()\r\n    const year = date.getFullYear()\r\n    const globalIndex = (year - 2024) * 12 + month\r\n\r\n    return {\r\n      month,\r\n      year,\r\n      globalIndex,\r\n      display: `${MONTHS[month].slice(0, 3).toUpperCase()} ${String(year).slice(-2)}`,\r\n    }\r\n  })\r\n\r\n  const handleEmptyCellClick = (userId: string, monthIndex: number) => {\r\n    if (!canEdit) return // Only allow editing if user is admin\r\n    \r\n    console.log(\"[v0] Empty cell clicked:\", { userId, monthIndex, selectedMonth })\r\n\r\n    // Respect user end date: do not allow new allocations after their end date\r\n    const user = users.find((u) => u.id === userId)\r\n    if (user?.endDate) {\r\n      const end = new Date(user.endDate)\r\n      if (!Number.isNaN(end.getTime())) {\r\n        const endMonth = end.getMonth() // 0-11\r\n        const endYear = end.getFullYear()\r\n        const endGlobalIndex = (endYear - 2024) * 12 + endMonth\r\n        if (monthIndex > endGlobalIndex) {\r\n          // After end date: block allocation\r\n          return\r\n        }\r\n      }\r\n    }\r\n    \r\n    // Respect user start date: do not allow new allocations before their start date\r\n    if (user?.startDate) {\r\n      const start = new Date(user.startDate)\r\n      if (!Number.isNaN(start.getTime())) {\r\n        const startMonth = start.getMonth() // 0-11\r\n        const startYear = start.getFullYear()\r\n        const startGlobalIndex = (startYear - 2024) * 12 + startMonth\r\n        if (monthIndex < startGlobalIndex) {\r\n          // Before start date: block allocation\r\n          return\r\n        }\r\n      }\r\n    }\r\n\r\n    setSelectedCellUser(userId)\r\n    setSelectedCellMonth(monthIndex)\r\n    setShowPositionModal(true)\r\n  }\r\n\r\n  // Helper to check if user has ended by a given month\r\n  const isUserEndedInMonth = (userId: string, monthIndex: number): boolean => {\r\n    const user = users.find((u) => u.id === userId)\r\n    if (!user?.endDate) return false\r\n    \r\n    const end = new Date(user.endDate)\r\n    if (Number.isNaN(end.getTime())) return false\r\n    \r\n    const endMonth = end.getMonth() // 0-11\r\n    const endYear = end.getFullYear()\r\n    const endGlobalIndex = (endYear - 2024) * 12 + endMonth\r\n    \r\n    return monthIndex > endGlobalIndex\r\n  }\r\n  \r\n  // Helper to check if user has started by a given month\r\n  const isUserStartedInMonth = (userId: string, monthIndex: number): boolean => {\r\n    const user = users.find((u) => u.id === userId)\r\n    if (!user?.startDate) return true\r\n    \r\n    const start = new Date(user.startDate)\r\n    if (Number.isNaN(start.getTime())) return true\r\n    \r\n    const startMonth = start.getMonth() // 0-11\r\n    const startYear = start.getFullYear()\r\n    const startGlobalIndex = (startYear - 2024) * 12 + startMonth\r\n    \r\n    return monthIndex >= startGlobalIndex\r\n  }\r\n\r\n  // Helper to calculate working days in a month\r\n  const getWorkingDaysInMonth = (year: number, month: number, startDay: number = 1): number => {\r\n    const date = new Date(year, month, 1)\r\n    const daysInMonth = new Date(year, month + 1, 0).getDate()\r\n    let workingDays = 0\r\n    \r\n    for (let day = 1; day <= daysInMonth; day++) {\r\n      date.setDate(day)\r\n      const dayOfWeek = date.getDay() // 0 = Sunday, 6 = Saturday\r\n      \r\n      if (startDay === 1) {\r\n        // Monday to Friday (1-5)\r\n        if (dayOfWeek >= 1 && dayOfWeek <= 5) {\r\n          workingDays++\r\n        }\r\n      } else {\r\n        // Sunday to Thursday (0-4)\r\n        if (dayOfWeek >= 0 && dayOfWeek <= 4) {\r\n          workingDays++\r\n        }\r\n      }\r\n    }\r\n    \r\n    return workingDays\r\n  }\r\n\r\n  // Helper to convert percentage to days based on user work pattern\r\n  const getDaysFromPercentage = (userId: string, monthIndex: number, percentage: number): number => {\r\n    const user = users.find((u) => u.id === userId)\r\n    if (!user) return 0\r\n    \r\n    // Get the month and year from monthIndex\r\n    const year = Math.floor(monthIndex / 12) + 2024\r\n    const month = monthIndex % 12\r\n    \r\n    // Get working days based on user's work pattern\r\n    const workPattern = user.workDays || 'mon-fri'\r\n    const startDay = workPattern === 'mon-fri' ? 1 : 0\r\n    const workingDays = getWorkingDaysInMonth(year, month, startDay)\r\n    \r\n    // Calculate days from percentage\r\n    return Math.round((percentage / 100) * workingDays)\r\n  }\r\n\r\n  const handleAddAllocation = (projectId: string, positionName: string, customAmount?: number) => {\r\n    if (selectedCellUser && selectedCellMonth !== null) {\r\n      // Find the underlying position so we can link by positionId\r\n      const project = projects.find((p) => p.id === projectId)\r\n      const position = project?.positions?.find(\r\n        (pos) => pos.monthIndex === selectedCellMonth && pos.name === positionName,\r\n      )\r\n\r\n      // If we can't find the position or it has no budget, do nothing\r\n      if (!position || !position.percentage) {\r\n        return\r\n      }\r\n\r\n      // How much of this position is already allocated in this month (across all users)\r\n      const alreadyAllocated = allocations\r\n        .filter(\r\n          (a) =>\r\n            a.projectId === projectId &&\r\n            a.monthIndex === selectedCellMonth &&\r\n            (a.positionId === position.id || a.positionName === positionName),\r\n        )\r\n        .reduce((sum, a) => sum + (a.percentage || 0), 0)\r\n\r\n      const remaining = Math.max(0, position.percentage - alreadyAllocated)\r\n\r\n      // Nothing left to allocate\r\n      if (remaining <= 0) {\r\n        return\r\n      }\r\n\r\n      // Use custom amount if provided, otherwise use full remaining\r\n      const allocationAmount = customAmount ? Math.min(customAmount, remaining) : remaining\r\n\r\n      const newAllocation: Allocation = {\r\n        id: `alloc-${Date.now()}`,\r\n        userId: selectedCellUser,\r\n        projectId,\r\n        monthIndex: selectedCellMonth,\r\n        percentage: allocationAmount,\r\n        positionId: position?.id,\r\n        positionName,\r\n      }\r\n      setAllocations((prev) => [...prev, newAllocation])\r\n\r\n      // Update allocated amount in positions\r\n      setProjects((prev) =>\r\n        prev.map((p) =>\r\n          p.id === projectId\r\n            ? {\r\n                ...p,\r\n                positions: p.positions?.map((pos) =>\r\n                  pos.monthIndex === selectedCellMonth && pos.name === positionName\r\n                    ? { ...pos, allocated: (pos.allocated || 0) + allocationAmount }\r\n                    : pos,\r\n                ),\r\n              }\r\n            : p,\r\n        ),\r\n      )\r\n\r\n      // Close modal and reset custom allocation state\r\n      setShowPositionModal(false)\r\n      setSelectedPositionForCustom(null)\r\n      setCustomAllocationAmount({})\r\n      setSelectedCellUser(null)\r\n      setSelectedCellMonth(null)\r\n    }\r\n  }\r\n\r\n  const handleRemoveAllocation = (allocationId: string) => {\r\n    const allocation = allocations.find((a) => a.id === allocationId)\r\n    if (allocation) {\r\n      setProjects((prev) =>\r\n        prev.map((p) =>\r\n          p.id === allocation.projectId\r\n            ? {\r\n                ...p,\r\n                positions: p.positions?.map((pos) =>\r\n                  pos.monthIndex === allocation.monthIndex && pos.name === allocation.positionName\r\n                    ? { ...pos, allocated: Math.max(0, (pos.allocated || 0) - 1) }\r\n                    : pos,\r\n                ),\r\n              }\r\n            : p,\r\n        ),\r\n      )\r\n    }\r\n    setAllocations((prev) => prev.filter((a) => a.id !== allocationId))\r\n  }\r\n\r\n  const cleanupAllocations = (projectId: string, validPositionIds: string[]) => {\r\n    setAllocations((prev) => {\r\n      const filtered = prev.filter((allocation) => {\r\n        // Keep allocation if it's not for this project\r\n        if (allocation.projectId !== projectId) return true\r\n        \r\n        // Keep allocation if it has a valid positionId\r\n        if (allocation.positionId && validPositionIds.includes(allocation.positionId)) return true\r\n        \r\n        // Remove allocation if positionId is not in the valid list\r\n        return false\r\n      })\r\n      \r\n      // Update allocated counts for the affected positions\r\n      const removedAllocations = prev.filter((allocation) => {\r\n        return allocation.projectId === projectId && \r\n               (!allocation.positionId || !validPositionIds.includes(allocation.positionId))\r\n      })\r\n      \r\n      if (removedAllocations.length > 0) {\r\n        setProjects((projectsPrev) =>\r\n          projectsPrev.map((project) =>\r\n            project.id === projectId\r\n              ? {\r\n                  ...project,\r\n                  positions: project.positions?.map((position) => {\r\n                    const removedCount = removedAllocations\r\n                      .filter((a) => a.positionId === position.id)\r\n                      .reduce((sum, a) => sum + (a.percentage || 0), 0)\r\n                    \r\n                    return {\r\n                      ...position,\r\n                      allocated: Math.max(0, (position.allocated || 0) - removedCount),\r\n                    }\r\n                  }),\r\n                }\r\n              : project,\r\n          ),\r\n        )\r\n      }\r\n      \r\n      return filtered\r\n    })\r\n  }\r\n\r\n  const handleEditAllocation = (allocationId: string, newPercentage: number) => {\r\n    setAllocations((prev) => prev.map((a) => (a.id === allocationId ? { ...a, percentage: newPercentage } : a)))\r\n    setEditingId(null)\r\n    setEditValue(0)\r\n  }\r\n\r\n  // Only show users who are active for the current grid window.\r\n  // If a user has an endDate before the starting month/year, hide them.\r\n  // If a user has a startDate after the ending month/year, hide them.\r\n  const gridStartGlobalIndex = (startYear - 2024) * 12 + startMonth\r\n  const gridEndGlobalIndex = gridStartGlobalIndex + 11 // 12 months total\r\n\r\n  const activeUsers = users.filter((user) => {\r\n    // Check end date filtering\r\n    if (user.endDate) {\r\n      const end = new Date(user.endDate)\r\n      if (!Number.isNaN(end.getTime())) {\r\n        const endMonth = end.getMonth() // 0-11\r\n        const endYear = end.getFullYear()\r\n        const endGlobalIndex = (endYear - 2024) * 12 + endMonth\r\n        if (endGlobalIndex < gridStartGlobalIndex) {\r\n          return false // User ended before grid starts\r\n        }\r\n      }\r\n    }\r\n\r\n    // Check start date filtering\r\n    if (user.startDate) {\r\n      const start = new Date(user.startDate)\r\n      if (!Number.isNaN(start.getTime())) {\r\n        const startMonth = start.getMonth() // 0-11\r\n        const startYear = start.getFullYear()\r\n        const startGlobalIndex = (startYear - 2024) * 12 + startMonth\r\n        if (startGlobalIndex > gridEndGlobalIndex) {\r\n          return false // User starts after grid ends\r\n        }\r\n      }\r\n    }\r\n\r\n    return true\r\n  })\r\n\r\n  // Filter users based on selected project\r\n  const filteredUsers = selectedProjectId \r\n    ? activeUsers.filter(user => \r\n        allocations.some(allocation => \r\n          allocation.userId === user.id && \r\n          allocation.projectId === selectedProjectId\r\n        )\r\n      )\r\n    : activeUsers\r\n\r\n  const groupedUsers = Array.from(\r\n    filteredUsers.reduce((acc, user) => {\r\n      if (!acc.has(user.department)) {\r\n        acc.set(user.department, [])\r\n      }\r\n      acc.get(user.department)!.push(user)\r\n      return acc\r\n    }, new Map<string, User[]>()),\r\n  ).map(([dept, deptUsers]) => ({\r\n    department: dept,\r\n    users: deptUsers.sort((a, b) => a.name.localeCompare(b.name)),\r\n  })).sort((a, b) => a.department.localeCompare(b.department))\r\n\r\n  return (\r\n    <div className=\"space-y-4 p-6\">\r\n      <div className=\"flex justify-between items-start gap-4\">\r\n        <div>\r\n          {/* Project Management - for admins, editors, and viewers (read-only) */}\r\n          {(currentUserRole === 'admin' || currentUserRole === 'editor' || currentUserRole === 'viewer') && (\r\n            <ProjectManager\r\n              projects={filteredProjects}\r\n              positions={filteredProjects.flatMap((p) => p.positions || [])}\r\n              months={MONTHS}\r\n              startMonth={startMonth}\r\n              startYear={startYear}\r\n              onAddProject={addProject}\r\n              onUpdateProject={updateProject}\r\n              onDeleteProject={deleteProject}\r\n              onUpdatePositions={updatePositions}\r\n              onProjectSelect={setSelectedProjectId}\r\n              selectedProjectId={selectedProjectId}\r\n              onCleanupAllocations={cleanupAllocations}\r\n              currentUserRole={currentUserRole}\r\n            />\r\n          )}\r\n        </div>\r\n        <div className=\"flex gap-4 items-end\">\r\n          <div className=\"space-y-2\">\r\n            <label className=\"block text-sm font-medium\">Starting Month</label>\r\n            <select\r\n              value={startMonth}\r\n              onChange={(e) => setStartMonth(Number.parseInt(e.target.value))}\r\n              className=\"border rounded px-2 py-1\"\r\n            >\r\n              {MONTHS.map((month, idx) => (\r\n                <option key={month} value={idx}>\r\n                  {month}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            <label className=\"block text-sm font-medium\">Starting Year</label>\r\n            <select\r\n              value={startYear}\r\n              onChange={(e) => setStartYear(Number.parseInt(e.target.value))}\r\n              className=\"border rounded px-2 py-1\"\r\n            >\r\n              {YEARS.map((year) => (\r\n                <option key={year} value={year}>\r\n                  {year}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"space-y-2 rounded-full\">\r\n        <div className=\"flex justify-between items-center\">\r\n          <div className=\"flex items-center gap-2\">\r\n            {selectedProjectId && (\r\n              <div className=\"flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm\">\r\n                <span>Filtered by: {projects.find(p => p.id === selectedProjectId)?.name}</span>\r\n                <button\r\n                  onClick={() => setSelectedProjectId(null)}\r\n                  className=\"text-blue-600 hover:text-blue-800 font-bold\"\r\n                >\r\n                  Ã—\r\n                </button>\r\n              </div>\r\n            )}\r\n            {/* Add Staff button - only for admins and editors */}\r\n            {(currentUserRole === 'admin' || currentUserRole === 'editor') && (\r\n              <Button onClick={addUser} variant=\"default\" size=\"sm\" className=\"bg-blue-900 hover:bg-blue-800 text-white\">\r\n                + New Staff\r\n              </Button>\r\n            )}\r\n            {/* View Mode Selector */}\r\n            <div className=\"flex items-center gap-2 ml-4\">\r\n              <span className=\"text-sm text-gray-600\">View:</span>\r\n              <div className=\"flex border rounded overflow-hidden\">\r\n                <button\r\n                  onClick={() => setViewMode('percentage')}\r\n                  className={`px-3 py-1 text-sm font-medium transition-colors ${\r\n                    viewMode === 'percentage'\r\n                      ? 'bg-blue-600 text-white'\r\n                      : 'bg-white text-gray-700 hover:bg-gray-100'\r\n                  }`}\r\n                >\r\n                  % View\r\n                </button>\r\n                <button\r\n                  onClick={() => setViewMode('days')}\r\n                  className={`px-3 py-1 text-sm font-medium transition-colors ${\r\n                    viewMode === 'days'\r\n                      ? 'bg-blue-600 text-white'\r\n                      : 'bg-white text-gray-700 hover:bg-gray-100'\r\n                  }`}\r\n                >\r\n                  Days View\r\n                </button>\r\n              </div>\r\n            </div>\r\n            {/* Export to Excel Button */}\r\n            <button\r\n              onClick={exportToExcel}\r\n              className=\"px-3 py-1 text-sm bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors ml-4\"\r\n            >\r\n              Export to Excel\r\n            </button>\r\n            {/* Gantt Chart Button */}\r\n            <button\r\n              onClick={() => setShowGanttChart(true)}\r\n              className=\"px-3 py-1 text-sm bg-green-600 text-white rounded hover:bg-green-700 transition-colors ml-2\"\r\n              title=\"Show Project Gantt Chart\"\r\n            >\r\n              ðŸ“Š Gantt Chart\r\n            </button>\r\n          </div>\r\n          <div className=\"flex gap-2 items-center\">\r\n            {/* Current User Display */}\r\n            <div className=\"text-right mr-4\">\r\n              <div className=\"text-sm text-gray-600\">Current User</div>\r\n              <div className=\"font-medium\">{currentUser}</div>\r\n              <div className=\"text-xs text-gray-500 capitalize\">{currentUserRole}</div>\r\n            </div>\r\n            {/* User Management button - only for admins */}\r\n            {currentUserRole === 'admin' && (\r\n              <Button \r\n                onClick={() => setShowUserManagement(true)} \r\n                variant=\"outline\" \r\n                size=\"sm\"\r\n                className=\"flex items-center gap-2\"\r\n              >\r\n                <svg\r\n                  className=\"w-4 h-4\"\r\n                  fill=\"none\"\r\n                  stroke=\"currentColor\"\r\n                  viewBox=\"0 0 24 24\"\r\n                >\r\n                  <path\r\n                    strokeLinecap=\"round\"\r\n                    strokeLinejoin=\"round\"\r\n                    strokeWidth={2}\r\n                    d=\"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z\"\r\n                  />\r\n                </svg>\r\n                Users\r\n              </Button>\r\n            )}\r\n            <Button\r\n              onClick={() => {\r\n                // Clear current user session but keep their data\r\n                const user = getCurrentUser()\r\n                if (user) {\r\n                  setCurrentUserData({ startMonth, startYear }) // Save current view settings\r\n                }\r\n                clearCurrentUser()\r\n                window.location.href = \"/login\"\r\n              }}\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              className=\"flex items-center gap-2\"\r\n            >\r\n              <svg\r\n                className=\"w-4 h-4\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1\"\r\n                />\r\n              </svg>\r\n              Logout\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"w-full border-collapse border border-gray-300\">\r\n            <thead>\r\n              <tr>\r\n                <th className=\"border border-gray-300 p-2 bg-gray-100 w-42\">Staff</th>\r\n                {months.map((month, idx) => {\r\n                  const monFriDays = getWorkingDaysInMonth(month.year, month.month, 1) // Monday to Friday\r\n                  const sunThuDays = getWorkingDaysInMonth(month.year, month.month, 0) // Sunday to Thursday\r\n                  return (\r\n                    <th\r\n                      key={idx}\r\n                      className=\"border border-gray-300 p-2 bg-gray-100 w-32 cursor-pointer hover:bg-gray-200 text-sm\"\r\n                      onClick={() => handleMonthClick(month.globalIndex)}\r\n                    >\r\n                      <div className=\"flex flex-col items-center\">\r\n                        <div>{month.display}</div>\r\n                        <div className=\"text-[10px] text-gray-600 mt-1\">\r\n                          <div>Mon-Fri: {monFriDays}</div>\r\n                          <div>Sun-Thu: {sunThuDays}</div>\r\n                        </div>\r\n                      </div>\r\n                    </th>\r\n                  )\r\n                })}\r\n              </tr>\r\n              <tr>\r\n                <th className=\"border border-gray-300 bg-gray-50 w-42 text-xs text-muted-foreground\">Unallocated</th>\r\n                {months.map((month) => {\r\n                  const monthUnallocated = filteredProjects.flatMap((project) => {\r\n                    const positionsForMonth =\r\n                      project.positions?.filter((pos) => pos.monthIndex === month.globalIndex) || []\r\n\r\n                    return positionsForMonth\r\n                      .map((position) => {\r\n                        const allocated = allocations\r\n                          .filter(\r\n                            (a) =>\r\n                              a.projectId === project.id &&\r\n                              a.monthIndex === month.globalIndex &&\r\n                              a.positionId === position.id,\r\n                          )\r\n                          .reduce((sum, a) => sum + (a.percentage || 0), 0)\r\n\r\n                        const unallocated = Math.max(0, position.percentage - allocated)\r\n                        if (unallocated <= 0) return null\r\n\r\n                        // Calculate display value based on project allocation mode and view mode\r\n                        let displayValue: number\r\n                        let displayText: string\r\n                        \r\n                        if (viewMode === 'days') {\r\n                          // Day view - calculate days for both allocation modes\r\n                          const workingDays = getWorkingDaysInMonth(month.year, month.month, 1) // Default to Mon-Fri\r\n                          const calculatedDays = Math.round((unallocated / 100) * workingDays)\r\n                          displayValue = calculatedDays\r\n                          displayText = `${calculatedDays} days`\r\n                        } else {\r\n                          // Percentage view - show rounded percentages for both allocation modes\r\n                          displayValue = Math.round(unallocated)\r\n                          displayText = `${displayValue}%`\r\n                        }\r\n\r\n                        return {\r\n                          projectId: project.id,\r\n                          projectName: project.name,\r\n                          projectColor: project.color,\r\n                          positionId: position.id,\r\n                          positionName: position.name || \"Position\",\r\n                          percentage: unallocated,\r\n                          displayValue,\r\n                          displayText,\r\n                        }\r\n                      })\r\n                      .filter((p): p is NonNullable<typeof p> => p != null)\r\n                  })\r\n\r\n                  return (\r\n                    <td\r\n                      key={month.globalIndex}\r\n                      className=\"border border-gray-300 bg-gray-50 p-1 align-top\"\r\n                      style={{ verticalAlign: \"top\" }}\r\n                    >\r\n                      <div className=\"flex flex-wrap gap-1\">\r\n                        {monthUnallocated.map((pos) => (\r\n                          <div\r\n                            key={`${pos.projectId}-${pos.positionId}`}\r\n                            className=\"flex items-center h-8 rounded overflow-hidden bg-gray-200 text-[9px] text-white\"\r\n                            style={{\r\n                              minWidth: \"50px\",\r\n                              maxWidth: \"120px\",\r\n                            }}\r\n                            title={`${pos.projectName} - ${pos.positionName} (${pos.displayText} unallocated)`}\r\n                          >\r\n                            <div\r\n                              className=\"h-full flex items-center justify-center px-1 text-center leading-tight\"\r\n                              style={{\r\n                                backgroundColor: pos.projectColor || \"#3b82f6\",\r\n                                width: \"100%\",\r\n                              }}\r\n                            >\r\n                              {pos.positionName} ({pos.displayText})\r\n                            </div>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                    </td>\r\n                  )\r\n                })}\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {groupedUsers.map((group) => (\r\n                <React.Fragment key={group.department}>\r\n                  <tr>\r\n                    <td colSpan={months.length + 1} className=\"border border-gray-300 p-1 font-semibold text-xs text-gray-800 bg-cyan-200\">\r\n                      {group.department}\r\n                    </td>\r\n                  </tr>\r\n                  {group.users.map((user) => (\r\n                    <tr key={user.id}>\r\n                      <td className=\"border border-gray-300 p-1 w-42\">\r\n                        <div className=\"flex items-center justify-between gap-1\">\r\n                          <span className=\"text-xs leading-tight\">{user.name}</span>\r\n                          {/* Edit user button - only for admins */}\r\n                          {currentUserRole === 'admin' && (\r\n                            <button\r\n                              onClick={() => editUser(user.id)}\r\n                              className=\"text-blue-600 hover:text-blue-800 text-xs\"\r\n                            >\r\n                              âœï¸\r\n                            </button>\r\n                          )}\r\n                        </div>\r\n                      </td>\r\n                      {months.map((month) => (\r\n                        <AllocationCell\r\n                          key={`${user.id}-${month.globalIndex}`}\r\n                          userId={user.id}\r\n                          monthIndex={month.globalIndex}\r\n                          allocations={allocations.filter(\r\n                            (a) => a.userId === user.id && a.monthIndex === month.globalIndex,\r\n                          )}\r\n                          project={filteredProjects.find((p) => p.id === allocations[0]?.projectId)}\r\n                          projects={filteredProjects}\r\n                          users={users}\r\n                          month={month}\r\n                          userEnded={isUserEndedInMonth(user.id, month.globalIndex)}\r\n                          userNotStarted={!isUserStartedInMonth(user.id, month.globalIndex)}\r\n                          viewMode={viewMode}\r\n                          getDaysFromPercentage={getDaysFromPercentage}\r\n                          readOnly={currentUserRole === 'viewer'}\r\n                          onEdit={(id) => {\r\n                            setEditingId(id)\r\n                            const alloc = allocations.find((a) => a.id === id)\r\n                            if (alloc) setEditValue(alloc.percentage)\r\n                          }}\r\n                          onSaveEdit={handleEditAllocation}\r\n                          onRemove={handleRemoveAllocation}\r\n                          onEmptyCellClick={() => handleEmptyCellClick(user.id, month.globalIndex)}\r\n                        />\r\n                      ))}\r\n                    </tr>\r\n                  ))}\r\n                </React.Fragment>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      {showUserModal && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-lg p-6 w-96\">\r\n            <h3 className=\"text-lg font-bold mb-4\">{editingUserId ? \"Edit User\" : \"Add User\"}</h3>\r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1\">Name</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={editingUserName}\r\n                  onChange={(e) => setEditingUserName(e.target.value)}\r\n                  className=\"w-full border rounded px-2 py-1\"\r\n                  placeholder=\"User name\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1\">Department</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={editingUserDept}\r\n                  onChange={(e) => setEditingUserDept(e.target.value)}\r\n                  className=\"w-full border rounded px-2 py-1\"\r\n                  placeholder=\"Department\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1\">Entity</label>\r\n                <select\r\n                  value={editingUserEntity}\r\n                  onChange={(e) => setEditingUserEntity(e.target.value)}\r\n                  className=\"w-full border rounded px-2 py-1\"\r\n                >\r\n                  <option value=\"\">Select Entity</option>\r\n                  {entities.map(entity => (\r\n                    <option key={entity.id} value={entity.name}>\r\n                      {entity.name}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1\">Vendor AC</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={editingUserVendorAC}\r\n                  onChange={(e) => setEditingUserVendorAC(e.target.value)}\r\n                  className=\"w-full border rounded px-2 py-1\"\r\n                  placeholder=\"Vendor AC\"\r\n                />\r\n              </div>\r\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium mb-1\">Start Date</label>\r\n                  <input\r\n                    type=\"date\"\r\n                    value={editingUserStartDate}\r\n                    onChange={(e) => setEditingUserStartDate(e.target.value)}\r\n                    className=\"w-full border rounded px-2 py-1 text-sm\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-medium mb-1\">End Date</label>\r\n                  <input\r\n                    type=\"date\"\r\n                    value={editingUserEndDate}\r\n                    onChange={(e) => setEditingUserEndDate(e.target.value)}\r\n                    className=\"w-full border rounded px-2 py-1 text-sm\"\r\n                  />\r\n                  <p className=\"mt-1 text-[11px] text-gray-500\">Leave blank if working indefinitely.</p>\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1\">Work Days</label>\r\n                <select\r\n                  value={editingUserWorkDays}\r\n                  onChange={(e) => setEditingUserWorkDays(e.target.value as 'mon-fri' | 'sun-thu')}\r\n                  className=\"w-full border rounded px-2 py-1 text-sm\"\r\n                >\r\n                  <option value=\"mon-fri\">Monday - Friday</option>\r\n                  <option value=\"sun-thu\">Sunday - Thursday</option>\r\n                </select>\r\n              </div>\r\n              <div className=\"flex gap-2 justify-end\">\r\n                {editingUserId && (\r\n                  <Button\r\n                    variant=\"destructive\"\r\n                    onClick={() => {\r\n                      deleteUser(editingUserId)\r\n                      setShowUserModal(false)\r\n                    }}\r\n                  >\r\n                    Delete\r\n                  </Button>\r\n                )}\r\n                <Button variant=\"outline\" onClick={() => setShowUserModal(false)}>\r\n                  Cancel\r\n                </Button>\r\n                <Button onClick={saveUserChanges}>Save</Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {showPositionModal && selectedCellMonth !== null && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-lg p-6 w-[500px] max-h-[80vh] overflow-y-auto\">\r\n            <h3 className=\"text-lg font-bold mb-4\">Select Position</h3>\r\n            <div className=\"space-y-3\">\r\n              {projects.flatMap((project) => {\r\n                // Positions created in ProjectManager already use a global monthIndex (0 = Jan 2024, ...)\r\n                // Cells in the grid also use this same global monthIndex. So we just match directly.\r\n                const monthPositions = (project.positions || [])\r\n                  .filter((p) => p.monthIndex === selectedCellMonth && (p.percentage || 0) > 0)\r\n                  .map((p) => {\r\n                    const allocated = allocations\r\n                      .filter(\r\n                        (a) =>\r\n                          a.projectId === project.id &&\r\n                          a.monthIndex === selectedCellMonth &&\r\n                          a.positionName === p.name,\r\n                      )\r\n                      .reduce((sum, a) => sum + (a.percentage || 0), 0)\r\n\r\n                    const available = Math.max(0, (p.percentage || 0) - allocated)\r\n                    const availableDays = selectedCellUser \r\n                      ? getDaysFromPercentage(selectedCellUser, selectedCellMonth, available)\r\n                      : 0\r\n                    const allocatedDays = selectedCellUser \r\n                      ? getDaysFromPercentage(selectedCellUser, selectedCellMonth, allocated)\r\n                      : 0\r\n\r\n                    return {\r\n                      ...p,\r\n                      projectId: project.id,\r\n                      projectName: project.name,\r\n                      projectColor: project.color,\r\n                      available,\r\n                      availableDays,\r\n                      allocated,\r\n                      allocatedDays,\r\n                    }\r\n                  })\r\n                  .filter((p) => p.available > 0)\r\n\r\n                const availablePositions = monthPositions\r\n\r\n                return availablePositions.map((position) => {\r\n                  const positionKey = `${position.projectId}-${position.id}`\r\n                  const isCustomMode = selectedPositionForCustom === positionKey\r\n                  const customValue = customAllocationAmount[positionKey] || \"\"\r\n\r\n                  return (\r\n                    <div\r\n                      key={positionKey}\r\n                      className=\"border border-gray-200 rounded-lg p-3 hover:bg-blue-50 transition-colors\"\r\n                      style={{\r\n                        borderLeft: `4px solid ${position.projectColor}`,\r\n                      }}\r\n                    >\r\n                      <div className=\"flex justify-between items-start mb-2\">\r\n                        <div>\r\n                          <div className=\"font-medium\">{position.name || \"Unnamed\"}</div>\r\n                          <div className=\"text-sm text-gray-600\">{position.projectName}</div>\r\n                        </div>\r\n                        <div className=\"text-right\">\r\n                          <div className=\"text-sm font-medium\">\r\n                            {Math.round(position.available)}% ({position.availableDays} days)\r\n                          </div>\r\n                          <div className=\"text-xs text-gray-500\">\r\n                            {Math.round(position.allocated)}% ({position.allocatedDays} days) allocated\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      \r\n                      {/* Progress bar */}\r\n                      <div className=\"w-full bg-gray-200 rounded-full h-2 mb-3\">\r\n                        <div\r\n                          className=\"h-2 rounded-full transition-all duration-300\"\r\n                          style={{\r\n                            width: `${(position.allocated / position.percentage) * 100}%`,\r\n                            backgroundColor: position.projectColor,\r\n                          }}\r\n                        />\r\n                      </div>\r\n\r\n                      {/* Custom allocation controls */}\r\n                      <div className=\"space-y-2\">\r\n                        {!isCustomMode ? (\r\n                          <div className=\"flex gap-2\">\r\n                            <button\r\n                              onClick={() => {\r\n                                handleAddAllocation(position.projectId, position.name || \"\", position.available)\r\n                              }}\r\n                              className=\"flex-1 px-3 py-2 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 transition-colors\"\r\n                            >\r\n                              Allocate Full ({Math.round(position.available)}%)\r\n                            </button>\r\n                            <button\r\n                              onClick={() => {\r\n                                setSelectedPositionForCustom(positionKey)\r\n                                setCustomAllocationAmount({\r\n                                  ...customAllocationAmount,\r\n                                  [positionKey]: Math.round(position.available).toString()\r\n                                })\r\n                              }}\r\n                              className=\"flex-1 px-3 py-2 bg-gray-600 text-white rounded text-sm hover:bg-gray-700 transition-colors\"\r\n                            >\r\n                              Custom Amount\r\n                            </button>\r\n                          </div>\r\n                        ) : (\r\n                          <div className=\"space-y-2\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <input\r\n                                type=\"number\"\r\n                                min=\"0\"\r\n                                max={Math.round(position.available)}\r\n                                value={customValue}\r\n                                onChange={(e) => {\r\n                                  setCustomAllocationAmount({\r\n                                    ...customAllocationAmount,\r\n                                    [positionKey]: e.target.value\r\n                                  })\r\n                                }}\r\n                                className=\"flex-1 px-3 py-2 border border-gray-300 rounded text-sm\"\r\n                                placeholder={`Enter % (max: ${Math.round(position.available)})`}\r\n                              />\r\n                              <span className=\"text-sm text-gray-600\">%</span>\r\n                            </div>\r\n                            {selectedCellUser && (\r\n                              <div className=\"text-xs text-gray-500\">\r\n                                {customValue ? `${Math.round((Number(customValue) / 100) * getDaysFromPercentage(selectedCellUser, selectedCellMonth, 100))} days` : '0 days'}\r\n                              </div>\r\n                            )}\r\n                            <div className=\"flex gap-2\">\r\n                              <button\r\n                                onClick={() => {\r\n                                  const amount = Number(customValue)\r\n                                  if (amount > 0 && amount <= position.available) {\r\n                                    handleAddAllocation(position.projectId, position.name || \"\", amount)\r\n                                  }\r\n                                }}\r\n                                disabled={!customValue || Number(customValue) <= 0 || Number(customValue) > position.available}\r\n                                className=\"flex-1 px-3 py-2 bg-green-600 text-white rounded text-sm hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                              >\r\n                                Allocate Custom\r\n                              </button>\r\n                              <button\r\n                                onClick={() => {\r\n                                  setSelectedPositionForCustom(null)\r\n                                  setCustomAllocationAmount({\r\n                                    ...customAllocationAmount,\r\n                                    [positionKey]: \"\"\r\n                                  })\r\n                                }}\r\n                                className=\"flex-1 px-3 py-2 bg-gray-400 text-white rounded text-sm hover:bg-gray-500 transition-colors\"\r\n                              >\r\n                                Cancel\r\n                              </button>\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )\r\n                })\r\n              })}\r\n            </div>\r\n            {projects.every(\r\n              (project) =>\r\n                !project.positions?.some((p) => p.monthIndex === selectedCellMonth && (p.percentage || 0) > 0),\r\n            ) && (\r\n              <div className=\"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded text-sm text-yellow-800\">\r\n                No positions available for this month. Add positions in the project settings.\r\n              </div>\r\n            )}\r\n            <Button variant=\"outline\" onClick={() => {\r\n              setShowPositionModal(false)\r\n              setSelectedPositionForCustom(null)\r\n              setCustomAllocationAmount({})\r\n            }} className=\"w-full mt-4\">\r\n              Close\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* User Management Modal */}\r\n      <UserManagement \r\n        isOpen={showUserManagement} \r\n        onClose={() => setShowUserManagement(false)} \r\n      />\r\n\r\n      {/* Month Detail Modal */}\r\n      {showMonthDetail && selectedMonthForDetail && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-lg p-4 w-full max-w-7xl max-h-[95vh] overflow-y-auto mx-2\">\r\n            <div className=\"flex justify-between items-center mb-3\">\r\n              <div>\r\n                <h2 className=\"text-base font-bold\">\r\n                  Staff Allocation Detail - {MONTHS[selectedMonthForDetail.month]} {selectedMonthForDetail.year}\r\n                </h2>\r\n                {/* View Mode Selector */}\r\n                <div className=\"flex items-center gap-2 mt-1\">\r\n                  <span className=\"text-xs text-gray-600\">View:</span>\r\n                  <div className=\"flex border rounded overflow-hidden\">\r\n                    <button\r\n                      onClick={() => setViewMode('percentage')}\r\n                      className={`px-2 py-1 text-xs font-medium transition-colors ${\r\n                        viewMode === 'percentage'\r\n                          ? 'bg-blue-600 text-white'\r\n                          : 'bg-white text-gray-700 hover:bg-gray-100'\r\n                      }`}\r\n                    >\r\n                      % View\r\n                    </button>\r\n                    <button\r\n                      onClick={() => setViewMode('days')}\r\n                      className={`px-2 py-1 text-xs font-medium transition-colors ${\r\n                        viewMode === 'days'\r\n                          ? 'bg-blue-600 text-white'\r\n                          : 'bg-white text-gray-700 hover:bg-gray-100'\r\n                      }`}\r\n                    >\r\n                      Days View\r\n                    </button>\r\n                  </div>\r\n                  {/* Export to Excel Button */}\r\n                  <button\r\n                    onClick={exportMonthDetailToExcel}\r\n                    className=\"px-2 py-1 text-xs bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors ml-3\"\r\n                  >\r\n                    Export to Excel\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              <button\r\n                onClick={() => {\r\n                  setShowMonthDetail(false)\r\n                  setSelectedMonthForDetail(null)\r\n                }}\r\n                className=\"px-2 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors text-xs\"\r\n              >\r\n                Ã— Close\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"w-full border-collapse border border-gray-300 text-xs\">\r\n                <thead>\r\n                  <tr>\r\n                    <th className=\"border border-gray-300 p-1 bg-gray-100 w-32 text-xs\">Staff</th>\r\n                    {filteredProjects.map((project) => (\r\n                      <th\r\n                        key={project.id}\r\n                        className=\"border border-gray-300 p-1 bg-gray-100 min-w-24 text-xs\"\r\n                        style={{ backgroundColor: project.color, color: getContrastColor(project.color) }}\r\n                      >\r\n                        {project.name}\r\n                      </th>\r\n                    ))}\r\n                    <th className=\"border border-gray-300 p-1 bg-gray-100 w-32 text-xs\">Total</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {groupedUsers.map((group) => (\r\n                    <React.Fragment key={group.department}>\r\n                      <tr>\r\n                        <td colSpan={filteredProjects.length + 2} className=\"border border-gray-300 p-1 font-semibold text-xs text-gray-800 bg-cyan-200\">\r\n                          {group.department}\r\n                        </td>\r\n                      </tr>\r\n                      {group.users.map((user) => (\r\n                        <tr key={user.id}>\r\n                          <td className=\"border border-gray-300 p-1 text-xs\">\r\n                            {user.name}\r\n                          </td>\r\n                          {filteredProjects.map((project) => {\r\n                            const userAllocations = allocations.filter(\r\n                              (a) => a.userId === user.id && a.monthIndex === selectedMonthForDetail.globalIndex\r\n                            )\r\n                            const projectAllocations = userAllocations.filter((a) => a.projectId === project.id)\r\n                            \r\n                            return (\r\n                              <td key={project.id} className=\"border border-gray-300 p-0.5 text-center\">\r\n                                {projectAllocations.length > 0 ? (\r\n                                  <div className=\"flex flex-col gap-0.5\">\r\n                                    {projectAllocations.map((allocation) => {\r\n                                      const position = project.positions?.find(\r\n                                        (p) => p.id === allocation.positionId\r\n                                      )\r\n                                      const displayValue = viewMode === 'days' \r\n                                        ? getDaysFromPercentage(user.id, selectedMonthForDetail.globalIndex, allocation.percentage)\r\n                                        : Math.round(allocation.percentage || 0)\r\n                                      const displayText = viewMode === 'days' \r\n                                        ? `${Math.round(displayValue)} days`\r\n                                        : `${displayValue}%`\r\n                                      \r\n                                      return (\r\n                                        <div\r\n                                          key={allocation.id}\r\n                                          className=\"text-[10px] px-1 py-0.5 rounded text-white leading-tight\"\r\n                                          style={{ backgroundColor: project.color }}\r\n                                          title={`${position?.name || 'Position'} - ${Math.round(allocation.percentage || 0)}%`}\r\n                                        >\r\n                                          {displayText}\r\n                                        </div>\r\n                                      )\r\n                                    })}\r\n                                  </div>\r\n                                ) : (\r\n                                  <div className=\"text-[10px] text-gray-400\">-</div>\r\n                                )}\r\n                              </td>\r\n                            )\r\n                          })}\r\n                          <td className=\"border border-gray-300 p-0.5 text-center text-xs font-medium\">\r\n                            {(() => {\r\n                              const totalAllocated = allocations\r\n                                .filter((a) => a.userId === user.id && a.monthIndex === selectedMonthForDetail.globalIndex)\r\n                                .reduce((sum, a) => sum + (a.percentage || 0), 0)\r\n                              const totalDays = getDaysFromPercentage(user.id, selectedMonthForDetail.globalIndex, totalAllocated)\r\n                              const roundedTotalAllocated = Math.round(totalAllocated)\r\n                              const roundedTotalDays = Math.round(totalDays)\r\n                              \r\n                              // Determine progress bar color and border\r\n                              let barColor = '#F59E0B' // Yellow (default for < 100%)\r\n                              let borderColor = 'transparent'\r\n                              \r\n                              if (roundedTotalAllocated >= 100) {\r\n                                if (roundedTotalAllocated > 100) {\r\n                                  barColor = '#10B981' // Green\r\n                                  borderColor = '#EF4444' // Red border for > 100%\r\n                                } else {\r\n                                  barColor = '#10B981' // Green\r\n                                  borderColor = 'transparent'\r\n                                }\r\n                              } else {\r\n                                barColor = '#F59E0B' // Yellow\r\n                                borderColor = 'transparent'\r\n                              }\r\n                              \r\n                              const displayText = viewMode === 'days' \r\n                                ? `${roundedTotalDays} days`\r\n                                : `${roundedTotalAllocated}%`\r\n                              \r\n                              return (\r\n                                <div className=\"w-full\">\r\n                                  {/* Progress bar */}\r\n                                  <div \r\n                                    className=\"w-full h-3 rounded relative overflow-hidden\"\r\n                                    style={{ \r\n                                      backgroundColor: '#E5E7EB',\r\n                                      border: borderColor !== 'transparent' ? `2px solid ${borderColor}` : 'none'\r\n                                    }}\r\n                                  >\r\n                                    {/* Progress bar fill - capped at 100% */}\r\n                                    <div\r\n                                      className=\"h-full rounded transition-all duration-300\"\r\n                                      style={{\r\n                                        width: `${Math.min(totalAllocated, 100)}%`, // Cap at 100% for display\r\n                                        backgroundColor: barColor\r\n                                      }}\r\n                                    />\r\n                                    {/* Text overlay - shows actual percentage */}\r\n                                    <div className=\"absolute inset-0 flex items-center justify-center text-[9px] font-medium\">\r\n                                      {viewMode === 'days' ? `${roundedTotalDays} days` : `${roundedTotalAllocated}%`}\r\n                                    </div>\r\n                                  </div>\r\n                                </div>\r\n                              )\r\n                            })()}\r\n                          </td>\r\n                        </tr>\r\n                      ))}\r\n                    </React.Fragment>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Gantt Chart Modal */}\r\n      {showGanttChart && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-lg p-6 w-full max-w-6xl max-h-[90vh] overflow-y-auto mx-4\">\r\n            <div className=\"flex justify-between items-center mb-4\">\r\n              <h2 className=\"text-xl font-bold\">Project Gantt Chart</h2>\r\n              <button\r\n                onClick={() => setShowGanttChart(false)}\r\n                className=\"text-gray-500 hover:text-gray-700 text-2xl font-bold\"\r\n              >\r\n                Ã—\r\n              </button>\r\n            </div>\r\n            \r\n            <div className=\"space-y-4\">\r\n              {projects.length === 0 ? (\r\n                <div className=\"text-center py-8 text-gray-500\">\r\n                  No projects to display in Gantt chart\r\n                </div>\r\n              ) : (\r\n                <>\r\n                  {/* Timeline Header with Date Selector */}\r\n                  <div className=\"bg-gray-50 p-3 rounded-lg\">\r\n                    <div className=\"flex justify-between items-center\">\r\n                      <div>\r\n                        <div className=\"text-sm font-medium text-gray-700\">Project Timeline (Monthly View)</div>\r\n                        <div className=\"text-xs text-gray-500\">\r\n                          Based on today's date: {new Date().toLocaleDateString()}\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <label className=\"text-xs font-medium text-gray-600\">Start Year:</label>\r\n                        <select\r\n                          value={ganttStartYear}\r\n                          onChange={(e) => setGanttStartYear(Number(e.target.value))}\r\n                          className=\"border border-gray-300 rounded px-2 py-1 text-xs bg-white\"\r\n                        >\r\n                          {(() => {\r\n                            const allDates = projects.flatMap(p => [\r\n                              p.startYear || 2024,\r\n                              p.endYear || 2024\r\n                            ])\r\n                            const minYear = Math.min(...allDates, new Date().getFullYear() - 2)\r\n                            const maxYear = Math.max(...allDates, new Date().getFullYear() + 2)\r\n                            const years = []\r\n                            for (let y = minYear; y <= maxYear; y++) {\r\n                              years.push(y)\r\n                            }\r\n                            return years.map(year => (\r\n                              <option key={year} value={year}>\r\n                                {year}\r\n                              </option>\r\n                            ))\r\n                          })()}\r\n                        </select>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Calculate month range for 2 years from selected start year */}\r\n                  {(() => {\r\n                    // Create months for 2 years from ganttStartYear\r\n                    const months: { year: number; month: number; label: string }[] = []\r\n                    const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']\r\n                    for (let year = ganttStartYear; year < ganttStartYear + 2; year++) {\r\n                      for (let m = 0; m < 12; m++) {\r\n                        months.push({ year, month: m, label: `${monthNames[m]} ${year}` })\r\n                      }\r\n                    }\r\n                    \r\n                    const today = new Date()\r\n                    const currentYear = today.getFullYear()\r\n                    const currentMonth = today.getMonth()\r\n                    const currentMonthIndex = months.findIndex(m => \r\n                      m.year === currentYear && m.month === currentMonth\r\n                    )\r\n\r\n                    return (\r\n                      <div className=\"space-y-4\">\r\n                        {/* Timeline Grid */}\r\n                        <div className=\"border rounded-lg overflow-hidden relative\">\r\n                          {/* Today Line Indicator */}\r\n                          {currentMonthIndex >= 0 && (\r\n                            <div \r\n                              className=\"absolute top-0 bottom-0 w-0.5 bg-red-500 z-10 pointer-events-none\"\r\n                              style={{ \r\n                                left: `calc((3 / (months.length + 3)) * 100% + ${(currentMonthIndex + 0.5) * (97 / (months.length + 3))}%)` \r\n                              }}\r\n                            >\r\n                              <div className=\"absolute -top-2 -left-3 w-6 h-4 bg-red-500 text-white text-xs rounded flex items-center justify-center font-bold\">\r\n                                Today\r\n                              </div>\r\n                            </div>\r\n                          )}\r\n                          \r\n                          {/* Month Header */}\r\n                          <div className=\"grid bg-gray-100\" style={{ gridTemplateColumns: '3fr repeat(24, 1fr)' }}>\r\n                            <div className=\"p-0.5 text-xs font-medium text-gray-700 border-r\">Project</div>\r\n                            {months.map((month, index) => (\r\n                              <div key={`${month.year}-${month.month}`} className=\"p-0 text-xs font-medium text-center text-gray-700 border-r last:border-r-0\">\r\n                                <div className=\"text-xs\">{month.label.split(' ')[0]}</div>\r\n                                <div className=\"text-xs font-bold\">{month.label.split(' ')[1]}</div>\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n\r\n                          {/* Ongoing Projects */}\r\n                          {(() => {\r\n                            const ongoingProjects = projects.filter(p => {\r\n                              const start = new Date(p.startYear || 2024, p.startMonth || 0, 1)\r\n                              const end = new Date(p.endYear || 2024, p.endMonth || 11, 1)\r\n                              return today >= start && today <= end\r\n                            })\r\n\r\n                            if (ongoingProjects.length > 0) {\r\n                              return (\r\n                                <>\r\n                                  <div className=\"p-0.5 bg-blue-50 text-xs font-medium text-blue-700 border-b\" style={{ gridColumn: '1 / -1' }}>\r\n                                    ðŸ”µ Ongoing ({ongoingProjects.length})\r\n                                  </div>\r\n                                  {ongoingProjects.map((project) => {\r\n                                    const projectStart = new Date(project.startYear || 2024, project.startMonth || 0, 1)\r\n                                    const projectEnd = new Date(project.endYear || 2024, project.endMonth || 11, 1)\r\n                                    const totalDays = Math.ceil((projectEnd.getTime() - projectStart.getTime()) / (1000 * 60 * 60 * 24))\r\n                                    const elapsedDays = Math.ceil((today.getTime() - projectStart.getTime()) / (1000 * 60 * 60 * 24))\r\n                                    const completionPercentage = Math.max(0, Math.min(100, Math.round((elapsedDays / totalDays) * 100)))\r\n\r\n                                    return (\r\n                                      <div key={project.id} className=\"grid border-b hover:bg-gray-50 relative\" style={{ gridTemplateColumns: '3fr repeat(24, 1fr)' }}>\r\n                                        <div className=\"p-0.5 border-r\">\r\n                                          <div className=\"flex items-center gap-1\">\r\n                                            <div \r\n                                              className=\"w-2 h-2 rounded flex-shrink-0\"\r\n                                              style={{ backgroundColor: project.color }}\r\n                                            />\r\n                                            <span className=\"text-xs font-medium truncate\">{project.name}</span>\r\n                                          </div>\r\n                                        </div>\r\n                                        {months.map((month, index) => {\r\n                                          const monthStart = new Date(month.year, month.month, 1)\r\n                                          const monthEnd = new Date(month.year, month.month + 1, 0)\r\n                                          \r\n                                          const overlapStart = projectStart < monthStart ? monthStart : projectStart\r\n                                          const overlapEnd = projectEnd > monthEnd ? monthEnd : projectEnd\r\n                                          const hasOverlap = overlapStart <= overlapEnd\r\n                                          \r\n                                          const monthDays = Math.ceil((monthEnd.getTime() - monthStart.getTime()) / (1000 * 60 * 60 * 24))\r\n                                          const overlapDays = hasOverlap ? Math.ceil((overlapEnd.getTime() - overlapStart.getTime()) / (1000 * 60 * 60 * 24)) : 0\r\n                                          const monthCoverage = hasOverlap ? (overlapDays / monthDays) * 100 : 0\r\n                                          \r\n                                          const isCurrentMonthInProject = month.year === currentYear && \r\n                                            month.month === currentMonth && \r\n                                            today >= projectStart && today <= projectEnd\r\n                                          \r\n                                          return (\r\n                                            <div key={`${month.year}-${month.month}`} className=\"border-r last:border-r-0 p-0\">\r\n                                              {hasOverlap ? (\r\n                                                <div className=\"relative h-3 bg-gray-200 rounded overflow-hidden\">\r\n                                                  <div \r\n                                                    className=\"h-full rounded transition-all duration-300\"\r\n                                                    style={{ \r\n                                                      width: `${monthCoverage}%`,\r\n                                                      backgroundColor: project.color,\r\n                                                      opacity: isCurrentMonthInProject ? 1 : 0.8\r\n                                                    }}\r\n                                                  >\r\n                                                  </div>\r\n                                                  {isCurrentMonthInProject && (\r\n                                                    <div className=\"absolute inset-0 border-2 border-blue-400 rounded pointer-events-none\"></div>\r\n                                                  )}\r\n                                                </div>\r\n                                              ) : (\r\n                                                <div className=\"h-3\"></div>\r\n                                              )}\r\n                                            </div>\r\n                                          )\r\n                                        })}\r\n                                      </div>\r\n                                    )\r\n                                  })}\r\n                                </>\r\n                              )\r\n                            }\r\n                            return null\r\n                          })()}\r\n\r\n                          {/* Completed Projects */}\r\n                          {(() => {\r\n                            const completedProjects = projects.filter(p => {\r\n                              const end = new Date(p.endYear || 2024, p.endMonth || 11, 1)\r\n                              return today > end\r\n                            })\r\n\r\n                            if (completedProjects.length > 0) {\r\n                              return (\r\n                                <>\r\n                                  <div className=\"p-0.5 bg-green-50 text-xs font-medium text-green-700 border-b\" style={{ gridColumn: '1 / -1' }}>\r\n                                    ðŸŸ¢ Completed ({completedProjects.length})\r\n                                  </div>\r\n                                  {completedProjects.map((project) => {\r\n                                    const projectStart = new Date(project.startYear || 2024, project.startMonth || 0, 1)\r\n                                    const projectEnd = new Date(project.endYear || 2024, project.endMonth || 11, 1)\r\n\r\n                                    return (\r\n                                      <div key={project.id} className=\"grid border-b hover:bg-gray-50\" style={{ gridTemplateColumns: '3fr repeat(24, 1fr)' }}>\r\n                                        <div className=\"p-0.5 border-r\">\r\n                                          <div className=\"flex items-center gap-1\">\r\n                                            <div \r\n                                              className=\"w-2 h-2 rounded flex-shrink-0\"\r\n                                              style={{ backgroundColor: project.color }}\r\n                                            />\r\n                                            <span className=\"text-xs font-medium truncate\">{project.name}</span>\r\n                                          </div>\r\n                                        </div>\r\n                                        {months.map((month) => {\r\n                                          const monthStart = new Date(month.year, month.month, 1)\r\n                                          const monthEnd = new Date(month.year, month.month + 1, 0)\r\n                                          \r\n                                          const overlapStart = projectStart < monthStart ? monthStart : projectStart\r\n                                          const overlapEnd = projectEnd > monthEnd ? monthEnd : projectEnd\r\n                                          const hasOverlap = overlapStart <= overlapEnd\r\n                                          \r\n                                          const monthDays = Math.ceil((monthEnd.getTime() - monthStart.getTime()) / (1000 * 60 * 60 * 24))\r\n                                          const overlapDays = hasOverlap ? Math.ceil((overlapEnd.getTime() - overlapStart.getTime()) / (1000 * 60 * 60 * 24)) : 0\r\n                                          const monthCoverage = hasOverlap ? (overlapDays / monthDays) * 100 : 0\r\n                                          \r\n                                          return (\r\n                                            <div key={`${month.year}-${month.month}`} className=\"border-r last:border-r-0 p-0\">\r\n                                              {hasOverlap ? (\r\n                                                <div className=\"relative h-3 bg-gray-200 rounded overflow-hidden\">\r\n                                                  <div \r\n                                                    className=\"h-full rounded transition-all duration-300\"\r\n                                                    style={{ \r\n                                                      width: `${monthCoverage}%`,\r\n                                                      backgroundColor: project.color,\r\n                                                      opacity: 0.7\r\n                                                    }}\r\n                                                  >\r\n                                                  </div>\r\n                                                </div>\r\n                                              ) : (\r\n                                                <div className=\"h-3\"></div>\r\n                                              )}\r\n                                            </div>\r\n                                          )\r\n                                        })}\r\n                                      </div>\r\n                                    )\r\n                                  })}\r\n                                </>\r\n                              )\r\n                            }\r\n                            return null\r\n                          })()}\r\n\r\n                          {/* Planned Projects */}\r\n                          {(() => {\r\n                            const plannedProjects = projects.filter(p => {\r\n                              const start = new Date(p.startYear || 2024, p.startMonth || 0, 1)\r\n                              return today < start\r\n                            })\r\n\r\n                            if (plannedProjects.length > 0) {\r\n                              return (\r\n                                <>\r\n                                  <div className=\"p-0.5 bg-yellow-50 text-xs font-medium text-yellow-700 border-b\" style={{ gridColumn: '1 / -1' }}>\r\n                                    ðŸŸ¡ Planned ({plannedProjects.length})\r\n                                  </div>\r\n                                  {plannedProjects.map((project) => {\r\n                                    const projectStart = new Date(project.startYear || 2024, project.startMonth || 0, 1)\r\n                                    const projectEnd = new Date(project.endYear || 2024, project.endMonth || 11, 1)\r\n                                    const daysUntilStart = Math.ceil((projectStart.getTime() - today.getTime()) / (1000 * 60 * 60 * 24))\r\n\r\n                                    return (\r\n                                      <div key={project.id} className=\"grid border-b hover:bg-gray-50\" style={{ gridTemplateColumns: '3fr repeat(24, 1fr)' }}>\r\n                                        <div className=\"p-0.5 border-r\">\r\n                                          <div className=\"flex items-center gap-1\">\r\n                                            <div \r\n                                              className=\"w-2 h-2 rounded flex-shrink-0\"\r\n                                              style={{ backgroundColor: project.color }}\r\n                                            />\r\n                                            <span className=\"text-xs font-medium truncate\">{project.name}</span>\r\n                                          </div>\r\n                                        </div>\r\n                                        {months.map((month) => {\r\n                                          const monthStart = new Date(month.year, month.month, 1)\r\n                                          const monthEnd = new Date(month.year, month.month + 1, 0)\r\n                                          \r\n                                          const overlapStart = projectStart < monthStart ? monthStart : projectStart\r\n                                          const overlapEnd = projectEnd > monthEnd ? monthEnd : projectEnd\r\n                                          const hasOverlap = overlapStart <= overlapEnd\r\n                                          \r\n                                          const monthDays = Math.ceil((monthEnd.getTime() - monthStart.getTime()) / (1000 * 60 * 60 * 24))\r\n                                          const overlapDays = hasOverlap ? Math.ceil((overlapEnd.getTime() - overlapStart.getTime()) / (1000 * 60 * 60 * 24)) : 0\r\n                                          const monthCoverage = hasOverlap ? (overlapDays / monthDays) * 100 : 0\r\n                                          \r\n                                          return (\r\n                                            <div key={`${month.year}-${month.month}`} className=\"border-r last:border-r-0 p-0\">\r\n                                              {hasOverlap ? (\r\n                                                <div className=\"relative h-3 bg-gray-200 rounded overflow-hidden\">\r\n                                                  <div \r\n                                                    className=\"h-full rounded transition-all duration-300\"\r\n                                                    style={{ \r\n                                                      width: `${monthCoverage}%`,\r\n                                                      backgroundColor: project.color,\r\n                                                      opacity: 0.6,\r\n                                                      borderStyle: 'dashed'\r\n                                                    }}\r\n                                                  >\r\n                                                  </div>\r\n                                                </div>\r\n                                              ) : (\r\n                                                <div className=\"h-3\"></div>\r\n                                              )}\r\n                                            </div>\r\n                                          )\r\n                                        })}\r\n                                      </div>\r\n                                    )\r\n                                  })}\r\n                                </>\r\n                              )\r\n                            }\r\n                            return null\r\n                          })()}\r\n                        </div>\r\n\r\n                        {/* Date Range Info */}\r\n                        <div className=\"bg-gray-50 p-3 rounded-lg\">\r\n                          <div className=\"text-sm font-medium text-gray-700 mb-2\">Timeline Range</div>\r\n                          <div className=\"text-xs text-gray-600\">\r\n                            Showing: {ganttStartYear} - {ganttStartYear + 1} (24 months)\r\n                          </div>\r\n                        </div>\r\n\r\n                        {/* Compact Summary */}\r\n                        <div className=\"bg-gray-50 p-3 rounded-lg\">\r\n                          <div className=\"text-sm font-medium text-gray-700 mb-2\">Summary</div>\r\n                          <div className=\"grid grid-cols-3 gap-3 text-xs\">\r\n                            <div className=\"text-center\">\r\n                              <div className=\"font-medium text-green-600\">\r\n                                {projects.filter(p => new Date() > new Date(p.endYear || 2024, p.endMonth || 11, 1)).length}\r\n                              </div>\r\n                              <div className=\"text-gray-500\">Completed</div>\r\n                            </div>\r\n                            <div className=\"text-center\">\r\n                              <div className=\"font-medium text-blue-600\">\r\n                                {projects.filter(p => {\r\n                                  const start = new Date(p.startYear || 2024, p.startMonth || 0, 1)\r\n                                  const end = new Date(p.endYear || 2024, p.endMonth || 11, 1)\r\n                                  return today >= start && today <= end\r\n                                }).length}\r\n                              </div>\r\n                              <div className=\"text-gray-500\">Ongoing</div>\r\n                            </div>\r\n                            <div className=\"text-center\">\r\n                              <div className=\"font-medium text-yellow-600\">\r\n                                {projects.filter(p => new Date() < new Date(p.startYear || 2024, p.startMonth || 0, 1)).length}\r\n                              </div>\r\n                              <div className=\"text-gray-500\">Planned</div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    )\r\n                  })()}\r\n                </>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n          </div>\r\n  )\r\n}\r\n","\"use client\"\r\nimport { useState } from \"react\"\r\n\r\ninterface AllocationCellProps {\r\n  userId: string\r\n  monthIndex: number\r\n  allocations?: any[]\r\n  onEdit?: (id: string) => void\r\n  onSaveEdit?: (id: string, percentage: number) => void\r\n  onRemove?: (id: string) => void\r\n  onEmptyCellClick?: () => void\r\n  project?: any\r\n  projects?: any[]\r\n  users?: any[]\r\n  month?: any\r\n  userEnded?: boolean\r\n  userNotStarted?: boolean\r\n  viewMode?: 'percentage' | 'days'\r\n  getDaysFromPercentage?: (userId: string, monthIndex: number, percentage: number) => number\r\n  readOnly?: boolean\r\n}\r\n\r\nexport function AllocationCell({\r\n  userId,\r\n  monthIndex,\r\n  allocations = [],\r\n  onEdit,\r\n  onSaveEdit,\r\n  onRemove,\r\n  onEmptyCellClick,\r\n  projects = [],\r\n  users = [],\r\n  userEnded = false,\r\n  userNotStarted = false,\r\n  viewMode = 'percentage',\r\n  getDaysFromPercentage,\r\n  readOnly = false,\r\n}: AllocationCellProps) {\r\n  const [isHovering, setIsHovering] = useState(false)\r\n  const [editingId, setEditingId] = useState<string | null>(null)\r\n  const [editValue, setEditValue] = useState(0)\r\n\r\n  // Helper to convert percentage to days based on user work pattern\r\n  const getDaysFromPercentageLocal = (userId: string, monthIndex: number, percentage: number): number => {\r\n    if (getDaysFromPercentage) {\r\n      return getDaysFromPercentage(userId, monthIndex, percentage)\r\n    }\r\n    // Fallback calculation if function not provided\r\n    const year = Math.floor(monthIndex / 12) + 2024\r\n    const month = monthIndex % 12\r\n    \r\n    // Default to mon-fri for now\r\n    const workPattern = 'mon-fri'\r\n    const startDay = workPattern === 'mon-fri' ? 1 : 0\r\n    \r\n    // Calculate working days in month\r\n    const date = new Date(year, month, 1)\r\n    const daysInMonth = new Date(year, month + 1, 0).getDate()\r\n    let workingDays = 0\r\n    \r\n    for (let day = 1; day <= daysInMonth; day++) {\r\n      date.setDate(day)\r\n      const dayOfWeek = date.getDay()\r\n      \r\n      if (startDay === 1) {\r\n        if (dayOfWeek >= 1 && dayOfWeek <= 5) workingDays++\r\n      } else {\r\n        if (dayOfWeek >= 0 && dayOfWeek <= 4) workingDays++\r\n      }\r\n    }\r\n    \r\n    return Math.round((percentage / 100) * workingDays)\r\n  }\r\n\r\n  // Calculate total allocated percentage for this cell\r\n  const totalAllocated = allocations.reduce((sum, a) => sum + (a.percentage || 0), 0)\r\n  const freePercentage = Math.max(0, 100 - totalAllocated)\r\n\r\n  // Determine border class based on allocation level\r\n  const allocationBorderClass =\r\n    totalAllocated === 100\r\n      ? \"border-2 border-green-500\"\r\n      : totalAllocated > 100\r\n      ? \"border-2 border-red-500\"\r\n      : \"\"\r\n\r\n  const handleClick = () => {\r\n    if (freePercentage > 0 && onEmptyCellClick && !userNotStarted) {\r\n      onEmptyCellClick()\r\n    }\r\n  }\r\n\r\n  return (\r\n    <td\r\n      data-user-id={userId}\r\n      data-month={monthIndex}\r\n      className={`w-32 border-r border-b border-border bg-background px-1 py-0.5 min-h-8 transition-colors relative ${\r\n        userEnded || userNotStarted || readOnly\r\n          ? \"cursor-not-allowed bg-gray-50\"\r\n          : freePercentage > 0 && onEmptyCellClick\r\n          ? \"cursor-pointer hover:bg-muted/50\"\r\n          : \"hover:bg-muted/30\"\r\n      }`}\r\n      onMouseEnter={() => !userEnded && !userNotStarted && !readOnly && freePercentage > 0 && setIsHovering(true)}\r\n      onMouseLeave={() => setIsHovering(false)}\r\n      onClick={userEnded || userNotStarted || readOnly ? undefined : handleClick}\r\n    >\r\n      <div className=\"flex flex-col h-full gap-0.5\">\r\n        {/* Allocation bars row */}\r\n        <div className=\"flex items-center flex-1\">\r\n          <div className={`flex w-full h-4 rounded overflow-hidden bg-gray-100 ${allocationBorderClass}`}>\r\n            {userEnded ? (\r\n              <div className=\"w-full h-full flex items-center justify-center text-[8px] font-semibold text-gray-500 bg-gray-200\">\r\n                ended\r\n              </div>\r\n            ) : userNotStarted ? (\r\n              <div className=\"w-full h-full flex items-center justify-center text-[8px] font-semibold text-gray-500 bg-gray-200\">\r\n                not started\r\n              </div>\r\n            ) : (\r\n              allocations.map((allocation) => {\r\n              const project = projects.find((p) => p.id === allocation.projectId)\r\n              console.log(\"[v0] AllocationCell rendering bar:\", {\r\n                allocationId: allocation.id,\r\n                projectId: allocation.projectId,\r\n                projectColor: project?.color,\r\n              })\r\n                // Keep total bar size constant: if allocations exceed 100%,\r\n                // normalize segments so they still fit into a 100% width bar.\r\n                const capacity = totalAllocated > 100 ? totalAllocated : 100\r\n                const width = Math.max(\r\n                  0,\r\n                  Math.min(100, ((allocation.percentage || 0) / capacity) * 100),\r\n                )\r\n\r\n                // Calculate display value based on view mode\r\n                const displayValue = viewMode === 'days' \r\n                  ? Math.round(getDaysFromPercentageLocal(userId, monthIndex, allocation.percentage || 0))\r\n                  : Math.round(allocation.percentage || 0)\r\n\r\n                const displayText = viewMode === 'days' \r\n                  ? `${displayValue} days`\r\n                  : `${displayValue}%`\r\n\r\n                // Calculate days for tooltip (always show days)\r\n                const daysValue = getDaysFromPercentageLocal(userId, monthIndex, allocation.percentage || 0)\r\n\r\n                return (\r\n                  <div\r\n                    key={allocation.id}\r\n                    className={`h-full text-[8px] flex items-center justify-center font-semibold relative ${\r\n                      readOnly ? \"\" : \"group cursor-pointer\"\r\n                    } text-white`}\r\n                    style={{\r\n                      backgroundColor: project?.color || \"#999\",\r\n                      width: `${width}%`,\r\n                      minWidth: width > 0 ? \"8%\" : undefined,\r\n                    }}\r\n                    onClick={(e) => {\r\n                      if (readOnly) return\r\n                      e.stopPropagation()\r\n                      onEdit?.(allocation.id)\r\n                    }}\r\n                    title={`${project?.name ?? \"Project\"} - ${allocation.positionName || allocation.name || \"Position\"} (${displayText})`}\r\n                  >\r\n                    {displayText}\r\n                    {!readOnly && (\r\n                      <button\r\n                        onClick={(e) => {\r\n                          e.stopPropagation()\r\n                          onRemove?.(allocation.id)\r\n                        }}\r\n                        className=\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity\"\r\n                      >\r\n                        Ã—\r\n                      </button>\r\n                    )}\r\n                  </div>\r\n                )\r\n              })\r\n            )}\r\n          </div>\r\n          {/* Green tick for 90-100% allocation */}\r\n          {!userEnded && !userNotStarted && totalAllocated >= 90 && totalAllocated <= 100 && allocations.length > 0 && (\r\n            <div className=\"ml-1 flex-shrink-0\">\r\n              <svg className=\"w-4 h-4 text-green-500\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\r\n              </svg>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        \r\n        {!userEnded && !userNotStarted && !readOnly && isHovering && freePercentage > 0 && (\r\n          <div className=\"absolute inset-0 flex items-center justify-center bg-primary/10 rounded text-[9px] text-primary font-medium pointer-events-none\">\r\n            Click to select position\r\n          </div>\r\n        )}\r\n      </div>\r\n    </td>\r\n  )\r\n}\r\n","\"use client\"\r\nimport { useState } from \"react\"\r\nimport type { Project, Position } from \"../lib/types\"\r\n\r\ninterface ProjectManagerProps {\r\n  projects: Project[]\r\n  positions: Position[]\r\n  months: string[]\r\n  startMonth?: number\r\n  startYear?: number\r\n  onAddProject: (project: Project) => void\r\n  onUpdateProject: (projectId: string, updates: Partial<Project>) => void\r\n  onDeleteProject: (projectId: string) => void\r\n  onUpdatePositions: (positions: Position[]) => void\r\n  onProjectSelect?: (projectId: string | null) => void\r\n  selectedProjectId?: string | null\r\n  onCleanupAllocations?: (projectId: string, validPositionIds: string[]) => void\r\n  currentUserRole?: 'admin' | 'editor' | 'viewer' | null\r\n}\r\n\r\ninterface PositionBudget {\r\n  id: string\r\n  name: string\r\n  projectTask?: string\r\n  budgets: Record<number, number>\r\n}\r\n\r\nexport function ProjectManager({\r\n  projects,\r\n  positions = [],\r\n  months,\r\n  startMonth = 0,\r\n  startYear = 2024,\r\n  onAddProject,\r\n  onUpdateProject,\r\n  onDeleteProject,\r\n  onUpdatePositions,\r\n  onProjectSelect,\r\n  selectedProjectId,\r\n  onCleanupAllocations,\r\n  currentUserRole,\r\n}: ProjectManagerProps) {\r\n  const [showCreateModal, setShowCreateModal] = useState(false)\r\n  const [editingProjectId, setEditingProjectId] = useState<string | null>(null)\r\n  const [newProjectName, setNewProjectName] = useState(\"\")\r\n  const [selectedColor, setSelectedColor] = useState(\"#3B82F6\")\r\n  const [positionBudgets, setPositionBudgets] = useState<PositionBudget[]>([])\r\n  const [projectStartMonth, setProjectStartMonth] = useState(0)\r\n  const [projectStartYear, setProjectStartYear] = useState(2024)\r\n  const [projectEndMonth, setProjectEndMonth] = useState(0)\r\n  const [projectEndYear, setProjectEndYear] = useState(2024)\r\n  const [monthTablePage, setMonthTablePage] = useState(0)\r\n  const [allocationMode, setAllocationMode] = useState<'percentage' | 'days'>('percentage')\r\n\r\n  // Check if current user can edit projects\r\n  const canEditProjects = currentUserRole === 'admin' || currentUserRole === 'editor'\r\n\r\n  const MONTHS = [\r\n    \"January\",\r\n    \"February\",\r\n    \"March\",\r\n    \"April\",\r\n    \"May\",\r\n    \"June\",\r\n    \"July\",\r\n    \"August\",\r\n    \"September\",\r\n    \"October\",\r\n    \"November\",\r\n    \"December\",\r\n  ]\r\n  const YEARS = Array.from({ length: 10 }, (_, i) => 2024 + i)\r\n\r\n  // Helper to calculate working days in a month\r\n  const getWorkingDaysInMonth = (year: number, month: number, startDay: number = 1): number => {\r\n    const date = new Date(year, month, 1)\r\n    const daysInMonth = new Date(year, month + 1, 0).getDate()\r\n    let workingDays = 0\r\n    \r\n    for (let day = 1; day <= daysInMonth; day++) {\r\n      date.setDate(day)\r\n      const dayOfWeek = date.getDay() // 0 = Sunday, 6 = Saturday\r\n      \r\n      if (startDay === 1) {\r\n        // Monday to Friday (1-5)\r\n        if (dayOfWeek >= 1 && dayOfWeek <= 5) {\r\n          workingDays++\r\n        }\r\n      } else {\r\n        // Sunday to Thursday (0-4)\r\n        if (dayOfWeek >= 0 && dayOfWeek <= 4) {\r\n          workingDays++\r\n        }\r\n      }\r\n    }\r\n    \r\n    return workingDays\r\n  }\r\n\r\n  const COLORS = [\r\n    \"#3B82F6\", // Blue\r\n    \"#10B981\", // Green\r\n    \"#F59E0B\", // Amber\r\n    \"#8B5CF6\", // Purple\r\n    \"#EC4899\", // Pink\r\n    \"#06B6D4\", // Cyan\r\n    \"#EF4444\", // Red\r\n    \"#14B8A6\", // Teal\r\n  ]\r\n\r\n  const toGlobalMonthIndex = (month: number, year: number) => {\r\n    return (year - 2024) * 12 + month\r\n  }\r\n\r\n  const fromGlobalMonthIndex = (globalIndex: number) => {\r\n    return {\r\n      month: globalIndex % 12,\r\n      year: 2024 + Math.floor(globalIndex / 12),\r\n    }\r\n  }\r\n\r\n  const projectDurationMonths = (() => {\r\n    const startIdx = toGlobalMonthIndex(projectStartMonth, projectStartYear)\r\n    const endIdx = toGlobalMonthIndex(projectEndMonth, projectEndYear)\r\n    return Math.max(1, endIdx - startIdx + 1)\r\n  })()\r\n\r\n  const getDisplayMonths = () => {\r\n    const startIdx = toGlobalMonthIndex(projectStartMonth, projectStartYear)\r\n    const endIdx = toGlobalMonthIndex(projectEndMonth, projectEndYear)\r\n    const pageStart = startIdx + monthTablePage * 12\r\n    const pageEnd = Math.min(pageStart + 12, endIdx + 1)\r\n\r\n    const displayMonths = []\r\n    for (let i = pageStart; i < pageEnd; i++) {\r\n      const { month, year } = fromGlobalMonthIndex(i)\r\n      displayMonths.push({\r\n        month,\r\n        year,\r\n        displayName: `${MONTHS[month].slice(0, 3)} ${year.toString().slice(-2)}`,\r\n        globalIndex: i,\r\n      })\r\n    }\r\n    return displayMonths\r\n  }\r\n\r\n  const displayMonths = getDisplayMonths()\r\n  const maxPages = Math.ceil(projectDurationMonths / 12)\r\n\r\n  const handleCreateProject = () => {\r\n    if (!newProjectName.trim()) return\r\n\r\n    console.log('[DEBUG] Creating project with dates:', {\r\n      projectStartMonth,\r\n      projectStartYear,\r\n      projectEndMonth,\r\n      projectEndYear\r\n    })\r\n\r\n    const newProject: Project = {\r\n      id: `proj-${Date.now()}`,\r\n      name: newProjectName,\r\n      color: selectedColor,\r\n      startMonth: projectStartMonth,\r\n      startYear: projectStartYear,\r\n      endMonth: projectEndMonth,\r\n      endYear: projectEndYear,\r\n      allocationMode,\r\n    }\r\n\r\n    console.log('[DEBUG] Project object being created:', newProject)\r\n\r\n    onAddProject(newProject)\r\n\r\n    const newPositions: Position[] = []\r\n    const startIdx = toGlobalMonthIndex(projectStartMonth, projectStartYear)\r\n    const endIdx = toGlobalMonthIndex(projectEndMonth, projectEndYear)\r\n\r\n    positionBudgets.forEach((positionBudget) => {\r\n      displayMonths.forEach((displayMonth, displayIdx) => {\r\n        const percentage = positionBudget.budgets[displayMonth.globalIndex] || 0\r\n        if (percentage > 0) {\r\n          const position: Position = {\r\n            id: `pos-${newProject.id}-${positionBudget.id}-${displayMonth.globalIndex}`,\r\n            projectId: newProject.id,\r\n            monthIndex: displayMonth.globalIndex,\r\n            percentage: allocationMode === 'days' ? (percentage / getWorkingDaysInMonth(displayMonth.year, displayMonth.month, 1)) * 100 : percentage,\r\n            allocated: 0,\r\n            name: positionBudget.name,\r\n            projectTask: positionBudget.projectTask,\r\n            days: allocationMode === 'days' ? percentage : undefined,\r\n          }\r\n          newPositions.push(position)\r\n        }\r\n      })\r\n    })\r\n\r\n    if (newPositions.length > 0) {\r\n      onUpdatePositions([...positions, ...newPositions])\r\n    }\r\n\r\n    setNewProjectName(\"\")\r\n    setSelectedColor(\"#3B82F6\")\r\n    setPositionBudgets([])\r\n    setProjectStartMonth(0)\r\n    setProjectStartYear(2024)\r\n    setProjectEndMonth(0)\r\n    setProjectEndYear(2024)\r\n    setMonthTablePage(0)\r\n    setAllocationMode('percentage')\r\n    setShowCreateModal(false)\r\n  }\r\n\r\n  const handleEditProject = (projectId: string) => {\r\n    setEditingProjectId(projectId)\r\n    const project = projects.find((p) => p.id === projectId)\r\n    if (project) {\r\n      setNewProjectName(project.name)\r\n      setSelectedColor(project.color)\r\n      setProjectStartMonth(project.startMonth ?? 0)\r\n      setProjectStartYear(project.startYear ?? 2024)\r\n      setProjectEndMonth(project.endMonth ?? 0)\r\n      setProjectEndYear(project.endYear ?? 2024)\r\n      setAllocationMode(project.allocationMode ?? 'percentage')\r\n      setMonthTablePage(0)\r\n\r\n      const projectPositions = positions.filter((p) => p.projectId === projectId)\r\n      const positionMap = new Map<string, PositionBudget>()\r\n\r\n      projectPositions.forEach((p) => {\r\n        const name = p.name || \"Unnamed Position\"\r\n        if (!positionMap.has(name)) {\r\n          positionMap.set(name, {\r\n            id: `${name}-${Date.now()}`,\r\n            name,\r\n            projectTask: p.projectTask,\r\n            budgets: {},\r\n          })\r\n        }\r\n        const pos = positionMap.get(name)!\r\n        // Use days if available, otherwise use percentage\r\n        const value = project.allocationMode === 'days' && p.days ? p.days : p.percentage\r\n        pos.budgets[p.monthIndex] = value\r\n      })\r\n\r\n      setPositionBudgets(Array.from(positionMap.values()))\r\n    }\r\n  }\r\n\r\n  const handleSaveEditProject = () => {\r\n    if (!editingProjectId || !newProjectName.trim()) return\r\n\r\n    const projectId = editingProjectId // Store before clearing state\r\n\r\n    console.log(\"[v0] Saving project with dates:\", {\r\n      projectId,\r\n      startMonth: projectStartMonth,\r\n      startYear: projectStartYear,\r\n      endMonth: projectEndMonth,\r\n      endYear: projectEndYear,\r\n    })\r\n\r\n    console.log(\"[v0] Saving project with color:\", {\r\n      projectId,\r\n      selectedColor,\r\n    })\r\n\r\n    console.log(\"[v0] About to call onUpdateProject with:\", {\r\n      projectId,\r\n      name: newProjectName,\r\n      color: selectedColor,\r\n      startMonth: projectStartMonth,\r\n      startYear: projectStartYear,\r\n      endMonth: projectEndMonth,\r\n      endYear: projectEndYear,\r\n    })\r\n\r\n    // Update positions BEFORE updating the project to avoid triggering another project update\r\n    const existingPositions = positions.filter((p) => p.projectId === projectId)\r\n    const newPositions: Position[] = []\r\n\r\n    positionBudgets.forEach((positionBudget) => {\r\n      displayMonths.forEach((displayMonth) => {\r\n        const value = positionBudget.budgets[displayMonth.globalIndex] || 0\r\n        if (value > 0) {\r\n          const existingPos = existingPositions.find(\r\n            (p) => p.monthIndex === displayMonth.globalIndex && p.name === positionBudget.name,\r\n          )\r\n          const project = projects.find((p) => p.id === projectId)\r\n          const mode = project?.allocationMode || 'percentage'\r\n          \r\n          const position: Position = {\r\n            id: existingPos?.id || `pos-${projectId}-${positionBudget.id}-${displayMonth.globalIndex}`,\r\n            projectId,\r\n            monthIndex: displayMonth.globalIndex,\r\n            percentage: mode === 'days' ? (value / getWorkingDaysInMonth(displayMonth.year, displayMonth.month, 1)) * 100 : value,\r\n            allocated: existingPos?.allocated || 0,\r\n            name: positionBudget.name,\r\n            projectTask: positionBudget.projectTask,\r\n            days: mode === 'days' ? value : undefined,\r\n          }\r\n          newPositions.push(position)\r\n        }\r\n      })\r\n    })\r\n\r\n    const otherPositions = positions.filter((p) => p.projectId !== projectId)\r\n    onUpdatePositions([...otherPositions, ...newPositions])\r\n\r\n    // Clean up allocations for removed positions\r\n    if (onCleanupAllocations) {\r\n      const validPositionIds = newPositions.map(p => p.id)\r\n      onCleanupAllocations(projectId, validPositionIds)\r\n    }\r\n\r\n    // Now update the project\r\n    onUpdateProject(projectId, {\r\n      name: newProjectName,\r\n      color: selectedColor,\r\n      startMonth: projectStartMonth,\r\n      startYear: projectStartYear,\r\n      endMonth: projectEndMonth,\r\n      endYear: projectEndYear,\r\n      allocationMode,\r\n    })\r\n\r\n    // Close the edit modal immediately so the project list re-renders with the new color\r\n    setEditingProjectId(null)\r\n\r\n    setNewProjectName(\"\")\r\n    setSelectedColor(\"#3B82F6\")\r\n    setPositionBudgets([])\r\n    setProjectStartMonth(0)\r\n    setProjectStartYear(2024)\r\n    setProjectEndMonth(0)\r\n    setProjectEndYear(2024)\r\n    setMonthTablePage(0)\r\n    setAllocationMode('percentage')\r\n  }\r\n\r\n  const handleAddPositionLine = () => {\r\n    setPositionBudgets([\r\n      ...positionBudgets,\r\n      {\r\n        id: `pos-${Date.now()}`,\r\n        name: \"New Position\",\r\n        budgets: {},\r\n      },\r\n    ])\r\n  }\r\n\r\n  const handleDeletePositionLine = (id: string) => {\r\n    setPositionBudgets(positionBudgets.filter((p) => p.id !== id))\r\n  }\r\n\r\n  const handleUpdatePositionName = (id: string, name: string) => {\r\n    setPositionBudgets(positionBudgets.map((p) => (p.id === id ? { ...p, name } : p)))\r\n  }\r\n\r\n  const handleUpdateProjectTask = (id: string, projectTask: string) => {\r\n    setPositionBudgets(positionBudgets.map((p) => (p.id === id ? { ...p, projectTask } : p)))\r\n  }\r\n\r\n  const handleUpdatePositionBudget = (id: string, globalMonthIndex: number, value: number) => {\r\n    setPositionBudgets(\r\n      positionBudgets.map((p) => (p.id === id ? { ...p, budgets: { ...p.budgets, [globalMonthIndex]: value } } : p)),\r\n    )\r\n  }\r\n\r\n  const exportPositionsToExcel = () => {\r\n    if (positionBudgets.length === 0) {\r\n      alert(\"No positions to export\")\r\n      return\r\n    }\r\n\r\n    let csvContent = \"\"\r\n    \r\n    // Create header row with project task, position name and all months\r\n    const headerRow = [\"Project Task\", \"Position Name\", ...displayMonths.map(m => m.displayName)]\r\n    csvContent += headerRow.join(\",\") + \"\\n\"\r\n    \r\n    // Add data rows for each position (only include positions with names)\r\n    positionBudgets\r\n      .filter(p => p.name.trim() !== \"\")\r\n      .forEach(position => {\r\n        const row = [position.projectTask || \"\", position.name]\r\n        displayMonths.forEach(month => {\r\n          const value = position.budgets[month.globalIndex] || 0\r\n          row.push(value.toString())\r\n        })\r\n        csvContent += row.join(\",\") + \"\\n\"\r\n      })\r\n    \r\n    // Create and download the file\r\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' })\r\n    const link = document.createElement('a')\r\n    const url = URL.createObjectURL(blob)\r\n    \r\n    const projectName = newProjectName || \"Project\"\r\n    const fileName = `${projectName}-positions-${allocationMode}-${new Date().toISOString().split('T')[0]}.csv`\r\n    link.setAttribute('href', url)\r\n    link.setAttribute('download', fileName)\r\n    link.style.visibility = 'hidden'\r\n    document.body.appendChild(link)\r\n    link.click()\r\n    document.body.removeChild(link)\r\n  }\r\n\r\n  const importPositionsFromExcel = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = event.target.files?.[0]\r\n    if (!file) return\r\n\r\n    const reader = new FileReader()\r\n    reader.onload = (e) => {\r\n      try {\r\n        const text = e.target?.result as string\r\n        const lines = text.split('\\n').filter(line => line.trim())\r\n        \r\n        if (lines.length < 2) {\r\n          alert(\"File must contain at least a header row and one data row\")\r\n          return\r\n        }\r\n\r\n        // Parse header row to get months\r\n        const headers = lines[0].split(',').map(h => h.trim())\r\n        const monthHeaders = headers.slice(2) // Remove \"Project Task\" and \"Position Name\"\r\n        \r\n        // Parse data rows\r\n        const importedPositions: PositionBudget[] = []\r\n        \r\n        for (let i = 1; i < lines.length; i++) {\r\n          const values = lines[i].split(',').map(v => v.trim())\r\n          if (values.length < 3 || !values[1]) continue // Skip empty rows\r\n          \r\n          const projectTask = values[0]\r\n          const positionName = values[1]\r\n          const budgets: Record<number, number> = {}\r\n          \r\n          // Map values to months\r\n          values.slice(2).forEach((value, index) => {\r\n            if (index < displayMonths.length) {\r\n              const numValue = parseFloat(value) || 0\r\n              budgets[displayMonths[index].globalIndex] = numValue\r\n            }\r\n          })\r\n          \r\n          importedPositions.push({\r\n            id: `imported-${positionName}-${Date.now()}-${i}`,\r\n            name: positionName,\r\n            projectTask,\r\n            budgets\r\n          })\r\n        }\r\n        \r\n        if (importedPositions.length > 0) {\r\n          if (positionBudgets.some(p => p.name.trim() !== \"\")) {\r\n            const confirmReplace = confirm(\r\n              `Import will replace existing positions with ${importedPositions.length} imported positions. Continue?`\r\n            )\r\n            if (!confirmReplace) return\r\n          }\r\n          \r\n          // Update the positionBudgets state for the table display\r\n          setPositionBudgets(importedPositions)\r\n          \r\n          alert(`Successfully imported ${importedPositions.length} positions`)\r\n        } else {\r\n          alert(\"No valid position data found in file\")\r\n        }\r\n      } catch (error) {\r\n        console.error('Import error:', error)\r\n        alert(\"Error importing file. Please check the file format and try again.\")\r\n      }\r\n    }\r\n    \r\n    reader.onerror = () => {\r\n      alert(\"Error reading file\")\r\n    }\r\n    \r\n    reader.readAsText(file)\r\n    \r\n    // Reset the file input\r\n    if (event.target) {\r\n      event.target.value = ''\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex flex-wrap gap-4 items-center\">\r\n        {projects.map((project) => {\r\n          // Determine if text should be white or black based on background color brightness\r\n          const getContrastColor = (hex: string) => {\r\n            const r = parseInt(hex.slice(1, 3), 16)\r\n            const g = parseInt(hex.slice(3, 5), 16)\r\n            const b = parseInt(hex.slice(5, 7), 16)\r\n            const brightness = (r * 299 + g * 587 + b * 114) / 1000\r\n            return brightness > 128 ? \"#000\" : \"#fff\"\r\n          }\r\n          const textColor = getContrastColor(project.color)\r\n          \r\n          return (\r\n            <div\r\n              key={project.id}\r\n              className={`flex items-center justify-between px-3 py-1.5 rounded border border-border cursor-pointer hover:opacity-80 transition-opacity w-32 h-8 ${\r\n                selectedProjectId === project.id ? 'ring-2 ring-offset-2 ring-blue-500' : ''\r\n              }`}\r\n              style={{ backgroundColor: project.color, color: textColor }}\r\n              onClick={() => {\r\n                if (onProjectSelect) {\r\n                  onProjectSelect(selectedProjectId === project.id ? null : project.id)\r\n                }\r\n              }}\r\n            >\r\n              <span className=\"text-xs font-medium truncate flex-1\">{project.name}</span>\r\n              {canEditProjects && (\r\n                <button\r\n                  onClick={(e) => {\r\n                    e.stopPropagation()\r\n                    handleEditProject(project.id)\r\n                  }}\r\n                  className=\"px-1.5 py-0.5 text-[10px] bg-white/20 rounded hover:bg-white/30 transition-colors flex-shrink-0\"\r\n                  style={{ color: textColor }}\r\n                >\r\n                  Edit\r\n                </button>\r\n              )}\r\n            </div>\r\n          )\r\n        })}\r\n        {canEditProjects && (\r\n          <button\r\n            onClick={() => setShowCreateModal(true)}\r\n            className=\"px-4 py-2 bg-primary text-primary-foreground rounded font-medium hover:bg-primary/90 transition-colors text-sm\"\r\n          >\r\n            + New Project\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      {(showCreateModal || editingProjectId) && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-card p-6 rounded-lg border border-border shadow-lg w-full h-full mx-4 overflow-y-auto\">\r\n            <h2 className=\"text-lg font-semibold text-foreground mb-4\">\r\n              {editingProjectId ? \"Edit Project\" : \"Create New Project\"}\r\n            </h2>\r\n\r\n            <div className=\"mb-6 grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div>\r\n                <label className=\"text-xs font-medium text-muted-foreground mb-2 block\">Project Name</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={newProjectName}\r\n                  onChange={(e) => setNewProjectName(e.target.value)}\r\n                  className=\"w-full px-3 py-2 border border-border rounded text-foreground bg-card\"\r\n                  placeholder=\"Enter project name\"\r\n                  disabled={!canEditProjects}\r\n                  autoFocus\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"text-xs font-medium text-muted-foreground mb-2 block\">Project Color</label>\r\n                <div className=\"flex gap-2 flex-wrap\">\r\n                  {COLORS.map((color) => (\r\n                    <button\r\n                      key={color}\r\n                      onClick={() => {\r\n                        console.log(\"[v0] Color picker clicked, setting color to:\", color)\r\n                        setSelectedColor(color)\r\n                      }}\r\n                      className={`w-8 h-8 rounded transition-all ${selectedColor === color ? \"ring-2 ring-offset-2 ring-primary\" : \"hover:opacity-80\"}`}\r\n                      style={{ backgroundColor: color }}\r\n                      title={color}\r\n                    />\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"mb-6\">\r\n              <label className=\"text-xs font-medium text-muted-foreground mb-2 block\">Allocation Mode</label>\r\n              <div className=\"flex gap-4\">\r\n                <label className=\"flex items-center gap-2 cursor-pointer\">\r\n                  <input\r\n                    type=\"radio\"\r\n                    name=\"allocationMode\"\r\n                    value=\"percentage\"\r\n                    checked={allocationMode === 'percentage'}\r\n                    onChange={(e) => setAllocationMode('percentage')}\r\n                    className=\"text-primary\"\r\n                    disabled={!canEditProjects}\r\n                  />\r\n                  <span className=\"text-sm\">% Allocation</span>\r\n                </label>\r\n                <label className=\"flex items-center gap-2 cursor-pointer\">\r\n                  <input\r\n                    type=\"radio\"\r\n                    name=\"allocationMode\"\r\n                    value=\"days\"\r\n                    checked={allocationMode === 'days'}\r\n                    onChange={(e) => setAllocationMode('days')}\r\n                    className=\"text-primary\"\r\n                    disabled={!canEditProjects}\r\n                  />\r\n                  <span className=\"text-sm\">Day Allocation</span>\r\n                </label>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"mb-6 grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n              <div>\r\n                <label className=\"text-xs font-medium text-muted-foreground mb-2 block\">Start Month</label>\r\n                <select\r\n                  value={projectStartMonth}\r\n                  onChange={(e) => setProjectStartMonth(Number(e.target.value))}\r\n                  className=\"border border-border rounded px-3 py-2 w-full text-sm bg-background text-foreground\"\r\n                  disabled={!canEditProjects}\r\n                >\r\n                  {MONTHS.map((month, idx) => (\r\n                    <option key={idx} value={idx}>\r\n                      {month}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"text-xs font-medium text-muted-foreground mb-2 block\">Start Year</label>\r\n                <select\r\n                  value={projectStartYear}\r\n                  onChange={(e) => setProjectStartYear(Number(e.target.value))}\r\n                  className=\"border border-border rounded px-3 py-2 w-full text-sm bg-background text-foreground\"\r\n                  disabled={!canEditProjects}\r\n                >\r\n                  {YEARS.map((year) => (\r\n                    <option key={year} value={year}>\r\n                      {year}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"text-xs font-medium text-muted-foreground mb-2 block\">End Month</label>\r\n                <select\r\n                  value={projectEndMonth}\r\n                  onChange={(e) => setProjectEndMonth(Number(e.target.value))}\r\n                  className=\"border border-border rounded px-3 py-2 w-full text-sm bg-background text-foreground\"\r\n                  disabled={!canEditProjects}\r\n                >\r\n                  {MONTHS.map((month, idx) => (\r\n                    <option key={idx} value={idx}>\r\n                      {month}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"text-xs font-medium text-muted-foreground mb-2 block\">End Year</label>\r\n                <select\r\n                  value={projectEndYear}\r\n                  onChange={(e) => setProjectEndYear(Number(e.target.value))}\r\n                  className=\"border border-border rounded px-3 py-2 w-full text-sm bg-background text-foreground\"\r\n                  disabled={!canEditProjects}\r\n                >\r\n                  {YEARS.map((year) => (\r\n                    <option key={year} value={year}>\r\n                      {year}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"mb-6\">\r\n              <div className=\"flex justify-between items-center mb-2\">\r\n                <label className=\"text-xs font-medium text-muted-foreground\">\r\n                  Positions by Month ({allocationMode === 'days' ? 'Days' : '%'}) - Page {monthTablePage + 1} of {maxPages}\r\n                </label>\r\n                <div className=\"flex gap-2 items-center\">\r\n                  <button\r\n                    onClick={() => setMonthTablePage(Math.max(0, monthTablePage - 1))}\r\n                    disabled={monthTablePage === 0}\r\n                    className=\"px-3 py-1 text-xs bg-primary text-primary-foreground rounded hover:bg-primary/90 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                  >\r\n                    â† Prev 12\r\n                  </button>\r\n                  <button\r\n                    onClick={() => setMonthTablePage(Math.min(maxPages - 1, monthTablePage + 1))}\r\n                    disabled={monthTablePage >= maxPages - 1}\r\n                    className=\"px-3 py-1 text-xs bg-primary text-primary-foreground rounded hover:bg-primary/90 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                  >\r\n                    Next 12 â†’\r\n                  </button>\r\n                  <button\r\n                    onClick={handleAddPositionLine}\r\n                    className=\"px-3 py-1 text-xs bg-primary text-primary-foreground rounded hover:bg-primary/90 transition-colors\"\r\n                    disabled={!canEditProjects}\r\n                  >\r\n                    + Add Position\r\n                  </button>\r\n                  <button\r\n                    onClick={exportPositionsToExcel}\r\n                    className=\"px-3 py-1 text-xs bg-green-600 text-white rounded hover:bg-green-700 transition-colors\"\r\n                    title=\"Export positions to Excel\"\r\n                  >\r\n                    ðŸ“¥ Export\r\n                  </button>\r\n                  <button\r\n                    onClick={() => document.getElementById('excel-import-input')?.click()}\r\n                    className=\"px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors\"\r\n                    title=\"Import positions from Excel\"\r\n                    disabled={!canEditProjects}\r\n                  >\r\n                    ðŸ“¤ Import\r\n                  </button>\r\n                  <input\r\n                    id=\"excel-import-input\"\r\n                    type=\"file\"\r\n                    accept=\".xlsx,.xls,.csv\"\r\n                    onChange={importPositionsFromExcel}\r\n                    style={{ display: 'none' }}\r\n                    disabled={!canEditProjects}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"border border-border rounded overflow-x-auto\">\r\n                <table className=\"w-full text-[10px]\">\r\n                  <thead className=\"bg-muted border-b border-border\">\r\n                    <tr>\r\n                      <th className=\"px-4 py-2 text-left font-semibold text-muted-foreground min-w-20\">\r\n                        Project Task\r\n                      </th>\r\n                      <th className=\"px-4 py-2 text-left font-semibold text-muted-foreground min-w-40\">\r\n                        Position Name\r\n                      </th>\r\n                      {displayMonths.map((displayMonth) => (\r\n                        <th\r\n                          key={displayMonth.globalIndex}\r\n                          className=\"px-4 py-2 text-center font-semibold text-muted-foreground min-w-20\"\r\n                        >\r\n                          {displayMonth.displayName}\r\n                        </th>\r\n                      ))}\r\n                      <th className=\"px-4 py-2 text-center font-semibold text-muted-foreground w-10\">Action</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {positionBudgets.length === 0 ? (\r\n                      <tr>\r\n                        <td colSpan={displayMonths.length + 3} className=\"px-4 py-8 text-center text-muted-foreground\">\r\n                          No positions yet. Click \"Add Position\" to create one.\r\n                        </td>\r\n                      </tr>\r\n                    ) : (\r\n                      positionBudgets.map((positionBudget) => (\r\n                        <tr key={positionBudget.id} className=\"border-t border-border hover:bg-muted/50\">\r\n                          <td className=\"px-4 py-2 border-r border-border\">\r\n                            <input\r\n                              type=\"text\"\r\n                              value={positionBudget.projectTask || \"\"}\r\n                              onChange={(e) => handleUpdateProjectTask(positionBudget.id, e.target.value)}\r\n                              className=\"w-full px-2 py-1 border border-border rounded text-foreground bg-card\"\r\n                              placeholder=\"e.g., 01.03.01\"\r\n                              disabled={!canEditProjects}\r\n                            />\r\n                          </td>\r\n                          <td className=\"px-4 py-2 border-r border-border\">\r\n                            <input\r\n                              type=\"text\"\r\n                              value={positionBudget.name}\r\n                              onChange={(e) => handleUpdatePositionName(positionBudget.id, e.target.value)}\r\n                              className=\"w-full px-2 py-1 border border-border rounded text-foreground bg-card\"\r\n                              placeholder=\"e.g., Senior Developer\"\r\n                              disabled={!canEditProjects}\r\n                            />\r\n                          </td>\r\n                          {displayMonths.map((displayMonth) => (\r\n                            <td\r\n                              key={displayMonth.globalIndex}\r\n                              className=\"px-4 py-2 border-r border-border last:border-r-0 bg-background\"\r\n                            >\r\n                              <input\r\n                                type=\"number\"\r\n                                min=\"0\"\r\n                                max={allocationMode === 'days' ? getWorkingDaysInMonth(displayMonth.year, displayMonth.month, 1) : 999}\r\n                                value={positionBudget.budgets[displayMonth.globalIndex] || \"\"}\r\n                                onChange={(e) =>\r\n                                  handleUpdatePositionBudget(\r\n                                    positionBudget.id,\r\n                                    displayMonth.globalIndex,\r\n                                    e.target.value ? Number(e.target.value) : 0,\r\n                                  )\r\n                                }\r\n                                className=\"w-full px-2 py-1 text-center border border-border rounded text-foreground bg-card\"\r\n                                placeholder={allocationMode === 'days' ? `0-${getWorkingDaysInMonth(displayMonth.year, displayMonth.month, 1)} days` : \"0%\"}\r\n                                disabled={!canEditProjects}\r\n                              />\r\n                            </td>\r\n                          ))}\r\n                          <td className=\"px-4 py-2 text-center\">\r\n                            <button\r\n                              onClick={() => handleDeletePositionLine(positionBudget.id)}\r\n                              className=\"px-2 py-1 text-xs bg-destructive text-destructive-foreground rounded hover:bg-destructive/90 transition-colors\"\r\n                              disabled={!canEditProjects}\r\n                            >\r\n                              âœ•\r\n                            </button>\r\n                          </td>\r\n                        </tr>\r\n                      ))\r\n                    )}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex gap-2 justify-end\">\r\n              <button\r\n                onClick={() => {\r\n                  setShowCreateModal(false)\r\n                  setEditingProjectId(null)\r\n                  setNewProjectName(\"\")\r\n                  setSelectedColor(\"#3B82F6\")\r\n                  setPositionBudgets([])\r\n                  setProjectStartMonth(0)\r\n                  setProjectStartYear(2024)\r\n                  setProjectEndMonth(0)\r\n                  setProjectEndYear(2024)\r\n                  setMonthTablePage(0)\r\n                  setAllocationMode('percentage')\r\n                }}\r\n                className=\"px-4 py-2 bg-muted text-muted-foreground rounded font-medium hover:bg-muted/80 transition-colors text-sm\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              {editingProjectId && (\r\n                <button\r\n                  onClick={() => {\r\n                    if (\r\n                      window.confirm(\"Are you sure you want to delete this project? All positions will be removed.\")\r\n                    ) {\r\n                      onDeleteProject(editingProjectId)\r\n                      setEditingProjectId(null)\r\n                      setNewProjectName(\"\")\r\n                      setSelectedColor(\"#3B82F6\")\r\n                      setPositionBudgets([])\r\n                      setProjectStartMonth(0)\r\n                      setProjectStartYear(2024)\r\n                      setProjectEndMonth(0)\r\n                      setProjectEndYear(2024)\r\n                      setMonthTablePage(0)\r\n                      setAllocationMode('percentage')\r\n                    }\r\n                  }}\r\n                  className=\"px-4 py-2 bg-destructive text-black rounded font-medium hover:bg-destructive/90 transition-colors text-sm\"\r\n                >\r\n                  Delete Project\r\n                </button>\r\n              )}\r\n              <button\r\n                onClick={editingProjectId ? handleSaveEditProject : handleCreateProject}\r\n                className=\"px-4 py-2 bg-primary text-primary-foreground rounded font-medium hover:bg-primary/90 transition-colors text-sm\"\r\n                disabled={!canEditProjects}\r\n              >\r\n                {editingProjectId ? \"Save Changes\" : \"Create Project\"}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n","\"use client\"\r\n\r\nimport React, { useState } from \"react\"\r\nimport { Button } from \"./ui/button\"\r\nimport { getSystemUsers, addSystemUser, updateSystemUser, deleteSystemUser, getCurrentUserData, setCurrentUserData, getCurrentUser, type SystemUser } from \"../lib/storage\"\r\nimport type { Entity } from \"../lib/types\"\r\n\r\ninterface UserManagementProps {\r\n  isOpen: boolean\r\n  onClose: () => void\r\n}\r\n\r\nexport function UserManagement({ isOpen, onClose }: UserManagementProps) {\r\n  const [users, setUsers] = useState<SystemUser[]>(getSystemUsers())\r\n  const [newUser, setNewUser] = useState({ \r\n    email: \"\", \r\n    name: \"\", \r\n    password: \"\",\r\n    role: \"editor\" as 'admin' | 'editor' | 'viewer' \r\n  })\r\n  const [isAdding, setIsAdding] = useState(false)\r\n  const [editingUser, setEditingUser] = useState<SystemUser | null>(null)\r\n  const [editForm, setEditForm] = useState({\r\n    email: \"\",\r\n    name: \"\",\r\n    password: \"\",\r\n    role: \"editor\" as 'admin' | 'editor' | 'viewer'\r\n  })\r\n\r\n  // Entity management state\r\n  const [entities, setEntities] = useState<Entity[]>(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const userData = getCurrentUserData()\r\n      return userData.entities || []\r\n    }\r\n    return []\r\n  })\r\n  const [newEntityName, setNewEntityName] = useState(\"\")\r\n  const [newEntityCurrencyCode, setNewEntityCurrencyCode] = useState(\"\")\r\n  const [newEntityTaxAccount, setNewEntityTaxAccount] = useState(\"\")\r\n  const [newEntitySSAccount, setNewEntitySSAccount] = useState(\"\")\r\n  const [showEntitySection, setShowEntitySection] = useState(false)\r\n\r\n  // Backup management state\r\n  const [showBackupSection, setShowBackupSection] = useState(false)\r\n\r\n  // Save entities to localStorage whenever they change\r\n  React.useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      setCurrentUserData({ entities })\r\n    }\r\n  }, [entities])\r\n\r\n  const refreshUsers = () => {\r\n    const allUsers = getSystemUsers()\r\n    console.log(\"All users in system:\", allUsers)\r\n    setUsers(allUsers)\r\n  }\r\n\r\n  const handleAddUser = () => {\r\n    if (!newUser.email || !newUser.name || !newUser.password) return\r\n    \r\n    console.log(\"Adding user:\", newUser)\r\n    const addedUser = addSystemUser({\r\n      email: newUser.email,\r\n      name: newUser.name,\r\n      password: newUser.password,\r\n      role: newUser.role,\r\n      isActive: true,\r\n    })\r\n    console.log(\"User added successfully:\", addedUser)\r\n    \r\n    setNewUser({ email: \"\", name: \"\", password: \"\", role: \"editor\" })\r\n    setIsAdding(false)\r\n    refreshUsers()\r\n  }\r\n\r\n  const handleEditUser = (user: SystemUser) => {\r\n    setEditingUser(user)\r\n    setEditForm({\r\n      email: user.email,\r\n      name: user.name,\r\n      password: user.password,\r\n      role: user.role\r\n    })\r\n  }\r\n\r\n  const handleSaveEdit = () => {\r\n    if (!editingUser || !editForm.email || !editForm.name) return\r\n    \r\n    updateSystemUser(editingUser.id, {\r\n      email: editForm.email,\r\n      name: editForm.name,\r\n      password: editForm.password || editingUser.password,\r\n      role: editForm.role\r\n    })\r\n    \r\n    setEditingUser(null)\r\n    setEditForm({ email: \"\", name: \"\", password: \"\", role: \"editor\" })\r\n    refreshUsers()\r\n  }\r\n\r\n  const handleCancelEdit = () => {\r\n    setEditingUser(null)\r\n    setEditForm({ email: \"\", name: \"\", password: \"\", role: \"editor\" })\r\n  }\r\n\r\n  const handleToggleActive = (userId: string, isActive: boolean) => {\r\n    updateSystemUser(userId, { isActive })\r\n    refreshUsers()\r\n  }\r\n\r\n  const handleDeleteUser = (userId: string) => {\r\n    if (confirm(\"Are you sure you want to delete this user?\")) {\r\n      deleteSystemUser(userId)\r\n      refreshUsers()\r\n    }\r\n  }\r\n\r\n  // Entity management functions\r\n  const handleAddEntity = () => {\r\n    if (!newEntityName.trim() || !newEntityCurrencyCode.trim()) return\r\n    \r\n    const newEntity: Entity = {\r\n      id: `entity-${Date.now()}`,\r\n      name: newEntityName.trim(),\r\n      currencyCode: newEntityCurrencyCode.trim(),\r\n      taxAccount: newEntityTaxAccount.trim(),\r\n      ssAccount: newEntitySSAccount.trim()\r\n    }\r\n    \r\n    setEntities(prev => [...prev, newEntity])\r\n    setNewEntityName(\"\")\r\n    setNewEntityCurrencyCode(\"\")\r\n    setNewEntityTaxAccount(\"\")\r\n    setNewEntitySSAccount(\"\")\r\n  }\r\n\r\n  const handleDeleteEntity = (entityId: string) => {\r\n    if (confirm(\"Are you sure you want to delete this entity?\")) {\r\n      setEntities(prev => prev.filter(e => e.id !== entityId))\r\n    }\r\n  }\r\n\r\n  // Backup management functions\r\n  const handleCreateBackup = () => {\r\n    if (typeof window === 'undefined') return\r\n    \r\n    // Get all current user data\r\n    const currentUser = getCurrentUser()\r\n    if (!currentUser) return\r\n    \r\n    const userData = getCurrentUserData()\r\n    \r\n    // Create backup object with timestamp\r\n    const backup = {\r\n      timestamp: new Date().toISOString(),\r\n      version: \"1.0\",\r\n      data: {\r\n        projects: userData.projects || [],\r\n        users: userData.users || [],\r\n        allocations: userData.allocations || [],\r\n        positions: userData.positions || [],\r\n        entities: userData.entities || [],\r\n        startMonth: userData.startMonth,\r\n        startYear: userData.startYear,\r\n        systemUsers: userData.systemUsers || []\r\n      }\r\n    }\r\n    \r\n    // Convert to JSON and create downloadable file\r\n    const backupJson = JSON.stringify(backup, null, 2)\r\n    const blob = new Blob([backupJson], { type: 'application/json' })\r\n    const url = URL.createObjectURL(blob)\r\n    \r\n    // Create download link\r\n    const link = document.createElement('a')\r\n    link.href = url\r\n    link.download = `sola-backup-${new Date().toISOString().split('T')[0]}.json`\r\n    document.body.appendChild(link)\r\n    link.click()\r\n    document.body.removeChild(link)\r\n    URL.revokeObjectURL(url)\r\n    \r\n    alert('Backup created successfully!')\r\n  }\r\n\r\n  const handleImportBackup = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = event.target.files?.[0]\r\n    if (!file) return\r\n    \r\n    const reader = new FileReader()\r\n    reader.onload = (e) => {\r\n      try {\r\n        const backupText = e.target?.result as string\r\n        const backup = JSON.parse(backupText)\r\n        \r\n        // Validate backup structure\r\n        if (!backup.data || typeof backup.data !== 'object') {\r\n          throw new Error('Invalid backup file structure')\r\n        }\r\n        \r\n        if (confirm('This will overwrite all current data. Are you sure you want to continue?')) {\r\n          // Import all data\r\n          const dataToImport = backup.data\r\n          \r\n          // Update user data\r\n          setCurrentUserData({\r\n            projects: dataToImport.projects || [],\r\n            users: dataToImport.users || [],\r\n            allocations: dataToImport.allocations || [],\r\n            positions: dataToImport.positions || [],\r\n            entities: dataToImport.entities || [],\r\n            startMonth: dataToImport.startMonth,\r\n            startYear: dataToImport.startYear,\r\n            systemUsers: dataToImport.systemUsers || []\r\n          })\r\n          \r\n          // Update local state\r\n          setEntities(dataToImport.entities || [])\r\n          refreshUsers()\r\n          \r\n          alert('Backup imported successfully! Please refresh the page to see all changes.')\r\n        }\r\n      } catch (error) {\r\n        alert('Error importing backup: ' + (error as Error).message)\r\n      }\r\n    }\r\n    \r\n    reader.readAsText(file)\r\n    // Reset file input\r\n    event.target.value = ''\r\n  }\r\n\r\n  if (!isOpen) return null\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto\">\r\n        <div className=\"flex justify-between items-center mb-4\">\r\n          <h3 className=\"text-lg font-semibold\">Settings</h3>\r\n          <Button onClick={onClose} variant=\"outline\" size=\"sm\">\r\n            Ã—\r\n          </Button>\r\n        </div>\r\n\r\n        <div className=\"space-y-4\">\r\n          {/* Edit User Form */}\r\n          {editingUser && (\r\n            <div className=\"p-4 border rounded-lg bg-blue-50 space-y-3\">\r\n              <h4 className=\"font-medium text-sm\">Edit User: {editingUser.name}</h4>\r\n              <input\r\n                type=\"email\"\r\n                placeholder=\"Email\"\r\n                value={editForm.email}\r\n                onChange={(e) => setEditForm({ ...editForm, email: e.target.value })}\r\n                className=\"w-full px-3 py-2 border rounded text-sm\"\r\n              />\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Name\"\r\n                value={editForm.name}\r\n                onChange={(e) => setEditForm({ ...editForm, name: e.target.value })}\r\n                className=\"w-full px-3 py-2 border rounded text-sm\"\r\n              />\r\n              <input\r\n                type=\"password\"\r\n                placeholder=\"Password (leave empty to keep current)\"\r\n                value={editForm.password}\r\n                onChange={(e) => setEditForm({ ...editForm, password: e.target.value })}\r\n                className=\"w-full px-3 py-2 border rounded text-sm\"\r\n              />\r\n              <select\r\n                value={editForm.role}\r\n                onChange={(e) => setEditForm({ ...editForm, role: e.target.value as 'admin' | 'editor' | 'viewer' })}\r\n                className=\"w-full px-3 py-2 border rounded text-sm\"\r\n              >\r\n                <option value=\"admin\">Admin</option>\r\n                <option value=\"editor\">Editor</option>\r\n                <option value=\"viewer\">Viewer</option>\r\n              </select>\r\n              <div className=\"flex gap-2\">\r\n                <Button onClick={handleSaveEdit} size=\"sm\">Save Changes</Button>\r\n                <Button onClick={handleCancelEdit} variant=\"outline\" size=\"sm\">Cancel</Button>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Add User Form */}\r\n          {isAdding && (\r\n            <div className=\"p-4 border rounded-lg bg-gray-50 space-y-3\">\r\n              <input\r\n                type=\"email\"\r\n                placeholder=\"Email\"\r\n                value={newUser.email}\r\n                onChange={(e) => setNewUser({ ...newUser, email: e.target.value })}\r\n                className=\"w-full px-3 py-2 border rounded text-sm\"\r\n              />\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Name\"\r\n                value={newUser.name}\r\n                onChange={(e) => setNewUser({ ...newUser, name: e.target.value })}\r\n                className=\"w-full px-3 py-2 border rounded text-sm\"\r\n              />\r\n              <input\r\n                type=\"password\"\r\n                placeholder=\"Password\"\r\n                value={newUser.password}\r\n                onChange={(e) => setNewUser({ ...newUser, password: e.target.value })}\r\n                className=\"w-full px-3 py-2 border rounded text-sm\"\r\n              />\r\n              <select\r\n                value={newUser.role}\r\n                onChange={(e) => setNewUser({ ...newUser, role: e.target.value as 'admin' | 'editor' | 'viewer' })}\r\n                className=\"w-full px-3 py-2 border rounded text-sm\"\r\n              >\r\n                <option value=\"admin\">Admin</option>\r\n                <option value=\"editor\">Editor</option>\r\n                <option value=\"viewer\">Viewer</option>\r\n              </select>\r\n              <div className=\"flex gap-2\">\r\n                <Button onClick={handleAddUser} size=\"sm\">Add User</Button>\r\n                <Button onClick={() => setIsAdding(false)} variant=\"outline\" size=\"sm\">Cancel</Button>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Add User Button */}\r\n          {!isAdding && (\r\n            <Button onClick={() => setIsAdding(true)} variant=\"outline\" size=\"sm\">\r\n              + Add New User\r\n            </Button>\r\n          )}\r\n\r\n          {/* Users List */}\r\n          <div className=\"space-y-2\">\r\n            {users.map((user) => (\r\n              <div key={user.id} className=\"flex items-center justify-between p-3 border rounded\">\r\n                <div className=\"flex-1\">\r\n                  <div className=\"font-medium text-sm\">{user.name}</div>\r\n                  <div className=\"text-xs text-gray-500\">{user.email}</div>\r\n                  <div className=\"text-xs\">\r\n                    <span className={`px-2 py-1 rounded text-xs ${\r\n                      user.role === 'admin' ? 'bg-red-100 text-red-700' :\r\n                      user.role === 'editor' ? 'bg-blue-100 text-blue-700' :\r\n                      'bg-gray-100 text-gray-700'\r\n                    }`}>\r\n                      {user.role}\r\n                    </span>\r\n                    <span className={`ml-2 px-2 py-1 rounded text-xs ${\r\n                      user.isActive ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'\r\n                    }`}>\r\n                      {user.isActive ? 'Active' : 'Inactive'}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n                <div className=\"flex gap-2\">\r\n                  <Button\r\n                    onClick={() => handleEditUser(user)}\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                  >\r\n                    Edit\r\n                  </Button>\r\n                  <Button\r\n                    onClick={() => handleToggleActive(user.id, !user.isActive)}\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                  >\r\n                    {user.isActive ? 'Deactivate' : 'Activate'}\r\n                  </Button>\r\n                  {user.email !== 'admin@sola.com' && (\r\n                    <Button\r\n                      onClick={() => handleDeleteUser(user.id)}\r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      className=\"text-red-600 hover:text-red-700\"\r\n                    >\r\n                      Delete\r\n                    </Button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Entity Management Section */}\r\n        <div className=\"border-t pt-4\">\r\n          <div className=\"flex items-center justify-between mb-3\">\r\n            <h4 className=\"text-sm font-semibold text-gray-700\">Entity Management</h4>\r\n            <Button\r\n              onClick={() => setShowEntitySection(!showEntitySection)}\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n            >\r\n              {showEntitySection ? 'Hide' : 'Show'}\r\n            </Button>\r\n          </div>\r\n          \r\n          {showEntitySection && (\r\n            <div className=\"space-y-3\">\r\n              {/* Add New Entity Form */}\r\n              <div className=\"border rounded-lg p-3 bg-gray-50\">\r\n                <h5 className=\"text-sm font-medium mb-2\">Add New Entity</h5>\r\n                <div className=\"grid grid-cols-2 gap-2\">\r\n                  <input\r\n                    type=\"text\"\r\n                    placeholder=\"Entity Name\"\r\n                    value={newEntityName}\r\n                    onChange={(e) => setNewEntityName(e.target.value)}\r\n                    className=\"px-2 py-1 border rounded text-sm\"\r\n                  />\r\n                  <input\r\n                    type=\"text\"\r\n                    placeholder=\"Currency Code\"\r\n                    value={newEntityCurrencyCode}\r\n                    onChange={(e) => setNewEntityCurrencyCode(e.target.value)}\r\n                    className=\"px-2 py-1 border rounded text-sm\"\r\n                  />\r\n                  <input\r\n                    type=\"text\"\r\n                    placeholder=\"Tax Account\"\r\n                    value={newEntityTaxAccount}\r\n                    onChange={(e) => setNewEntityTaxAccount(e.target.value)}\r\n                    className=\"px-2 py-1 border rounded text-sm\"\r\n                  />\r\n                  <input\r\n                    type=\"text\"\r\n                    placeholder=\"SS Account\"\r\n                    value={newEntitySSAccount}\r\n                    onChange={(e) => setNewEntitySSAccount(e.target.value)}\r\n                    className=\"px-2 py-1 border rounded text-sm\"\r\n                  />\r\n                </div>\r\n                <Button onClick={handleAddEntity} size=\"sm\" className=\"mt-2\">\r\n                  Add Entity\r\n                </Button>\r\n              </div>\r\n\r\n              {/* Existing Entities List */}\r\n              {entities.length > 0 && (\r\n                <div className=\"border rounded-lg p-3\">\r\n                  <h5 className=\"text-sm font-medium mb-2\">Existing Entities</h5>\r\n                  <div className=\"space-y-2\">\r\n                    {entities.map(entity => (\r\n                      <div key={entity.id} className=\"flex items-center justify-between p-2 border rounded text-xs bg-gray-50\">\r\n                        <div>\r\n                          <div className=\"font-medium\">{entity.name}</div>\r\n                          <div className=\"text-gray-600\">\r\n                            Currency: {entity.currencyCode} | Tax: {entity.taxAccount} | SS: {entity.ssAccount}\r\n                          </div>\r\n                        </div>\r\n                        <Button\r\n                          onClick={() => handleDeleteEntity(entity.id)}\r\n                          variant=\"destructive\"\r\n                          size=\"sm\"\r\n                        >\r\n                          Delete\r\n                        </Button>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Backup Management Section */}\r\n        <div className=\"border-t pt-4\">\r\n          <div className=\"flex items-center justify-between mb-3\">\r\n            <h4 className=\"text-sm font-semibold text-gray-700\">Backup Management</h4>\r\n            <Button\r\n              onClick={() => setShowBackupSection(!showBackupSection)}\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n            >\r\n              {showBackupSection ? 'Hide' : 'Show'}\r\n            </Button>\r\n          </div>\r\n          \r\n          {showBackupSection && (\r\n            <div className=\"space-y-3\">\r\n              <div className=\"border rounded-lg p-3 bg-gray-50\">\r\n                <h5 className=\"text-sm font-medium mb-2\">Data Backup & Restore</h5>\r\n                <p className=\"text-xs text-gray-600 mb-3\">\r\n                  Create backups of all your data (projects, users, entities, allocations) and restore them when needed.\r\n                </p>\r\n                \r\n                <div className=\"space-y-3\">\r\n                  {/* Create Backup */}\r\n                  <div className=\"flex items-center justify-between p-2 border rounded bg-white\">\r\n                    <div>\r\n                      <div className=\"text-sm font-medium\">Create Backup</div>\r\n                      <div className=\"text-xs text-gray-600\">Download all data as JSON file</div>\r\n                    </div>\r\n                    <Button onClick={handleCreateBackup} size=\"sm\">\r\n                      Create Backup\r\n                    </Button>\r\n                  </div>\r\n                  \r\n                  {/* Import Backup */}\r\n                  <div className=\"flex items-center justify-between p-2 border rounded bg-white\">\r\n                    <div>\r\n                      <div className=\"text-sm font-medium\">Import Backup</div>\r\n                      <div className=\"text-xs text-gray-600\">Restore data from backup file</div>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <input\r\n                        type=\"file\"\r\n                        accept=\".json\"\r\n                        onChange={handleImportBackup}\r\n                        className=\"text-xs file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"mt-3 p-2 bg-yellow-50 border border-yellow-200 rounded\">\r\n                  <p className=\"text-xs text-yellow-800\">\r\n                    <strong>Warning:</strong> Importing a backup will overwrite all current data. \r\n                    Make sure to create a backup before importing.\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}