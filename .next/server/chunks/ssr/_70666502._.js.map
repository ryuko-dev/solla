{"version":3,"sources":["../../../../node_modules/.pnpm/styled-jsx%405.1.6_react%4019.2.0/node_modules/styled-jsx/dist/index/index.js","../../../../node_modules/.pnpm/styled-jsx%405.1.6_react%4019.2.0/node_modules/styled-jsx/style.js","../../../../app/expense-allocation/page.tsx"],"sourcesContent":["require('client-only');\nvar React = require('react');\n\nfunction _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }\n\nvar React__default = /*#__PURE__*/_interopDefaultLegacy(React);\n\n/*\nBased on Glamor's sheet\nhttps://github.com/threepointone/glamor/blob/667b480d31b3721a905021b26e1290ce92ca2879/src/sheet.js\n*/ function _defineProperties(target, props) {\n    for(var i = 0; i < props.length; i++){\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n        if (\"value\" in descriptor) descriptor.writable = true;\n        Object.defineProperty(target, descriptor.key, descriptor);\n    }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n}\nvar isProd = typeof process !== \"undefined\" && process.env && process.env.NODE_ENV === \"production\";\nvar isString = function(o) {\n    return Object.prototype.toString.call(o) === \"[object String]\";\n};\nvar StyleSheet = /*#__PURE__*/ function() {\n    function StyleSheet(param) {\n        var ref = param === void 0 ? {} : param, _name = ref.name, name = _name === void 0 ? \"stylesheet\" : _name, _optimizeForSpeed = ref.optimizeForSpeed, optimizeForSpeed = _optimizeForSpeed === void 0 ? isProd : _optimizeForSpeed;\n        invariant$1(isString(name), \"`name` must be a string\");\n        this._name = name;\n        this._deletedRulePlaceholder = \"#\" + name + \"-deleted-rule____{}\";\n        invariant$1(typeof optimizeForSpeed === \"boolean\", \"`optimizeForSpeed` must be a boolean\");\n        this._optimizeForSpeed = optimizeForSpeed;\n        this._serverSheet = undefined;\n        this._tags = [];\n        this._injected = false;\n        this._rulesCount = 0;\n        var node = typeof window !== \"undefined\" && document.querySelector('meta[property=\"csp-nonce\"]');\n        this._nonce = node ? node.getAttribute(\"content\") : null;\n    }\n    var _proto = StyleSheet.prototype;\n    _proto.setOptimizeForSpeed = function setOptimizeForSpeed(bool) {\n        invariant$1(typeof bool === \"boolean\", \"`setOptimizeForSpeed` accepts a boolean\");\n        invariant$1(this._rulesCount === 0, \"optimizeForSpeed cannot be when rules have already been inserted\");\n        this.flush();\n        this._optimizeForSpeed = bool;\n        this.inject();\n    };\n    _proto.isOptimizeForSpeed = function isOptimizeForSpeed() {\n        return this._optimizeForSpeed;\n    };\n    _proto.inject = function inject() {\n        var _this = this;\n        invariant$1(!this._injected, \"sheet already injected\");\n        this._injected = true;\n        if (typeof window !== \"undefined\" && this._optimizeForSpeed) {\n            this._tags[0] = this.makeStyleTag(this._name);\n            this._optimizeForSpeed = \"insertRule\" in this.getSheet();\n            if (!this._optimizeForSpeed) {\n                if (!isProd) {\n                    console.warn(\"StyleSheet: optimizeForSpeed mode not supported falling back to standard mode.\");\n                }\n                this.flush();\n                this._injected = true;\n            }\n            return;\n        }\n        this._serverSheet = {\n            cssRules: [],\n            insertRule: function(rule, index) {\n                if (typeof index === \"number\") {\n                    _this._serverSheet.cssRules[index] = {\n                        cssText: rule\n                    };\n                } else {\n                    _this._serverSheet.cssRules.push({\n                        cssText: rule\n                    });\n                }\n                return index;\n            },\n            deleteRule: function(index) {\n                _this._serverSheet.cssRules[index] = null;\n            }\n        };\n    };\n    _proto.getSheetForTag = function getSheetForTag(tag) {\n        if (tag.sheet) {\n            return tag.sheet;\n        }\n        // this weirdness brought to you by firefox\n        for(var i = 0; i < document.styleSheets.length; i++){\n            if (document.styleSheets[i].ownerNode === tag) {\n                return document.styleSheets[i];\n            }\n        }\n    };\n    _proto.getSheet = function getSheet() {\n        return this.getSheetForTag(this._tags[this._tags.length - 1]);\n    };\n    _proto.insertRule = function insertRule(rule, index) {\n        invariant$1(isString(rule), \"`insertRule` accepts only strings\");\n        if (typeof window === \"undefined\") {\n            if (typeof index !== \"number\") {\n                index = this._serverSheet.cssRules.length;\n            }\n            this._serverSheet.insertRule(rule, index);\n            return this._rulesCount++;\n        }\n        if (this._optimizeForSpeed) {\n            var sheet = this.getSheet();\n            if (typeof index !== \"number\") {\n                index = sheet.cssRules.length;\n            }\n            // this weirdness for perf, and chrome's weird bug\n            // https://stackoverflow.com/questions/20007992/chrome-suddenly-stopped-accepting-insertrule\n            try {\n                sheet.insertRule(rule, index);\n            } catch (error) {\n                if (!isProd) {\n                    console.warn(\"StyleSheet: illegal rule: \\n\\n\" + rule + \"\\n\\nSee https://stackoverflow.com/q/20007992 for more info\");\n                }\n                return -1;\n            }\n        } else {\n            var insertionPoint = this._tags[index];\n            this._tags.push(this.makeStyleTag(this._name, rule, insertionPoint));\n        }\n        return this._rulesCount++;\n    };\n    _proto.replaceRule = function replaceRule(index, rule) {\n        if (this._optimizeForSpeed || typeof window === \"undefined\") {\n            var sheet = typeof window !== \"undefined\" ? this.getSheet() : this._serverSheet;\n            if (!rule.trim()) {\n                rule = this._deletedRulePlaceholder;\n            }\n            if (!sheet.cssRules[index]) {\n                // @TBD Should we throw an error?\n                return index;\n            }\n            sheet.deleteRule(index);\n            try {\n                sheet.insertRule(rule, index);\n            } catch (error) {\n                if (!isProd) {\n                    console.warn(\"StyleSheet: illegal rule: \\n\\n\" + rule + \"\\n\\nSee https://stackoverflow.com/q/20007992 for more info\");\n                }\n                // In order to preserve the indices we insert a deleteRulePlaceholder\n                sheet.insertRule(this._deletedRulePlaceholder, index);\n            }\n        } else {\n            var tag = this._tags[index];\n            invariant$1(tag, \"old rule at index `\" + index + \"` not found\");\n            tag.textContent = rule;\n        }\n        return index;\n    };\n    _proto.deleteRule = function deleteRule(index) {\n        if (typeof window === \"undefined\") {\n            this._serverSheet.deleteRule(index);\n            return;\n        }\n        if (this._optimizeForSpeed) {\n            this.replaceRule(index, \"\");\n        } else {\n            var tag = this._tags[index];\n            invariant$1(tag, \"rule at index `\" + index + \"` not found\");\n            tag.parentNode.removeChild(tag);\n            this._tags[index] = null;\n        }\n    };\n    _proto.flush = function flush() {\n        this._injected = false;\n        this._rulesCount = 0;\n        if (typeof window !== \"undefined\") {\n            this._tags.forEach(function(tag) {\n                return tag && tag.parentNode.removeChild(tag);\n            });\n            this._tags = [];\n        } else {\n            // simpler on server\n            this._serverSheet.cssRules = [];\n        }\n    };\n    _proto.cssRules = function cssRules() {\n        var _this = this;\n        if (typeof window === \"undefined\") {\n            return this._serverSheet.cssRules;\n        }\n        return this._tags.reduce(function(rules, tag) {\n            if (tag) {\n                rules = rules.concat(Array.prototype.map.call(_this.getSheetForTag(tag).cssRules, function(rule) {\n                    return rule.cssText === _this._deletedRulePlaceholder ? null : rule;\n                }));\n            } else {\n                rules.push(null);\n            }\n            return rules;\n        }, []);\n    };\n    _proto.makeStyleTag = function makeStyleTag(name, cssString, relativeToTag) {\n        if (cssString) {\n            invariant$1(isString(cssString), \"makeStyleTag accepts only strings as second parameter\");\n        }\n        var tag = document.createElement(\"style\");\n        if (this._nonce) tag.setAttribute(\"nonce\", this._nonce);\n        tag.type = \"text/css\";\n        tag.setAttribute(\"data-\" + name, \"\");\n        if (cssString) {\n            tag.appendChild(document.createTextNode(cssString));\n        }\n        var head = document.head || document.getElementsByTagName(\"head\")[0];\n        if (relativeToTag) {\n            head.insertBefore(tag, relativeToTag);\n        } else {\n            head.appendChild(tag);\n        }\n        return tag;\n    };\n    _createClass(StyleSheet, [\n        {\n            key: \"length\",\n            get: function get() {\n                return this._rulesCount;\n            }\n        }\n    ]);\n    return StyleSheet;\n}();\nfunction invariant$1(condition, message) {\n    if (!condition) {\n        throw new Error(\"StyleSheet: \" + message + \".\");\n    }\n}\n\nfunction hash(str) {\n    var _$hash = 5381, i = str.length;\n    while(i){\n        _$hash = _$hash * 33 ^ str.charCodeAt(--i);\n    }\n    /* JavaScript does bitwise operations (like XOR, above) on 32-bit signed\n   * integers. Since we want the results to be always positive, convert the\n   * signed int to an unsigned by doing an unsigned bitshift. */ return _$hash >>> 0;\n}\nvar stringHash = hash;\n\nvar sanitize = function(rule) {\n    return rule.replace(/\\/style/gi, \"\\\\/style\");\n};\nvar cache = {};\n/**\n * computeId\n *\n * Compute and memoize a jsx id from a basedId and optionally props.\n */ function computeId(baseId, props) {\n    if (!props) {\n        return \"jsx-\" + baseId;\n    }\n    var propsToString = String(props);\n    var key = baseId + propsToString;\n    if (!cache[key]) {\n        cache[key] = \"jsx-\" + stringHash(baseId + \"-\" + propsToString);\n    }\n    return cache[key];\n}\n/**\n * computeSelector\n *\n * Compute and memoize dynamic selectors.\n */ function computeSelector(id, css) {\n    var selectoPlaceholderRegexp = /__jsx-style-dynamic-selector/g;\n    // Sanitize SSR-ed CSS.\n    // Client side code doesn't need to be sanitized since we use\n    // document.createTextNode (dev) and the CSSOM api sheet.insertRule (prod).\n    if (typeof window === \"undefined\") {\n        css = sanitize(css);\n    }\n    var idcss = id + css;\n    if (!cache[idcss]) {\n        cache[idcss] = css.replace(selectoPlaceholderRegexp, id);\n    }\n    return cache[idcss];\n}\n\nfunction mapRulesToStyle(cssRules, options) {\n    if (options === void 0) options = {};\n    return cssRules.map(function(args) {\n        var id = args[0];\n        var css = args[1];\n        return /*#__PURE__*/ React__default[\"default\"].createElement(\"style\", {\n            id: \"__\" + id,\n            // Avoid warnings upon render with a key\n            key: \"__\" + id,\n            nonce: options.nonce ? options.nonce : undefined,\n            dangerouslySetInnerHTML: {\n                __html: css\n            }\n        });\n    });\n}\nvar StyleSheetRegistry = /*#__PURE__*/ function() {\n    function StyleSheetRegistry(param) {\n        var ref = param === void 0 ? {} : param, _styleSheet = ref.styleSheet, styleSheet = _styleSheet === void 0 ? null : _styleSheet, _optimizeForSpeed = ref.optimizeForSpeed, optimizeForSpeed = _optimizeForSpeed === void 0 ? false : _optimizeForSpeed;\n        this._sheet = styleSheet || new StyleSheet({\n            name: \"styled-jsx\",\n            optimizeForSpeed: optimizeForSpeed\n        });\n        this._sheet.inject();\n        if (styleSheet && typeof optimizeForSpeed === \"boolean\") {\n            this._sheet.setOptimizeForSpeed(optimizeForSpeed);\n            this._optimizeForSpeed = this._sheet.isOptimizeForSpeed();\n        }\n        this._fromServer = undefined;\n        this._indices = {};\n        this._instancesCounts = {};\n    }\n    var _proto = StyleSheetRegistry.prototype;\n    _proto.add = function add(props) {\n        var _this = this;\n        if (undefined === this._optimizeForSpeed) {\n            this._optimizeForSpeed = Array.isArray(props.children);\n            this._sheet.setOptimizeForSpeed(this._optimizeForSpeed);\n            this._optimizeForSpeed = this._sheet.isOptimizeForSpeed();\n        }\n        if (typeof window !== \"undefined\" && !this._fromServer) {\n            this._fromServer = this.selectFromServer();\n            this._instancesCounts = Object.keys(this._fromServer).reduce(function(acc, tagName) {\n                acc[tagName] = 0;\n                return acc;\n            }, {});\n        }\n        var ref = this.getIdAndRules(props), styleId = ref.styleId, rules = ref.rules;\n        // Deduping: just increase the instances count.\n        if (styleId in this._instancesCounts) {\n            this._instancesCounts[styleId] += 1;\n            return;\n        }\n        var indices = rules.map(function(rule) {\n            return _this._sheet.insertRule(rule);\n        })// Filter out invalid rules\n        .filter(function(index) {\n            return index !== -1;\n        });\n        this._indices[styleId] = indices;\n        this._instancesCounts[styleId] = 1;\n    };\n    _proto.remove = function remove(props) {\n        var _this = this;\n        var styleId = this.getIdAndRules(props).styleId;\n        invariant(styleId in this._instancesCounts, \"styleId: `\" + styleId + \"` not found\");\n        this._instancesCounts[styleId] -= 1;\n        if (this._instancesCounts[styleId] < 1) {\n            var tagFromServer = this._fromServer && this._fromServer[styleId];\n            if (tagFromServer) {\n                tagFromServer.parentNode.removeChild(tagFromServer);\n                delete this._fromServer[styleId];\n            } else {\n                this._indices[styleId].forEach(function(index) {\n                    return _this._sheet.deleteRule(index);\n                });\n                delete this._indices[styleId];\n            }\n            delete this._instancesCounts[styleId];\n        }\n    };\n    _proto.update = function update(props, nextProps) {\n        this.add(nextProps);\n        this.remove(props);\n    };\n    _proto.flush = function flush() {\n        this._sheet.flush();\n        this._sheet.inject();\n        this._fromServer = undefined;\n        this._indices = {};\n        this._instancesCounts = {};\n    };\n    _proto.cssRules = function cssRules() {\n        var _this = this;\n        var fromServer = this._fromServer ? Object.keys(this._fromServer).map(function(styleId) {\n            return [\n                styleId,\n                _this._fromServer[styleId]\n            ];\n        }) : [];\n        var cssRules = this._sheet.cssRules();\n        return fromServer.concat(Object.keys(this._indices).map(function(styleId) {\n            return [\n                styleId,\n                _this._indices[styleId].map(function(index) {\n                    return cssRules[index].cssText;\n                }).join(_this._optimizeForSpeed ? \"\" : \"\\n\")\n            ];\n        })// filter out empty rules\n        .filter(function(rule) {\n            return Boolean(rule[1]);\n        }));\n    };\n    _proto.styles = function styles(options) {\n        return mapRulesToStyle(this.cssRules(), options);\n    };\n    _proto.getIdAndRules = function getIdAndRules(props) {\n        var css = props.children, dynamic = props.dynamic, id = props.id;\n        if (dynamic) {\n            var styleId = computeId(id, dynamic);\n            return {\n                styleId: styleId,\n                rules: Array.isArray(css) ? css.map(function(rule) {\n                    return computeSelector(styleId, rule);\n                }) : [\n                    computeSelector(styleId, css)\n                ]\n            };\n        }\n        return {\n            styleId: computeId(id),\n            rules: Array.isArray(css) ? css : [\n                css\n            ]\n        };\n    };\n    /**\n   * selectFromServer\n   *\n   * Collects style tags from the document with id __jsx-XXX\n   */ _proto.selectFromServer = function selectFromServer() {\n        var elements = Array.prototype.slice.call(document.querySelectorAll('[id^=\"__jsx-\"]'));\n        return elements.reduce(function(acc, element) {\n            var id = element.id.slice(2);\n            acc[id] = element;\n            return acc;\n        }, {});\n    };\n    return StyleSheetRegistry;\n}();\nfunction invariant(condition, message) {\n    if (!condition) {\n        throw new Error(\"StyleSheetRegistry: \" + message + \".\");\n    }\n}\nvar StyleSheetContext = /*#__PURE__*/ React.createContext(null);\nStyleSheetContext.displayName = \"StyleSheetContext\";\nfunction createStyleRegistry() {\n    return new StyleSheetRegistry();\n}\nfunction StyleRegistry(param) {\n    var configuredRegistry = param.registry, children = param.children;\n    var rootRegistry = React.useContext(StyleSheetContext);\n    var ref = React.useState(function() {\n        return rootRegistry || configuredRegistry || createStyleRegistry();\n    }), registry = ref[0];\n    return /*#__PURE__*/ React__default[\"default\"].createElement(StyleSheetContext.Provider, {\n        value: registry\n    }, children);\n}\nfunction useStyleRegistry() {\n    return React.useContext(StyleSheetContext);\n}\n\n// Opt-into the new `useInsertionEffect` API in React 18, fallback to `useLayoutEffect`.\n// https://github.com/reactwg/react-18/discussions/110\nvar useInsertionEffect = React__default[\"default\"].useInsertionEffect || React__default[\"default\"].useLayoutEffect;\nvar defaultRegistry = typeof window !== \"undefined\" ? createStyleRegistry() : undefined;\nfunction JSXStyle(props) {\n    var registry = defaultRegistry ? defaultRegistry : useStyleRegistry();\n    // If `registry` does not exist, we do nothing here.\n    if (!registry) {\n        return null;\n    }\n    if (typeof window === \"undefined\") {\n        registry.add(props);\n        return null;\n    }\n    useInsertionEffect(function() {\n        registry.add(props);\n        return function() {\n            registry.remove(props);\n        };\n    // props.children can be string[], will be striped since id is identical\n    }, [\n        props.id,\n        String(props.dynamic)\n    ]);\n    return null;\n}\nJSXStyle.dynamic = function(info) {\n    return info.map(function(tagInfo) {\n        var baseId = tagInfo[0];\n        var props = tagInfo[1];\n        return computeId(baseId, props);\n    }).join(\" \");\n};\n\nexports.StyleRegistry = StyleRegistry;\nexports.createStyleRegistry = createStyleRegistry;\nexports.style = JSXStyle;\nexports.useStyleRegistry = useStyleRegistry;\n","module.exports = require('./dist/index').style\n","\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport type { User, Project, Allocation } from \"@/lib/types\"\r\nimport { getCurrentUser, getCurrentUserData, getCurrentSystemUser } from \"@/lib/storage\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport Link from \"next/link\"\r\n\r\nconst MONTHS = [\r\n  \"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\r\n  \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\r\n]\r\n\r\ninterface ExpenseAllocationRow {\r\n  id: string\r\n  entity: string\r\n  description: string\r\n  currency: string\r\n  amount: number\r\n  projectAmounts: Record<string, number>\r\n}\r\n\r\nexport default function ExpenseAllocationPage() {\r\n  const [currentUser, setCurrentUser] = React.useState<string | null>(null)\r\n  const [selectedMonth, setSelectedMonth] = React.useState<number>(() => {\r\n    // Load saved month from localStorage or use current month\r\n    if (typeof window !== 'undefined') {\r\n      const savedMonth = localStorage.getItem('sola-selected-month')\r\n      return savedMonth !== null ? parseInt(savedMonth) : new Date().getMonth()\r\n    }\r\n    return new Date().getMonth()\r\n  })\r\n  const [selectedYear, setSelectedYear] = React.useState<number>(() => {\r\n    // Load saved year from localStorage or use current year\r\n    if (typeof window !== 'undefined') {\r\n      const savedYear = localStorage.getItem('sola-selected-year')\r\n      return savedYear !== null ? parseInt(savedYear) : new Date().getFullYear()\r\n    }\r\n    return new Date().getFullYear()\r\n  })\r\n  const [isClient, setIsClient] = React.useState<boolean>(false)\r\n  const [users, setUsers] = React.useState<User[]>([])\r\n  const [projects, setProjects] = React.useState<Project[]>([])\r\n  const [allocations, setAllocations] = React.useState<Allocation[]>([])\r\n  const [expenseRows, setExpenseRows] = React.useState<ExpenseAllocationRow[]>([])\r\n  const [selectedEntity, setSelectedEntity] = React.useState<string | null>(null)\r\n  const [showEntityUsers, setShowEntityUsers] = React.useState<boolean>(false)\r\n  const [descriptionFilter, setDescriptionFilter] = React.useState<string>('')\r\n\r\n  // Save month/year to localStorage when they change\r\n  React.useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      localStorage.setItem('sola-selected-month', selectedMonth.toString())\r\n      localStorage.setItem('sola-selected-year', selectedYear.toString())\r\n    }\r\n  }, [selectedMonth, selectedYear])\r\n\r\n  // Handle client-side hydration\r\n  React.useEffect(() => {\r\n    setIsClient(true)\r\n  }, [])\r\n\r\n  // Load user data on component mount\r\n  React.useEffect(() => {\r\n    const user = getCurrentUser()\r\n    const systemUser = getCurrentSystemUser()\r\n    if (!user || !systemUser) {\r\n      window.location.href = \"/login\"\r\n      return\r\n    }\r\n    \r\n    setCurrentUser(user)\r\n\r\n    // Load data from localStorage\r\n    const userData = getCurrentUserData()\r\n    setUsers(userData.users || [])\r\n    setProjects(userData.projects || [])\r\n    setAllocations(userData.allocations || [])\r\n  }, [])\r\n\r\n  // Load expense allocation data when month changes or user is set\r\n  React.useEffect(() => {\r\n    if (!currentUser) return\r\n    \r\n    const monthKey = `${selectedYear}-${selectedMonth}`\r\n    const savedExpenseRows = localStorage.getItem(`sola-expense-allocation-${currentUser}-${monthKey}`)\r\n    if (savedExpenseRows) {\r\n      try {\r\n        setExpenseRows(JSON.parse(savedExpenseRows))\r\n      } catch (error) {\r\n        console.error('Error parsing expense rows:', error)\r\n        setExpenseRows([])\r\n      }\r\n    } else {\r\n      setExpenseRows([])\r\n    }\r\n  }, [selectedMonth, selectedYear, currentUser])\r\n\r\n  // Save expense allocation data when it changes\r\n  React.useEffect(() => {\r\n    if (!currentUser) return\r\n    \r\n    const monthKey = `${selectedYear}-${selectedMonth}`\r\n    localStorage.setItem(`sola-expense-allocation-${currentUser}-${monthKey}`, JSON.stringify(expenseRows))\r\n  }, [expenseRows, selectedMonth, selectedYear, currentUser])\r\n\r\n  // Calculate average % allocation by project for each entity\r\n  const entityProjectAllocations = React.useMemo(() => {\r\n    const monthIndex = (selectedYear - 2024) * 12 + selectedMonth\r\n    \r\n    // Get active projects for the selected month\r\n    const activeProjects = projects.filter(project => {\r\n      const projectStartMonth = ((project.startYear || 2024) - 2024) * 12 + (project.startMonth || 0)\r\n      const projectEndMonth = ((project.endYear || 2024) - 2024) * 12 + (project.endMonth || 11)\r\n      return monthIndex >= projectStartMonth && monthIndex <= projectEndMonth\r\n    })\r\n\r\n    // Group users by entity\r\n    const entityGroups: Record<string, User[]> = {}\r\n    users.forEach(user => {\r\n      const entity = user.entity || \"Unassigned\"\r\n      if (!entityGroups[entity]) {\r\n        entityGroups[entity] = []\r\n      }\r\n      entityGroups[entity].push(user)\r\n    })\r\n\r\n    // Calculate entity allocation by averaging user percentages (not total hours)\r\n    const entityProjectAllocations: Record<string, Record<string, number>> = {}\r\n\r\n    Object.entries(entityGroups).forEach(([entity, entityUsers]) => {\r\n      entityProjectAllocations[entity] = {}\r\n      \r\n      activeProjects.forEach(project => {\r\n        const userPercentages: number[] = []\r\n        \r\n        entityUsers.forEach(user => {\r\n          // Get project data from user's projectDataByMonth\r\n          const monthKey = `${selectedYear}-${selectedMonth}`\r\n          const projectData = (user as any).projectDataByMonth?.[monthKey] || {}\r\n          const userProjectHours = projectData[project.id] || 0\r\n          \r\n          // Calculate this user's total hours across all projects\r\n          const totalUserHours = activeProjects.reduce((total, p) => total + (projectData[p.id] || 0), 0)\r\n          \r\n          // Calculate this user's percentage for this project\r\n          if (totalUserHours > 0) {\r\n            const userPercentage = (userProjectHours / totalUserHours) * 100\r\n            userPercentages.push(userPercentage)\r\n          }\r\n        })\r\n        \r\n        // Calculate average percentage for this entity-project combination\r\n        if (userPercentages.length > 0) {\r\n          const averagePercentage = userPercentages.reduce((sum, percentage) => sum + percentage, 0) / userPercentages.length\r\n          entityProjectAllocations[entity][project.name] = averagePercentage\r\n        } else {\r\n          entityProjectAllocations[entity][project.name] = 0\r\n        }\r\n      })\r\n    })\r\n\r\n    return entityProjectAllocations\r\n  }, [users, projects, allocations, selectedMonth, selectedYear])\r\n\r\n  // Get unique projects for columns\r\n  const uniqueProjects = React.useMemo(() => {\r\n    const monthIndex = (selectedYear - 2024) * 12 + selectedMonth\r\n    return projects\r\n      .filter(project => {\r\n        const projectStartMonth = ((project.startYear || 2024) - 2024) * 12 + (project.startMonth || 0)\r\n        const projectEndMonth = ((project.endYear || 2024) - 2024) * 12 + (project.endMonth || 11)\r\n        return monthIndex >= projectStartMonth && monthIndex <= projectEndMonth\r\n      })\r\n      .map(p => p.name)\r\n      .sort()\r\n  }, [projects, selectedMonth, selectedYear])\r\n\r\n  // Get unique entities for dropdown\r\n  const uniqueEntities = React.useMemo(() => {\r\n    const entities = new Set<string>()\r\n    users.forEach(user => {\r\n      if (user.entity) {\r\n        entities.add(user.entity)\r\n      }\r\n    })\r\n    return Array.from(entities).sort()\r\n  }, [users])\r\n\r\n  // Add new expense row\r\n  const addExpenseRow = () => {\r\n    const newRow: ExpenseAllocationRow = {\r\n      id: Date.now().toString(),\r\n      entity: uniqueEntities[0] || '',\r\n      description: '',\r\n      currency: 'USD',\r\n      amount: 0,\r\n      projectAmounts: {}\r\n    }\r\n    \r\n    // Initialize project amounts\r\n    uniqueProjects.forEach(project => {\r\n      newRow.projectAmounts[project] = 0\r\n    })\r\n    \r\n    setExpenseRows([...expenseRows, newRow])\r\n  }\r\n\r\n  // Update expense row\r\n  const updateExpenseRow = (id: string, field: keyof ExpenseAllocationRow, value: string | number) => {\r\n    setExpenseRows(expenseRows.map(row => \r\n      row.id === id ? { ...row, [field]: value } : row\r\n    ))\r\n  }\r\n\r\n  // Update project amount for expense row\r\n  const updateProjectAmount = (id: string, project: string, value: number) => {\r\n    setExpenseRows(expenseRows.map(row => \r\n      row.id === id ? { \r\n        ...row, \r\n        projectAmounts: { ...row.projectAmounts, [project]: value }\r\n      } : row\r\n    ))\r\n  }\r\n\r\n  // Delete expense row\r\n  const deleteExpenseRow = (id: string) => {\r\n    setExpenseRows(expenseRows.filter(row => row.id !== id))\r\n  }\r\n\r\n  // Handle entity click in summary table\r\n  const handleEntityClick = (entity: string) => {\r\n    if (selectedEntity === entity && showEntityUsers) {\r\n      // If already selected, toggle off\r\n      setSelectedEntity(null)\r\n      setShowEntityUsers(false)\r\n    } else {\r\n      // Select new entity\r\n      setSelectedEntity(entity)\r\n      setShowEntityUsers(true)\r\n    }\r\n  }\r\n\r\n  // Calculate user project percentages for selected entity\r\n  const entityUserProjectAllocations = React.useMemo(() => {\r\n    if (!selectedEntity || !showEntityUsers) return {}\r\n\r\n    const monthIndex = (selectedYear - 2024) * 12 + selectedMonth\r\n    \r\n    // Get active projects for the selected month\r\n    const activeProjects = projects.filter(project => {\r\n      const projectStartMonth = ((project.startYear || 2024) - 2024) * 12 + (project.startMonth || 0)\r\n      const projectEndMonth = ((project.endYear || 2024) - 2024) * 12 + (project.endMonth || 11)\r\n      return monthIndex >= projectStartMonth && monthIndex <= projectEndMonth\r\n    })\r\n\r\n    // Get users for the selected entity\r\n    const entityUsers = users.filter(user => user.entity === selectedEntity)\r\n\r\n    // Calculate project percentages for each user\r\n    const userProjectAllocations: Record<string, Record<string, number>> = {}\r\n\r\n    entityUsers.forEach(user => {\r\n      userProjectAllocations[user.name] = {}\r\n      \r\n      // Get project data from user's projectDataByMonth\r\n      const monthKey = `${selectedYear}-${selectedMonth}`\r\n      const projectData = (user as any).projectDataByMonth?.[monthKey] || {}\r\n      \r\n      // Calculate this user's total hours across all projects\r\n      const totalUserHours = activeProjects.reduce((total, p) => total + (projectData[p.id] || 0), 0)\r\n      \r\n      // Calculate percentage for each project\r\n      activeProjects.forEach(project => {\r\n        const userProjectHours = projectData[project.id] || 0\r\n        if (totalUserHours > 0) {\r\n          userProjectAllocations[user.name][project.name] = (userProjectHours / totalUserHours) * 100\r\n        } else {\r\n          userProjectAllocations[user.name][project.name] = 0\r\n        }\r\n      })\r\n    })\r\n\r\n    return userProjectAllocations\r\n  }, [selectedEntity, showEntityUsers, users, projects, selectedMonth, selectedYear])\r\n\r\n  // Filter expense rows by selected entity and description\r\n  const filteredExpenseRows = React.useMemo(() => {\r\n    let filtered = expenseRows\r\n    \r\n    // Filter by entity\r\n    if (selectedEntity) {\r\n      filtered = filtered.filter(row => row.entity === selectedEntity)\r\n    }\r\n    \r\n    // Filter by description\r\n    if (descriptionFilter.trim()) {\r\n      filtered = filtered.filter(row => \r\n        row.description.toLowerCase().includes(descriptionFilter.toLowerCase().trim())\r\n      )\r\n    }\r\n    \r\n    return filtered\r\n  }, [expenseRows, selectedEntity, descriptionFilter])\r\n\r\n  // Filter entity allocations by selected entity\r\n  const filteredEntityAllocations = React.useMemo(() => {\r\n    if (!selectedEntity) return entityProjectAllocations\r\n    return { [selectedEntity]: entityProjectAllocations[selectedEntity] }\r\n  }, [entityProjectAllocations, selectedEntity])\r\n\r\n  // Check if payroll allocation is locked for the selected month\r\n  const [isPayrollLocked, setIsPayrollLocked] = React.useState(false)\r\n\r\n  // Update lock state when month changes or on storage events\r\n  React.useEffect(() => {\r\n    const checkLockState = () => {\r\n      const monthKey = `${selectedYear}-${selectedMonth}`\r\n      const lockState = localStorage.getItem(`sola-lock-state-${monthKey}`)\r\n      const newState = lockState === 'true' // Fixed: was checking for 'locked', should be 'true'\r\n      console.log(`Checking lock state for ${monthKey}:`, lockState, newState)\r\n      setIsPayrollLocked(newState)\r\n    }\r\n\r\n    // Initial check\r\n    checkLockState()\r\n\r\n    // Listen for storage changes (when user locks/unlocks in another tab)\r\n    const handleStorageChange = (e: StorageEvent) => {\r\n      console.log('Storage change detected:', e.key, e.newValue)\r\n      if (e.key === `sola-lock-state-${selectedYear}-${selectedMonth}`) {\r\n        checkLockState()\r\n      }\r\n    }\r\n\r\n    // Also listen for any localStorage changes (same tab) - more robust approach\r\n    let storageTimer: NodeJS.Timeout\r\n    const monitorStorage = () => {\r\n      const currentLockState = localStorage.getItem(`sola-lock-state-${selectedYear}-${selectedMonth}`)\r\n      const isLocked = currentLockState === 'true' // Fixed: was checking for 'locked', should be 'true'\r\n      \r\n      // Check if state changed\r\n      setIsPayrollLocked(prevState => {\r\n        if (prevState !== isLocked) {\r\n          console.log(`Lock state changed from ${prevState} to ${isLocked}`)\r\n          return isLocked\r\n        }\r\n        return prevState\r\n      })\r\n    }\r\n\r\n    // Set up periodic monitoring\r\n    storageTimer = setInterval(monitorStorage, 500) // Check every 500ms for faster response\r\n\r\n    // Also check when window gets focus (user returns to this tab)\r\n    const handleWindowFocus = () => {\r\n      console.log('Window focused, checking lock state')\r\n      checkLockState()\r\n    }\r\n\r\n    // Also check when page becomes visible\r\n    const handleVisibilityChange = () => {\r\n      if (!document.hidden) {\r\n        console.log('Page became visible, checking lock state')\r\n        checkLockState()\r\n      }\r\n    }\r\n\r\n    window.addEventListener('storage', handleStorageChange)\r\n    window.addEventListener('focus', handleWindowFocus)\r\n    document.addEventListener('visibilitychange', handleVisibilityChange)\r\n\r\n    // Cleanup\r\n    return () => {\r\n      window.removeEventListener('storage', handleStorageChange)\r\n      window.removeEventListener('focus', handleWindowFocus)\r\n      document.removeEventListener('visibilitychange', handleVisibilityChange)\r\n      if (storageTimer) clearInterval(storageTimer)\r\n    }\r\n  }, [selectedMonth, selectedYear])\r\n\r\n  // Export to PDF functionality\r\n  const exportToPDF = () => {\r\n    window.print()\r\n  }\r\n\r\n  // Manual refresh of lock state\r\n  const refreshLockState = () => {\r\n    const monthKey = `${selectedYear}-${selectedMonth}`\r\n    const lockState = localStorage.getItem(`sola-lock-state-${monthKey}`)\r\n    const newState = lockState === 'true' // Fixed: was checking for 'locked', should be 'true'\r\n    console.log(`Manual refresh - Lock state for ${monthKey}:`, lockState, newState)\r\n    setIsPayrollLocked(newState)\r\n  }\r\n\r\n  // Additional check when component gains focus or user navigates back\r\n  React.useEffect(() => {\r\n    const handleRouteChange = () => {\r\n      console.log('Route change detected, checking lock state')\r\n      setTimeout(refreshLockState, 100)\r\n    }\r\n\r\n    // Check immediately when component mounts\r\n    setTimeout(refreshLockState, 500)\r\n\r\n    // Listen for navigation events\r\n    window.addEventListener('popstate', handleRouteChange)\r\n    \r\n    return () => {\r\n      window.removeEventListener('popstate', handleRouteChange)\r\n    }\r\n  }, [selectedMonth, selectedYear])\r\n\r\n  // Calculate project amounts when entity or total amount changes\r\n  React.useEffect(() => {\r\n    expenseRows.forEach(row => {\r\n      if (row.entity && row.amount > 0) {\r\n        const newProjectAmounts: Record<string, number> = {}\r\n        uniqueProjects.forEach(project => {\r\n          const percentage = entityProjectAllocations[row.entity]?.[project] || 0\r\n          newProjectAmounts[project] = (row.amount * percentage) / 100\r\n        })\r\n        \r\n        // Update row if project amounts changed\r\n        const currentProjectAmounts = JSON.stringify(row.projectAmounts)\r\n        const newProjectAmountsStr = JSON.stringify(newProjectAmounts)\r\n        if (currentProjectAmounts !== newProjectAmountsStr) {\r\n          setExpenseRows(expenseRows.map(r => \r\n            r.id === row.id ? { \r\n              ...r, \r\n              projectAmounts: newProjectAmounts\r\n            } : r\r\n          ))\r\n        }\r\n      }\r\n    })\r\n  }, [entityProjectAllocations, expenseRows.map(r => `${r.entity}-${r.amount}`).join(','), uniqueProjects])\r\n\r\n  if (!isClient) {\r\n    return null\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <style jsx global>{`\r\n        @media print {\r\n          body {\r\n            -webkit-print-color-adjust: exact;\r\n            color-adjust: exact;\r\n          }\r\n          \r\n          nav {\r\n            display: none !important;\r\n          }\r\n          \r\n          button:not(.print-visible) {\r\n            display: none !important;\r\n          }\r\n          \r\n          .no-print {\r\n            display: none !important;\r\n          }\r\n          \r\n          .print-only {\r\n            display: block !important;\r\n          }\r\n          \r\n          table {\r\n            page-break-inside: avoid;\r\n          }\r\n          \r\n          tr {\r\n            page-break-inside: avoid;\r\n          }\r\n          \r\n          td, th {\r\n            page-break-inside: avoid;\r\n          }\r\n        }\r\n        \r\n        .print-only {\r\n          display: none;\r\n        }\r\n      `}</style>\r\n      \r\n      <main className=\"min-h-screen bg-background\">\r\n      <nav className=\"bg-white border-b border-gray-200 px-6 py-3\">\r\n        <div className=\"flex items-center gap-6\">\r\n          <h1 className=\"text-lg font-semibold text-gray-900\">Sola</h1>\r\n          <div className=\"flex gap-4\">\r\n            <Link \r\n              href=\"/\" \r\n              className=\"text-gray-600 hover:text-gray-800 font-medium\"\r\n            >\r\n              Allocation\r\n            </Link>\r\n            <Link \r\n              href=\"/planning\" \r\n              className=\"text-gray-600 hover:text-gray-800 font-medium\"\r\n            >\r\n              Planning\r\n            </Link>\r\n            <Link \r\n              href=\"/actual-allocation\" \r\n              className=\"text-gray-600 hover:text-gray-800 font-medium\"\r\n            >\r\n              Payroll Allocation\r\n            </Link>\r\n            <Link \r\n              href=\"/expense-allocation\" \r\n              className=\"text-blue-600 hover:text-blue-800 font-medium\"\r\n            >\r\n              Expense Allocation\r\n            </Link>\r\n            <Link \r\n              href=\"/scheduled-records\" \r\n              className=\"text-gray-600 hover:text-gray-800 font-medium\"\r\n            >\r\n              Scheduled Records\r\n            </Link>\r\n          </div>\r\n          <div className=\"ml-auto flex gap-2 items-center\">\r\n            <select\r\n              value={selectedMonth}\r\n              onChange={(e) => setSelectedMonth(Number(e.target.value))}\r\n              className=\"border border-gray-300 rounded px-2 py-1 text-sm\"\r\n            >\r\n              {MONTHS.map((month, idx) => (\r\n                <option key={idx} value={idx}>{month}</option>\r\n              ))}\r\n            </select>\r\n            <select\r\n              value={selectedYear}\r\n              onChange={(e) => setSelectedYear(Number(e.target.value))}\r\n              className=\"border border-gray-300 rounded px-2 py-1 text-sm\"\r\n            >\r\n              {[2023, 2024, 2025, 2026, 2027].map(year => (\r\n                <option key={year} value={year}>{year}</option>\r\n              ))}\r\n            </select>\r\n            <Button\r\n              onClick={() => {\r\n                const user = getCurrentUser()\r\n                if (user) {\r\n                  window.location.href = \"/login\"\r\n                }\r\n              }}\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n            >\r\n              Logout\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </nav>\r\n\r\n      <div className=\"p-6\">\r\n        {/* Warning Message - Only show if payroll is not locked */}\r\n        {!isPayrollLocked && (\r\n          <div className=\"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg\">\r\n            <div className=\"flex items-start\">\r\n              <div className=\"flex-shrink-0\">\r\n                <svg className=\"h-5 w-5 text-yellow-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n                  <path fillRule=\"evenodd\" d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\r\n                </svg>\r\n              </div>\r\n              <div className=\"ml-3 flex-1\">\r\n                <h3 className=\"text-sm font-medium text-yellow-800\">\r\n                  Payroll Allocation Not Locked\r\n                </h3>\r\n                <div className=\"mt-2 text-sm text-yellow-700\">\r\n                  <p>\r\n                    The payroll allocation for <strong>{MONTHS[selectedMonth]} {selectedYear}</strong> is not yet locked. \r\n                    Expense allocations may change if payroll data is modified.\r\n                  </p>\r\n                  <p className=\"mt-1\">\r\n                    Please lock the payroll allocation in the <strong>Payroll Allocation</strong> page to finalize the data.\r\n                  </p>\r\n                </div>\r\n                <div className=\"mt-3 flex items-center gap-3\">\r\n                  <Link\r\n                    href=\"/actual-allocation\"\r\n                    className=\"text-sm font-medium text-yellow-800 hover:text-yellow-900 underline\"\r\n                  >\r\n                    Go to Payroll Allocation ‚Üí\r\n                  </Link>\r\n                  <button\r\n                    onClick={refreshLockState}\r\n                    className=\"text-sm font-medium text-yellow-700 hover:text-yellow-800 underline\"\r\n                  >\r\n                    üîÑ Refresh Status\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Print Header - Only visible when printing */}\r\n        <div className=\"print-only mb-6 text-center\">\r\n          <h1 className=\"text-2xl font-bold text-gray-800 mb-2\">Expense Allocation Report</h1>\r\n          <p className=\"text-lg text-gray-600\">Period: {MONTHS[selectedMonth]} {selectedYear}</p>\r\n          {selectedEntity && (\r\n            <p className=\"text-md text-gray-500 mt-1\">Filtered by Entity: {selectedEntity}</p>\r\n          )}\r\n          <p className=\"text-sm text-gray-400 mt-2\">Generated on: {new Date().toLocaleDateString()}</p>\r\n          {!isPayrollLocked && (\r\n            <p className=\"text-xs text-orange-500 mt-1 font-medium\">‚ö†Ô∏è Payroll Allocation Not Locked</p>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"flex justify-between items-center mb-6 no-print\">\r\n          <h2 className=\"text-xl font-semibold text-gray-800\">Expense Allocation</h2>\r\n        </div>\r\n\r\n        {uniqueProjects.length === 0 ? (\r\n          <div className=\"text-center py-8 text-gray-500\">\r\n            <p className=\"text-lg\">No projects found for the selected month.</p>\r\n            <p className=\"text-sm mt-2\">Please ensure there are active projects for {MONTHS[selectedMonth]} {selectedYear}.</p>\r\n          </div>\r\n        ) : (\r\n          <>\r\n            {/* Entity Allocation Summary Table - Compact */}\r\n            <div className=\"mb-8\">\r\n              <div className=\"flex justify-between items-center mb-3\">\r\n                <h3 className=\"text-lg font-medium text-gray-700\">Entity Allocation Summary</h3>\r\n                <div className=\"flex gap-2\">\r\n                  {selectedEntity && (\r\n                    <Button\r\n                      onClick={() => {\r\n                        setSelectedEntity(null)\r\n                        setShowEntityUsers(false)\r\n                      }}\r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                    >\r\n                      Clear Filter\r\n                    </Button>\r\n                  )}\r\n                  <Button onClick={exportToPDF} variant=\"outline\" size=\"sm\">\r\n                    üìÑ Export PDF\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n              <div className=\"overflow-x-auto\">\r\n                <table className=\"w-full border-collapse border border-gray-300 text-xs\">\r\n                  <thead>\r\n                    <tr>\r\n                      <th className=\"border border-gray-300 p-2 bg-gray-50 text-left text-xs font-semibold\">Entity</th>\r\n                      {uniqueProjects.map(project => (\r\n                        <th key={project} className=\"border border-gray-300 p-2 bg-gray-50 text-right text-xs font-semibold whitespace-nowrap\">\r\n                          {project}\r\n                        </th>\r\n                      ))}\r\n                      <th className=\"border border-gray-300 p-2 bg-gray-50 text-right text-xs font-semibold\">Total</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {Object.entries(filteredEntityAllocations).map(([entity, projectAllocations]) => {\r\n                      const entityTotal = Object.values(projectAllocations).reduce((sum, allocation) => sum + allocation, 0)\r\n                      const isSelected = selectedEntity === entity && showEntityUsers\r\n                      \r\n                      return (\r\n                        <React.Fragment key={entity}>\r\n                          <tr className={isSelected ? \"bg-blue-50\" : \"\"}>\r\n                            <td className=\"border border-gray-300 p-2 text-xs font-medium\">\r\n                              <button\r\n                                onClick={() => handleEntityClick(entity)}\r\n                                className=\"text-blue-600 hover:text-blue-800 underline cursor-pointer\"\r\n                              >\r\n                                {entity}\r\n                              </button>\r\n                            </td>\r\n                            {uniqueProjects.map(project => (\r\n                              <td key={project} className=\"border border-gray-300 p-2 text-xs text-right\">\r\n                                {(projectAllocations[project] || 0).toFixed(1)}%\r\n                              </td>\r\n                            ))}\r\n                            <td className=\"border border-gray-300 p-2 text-xs text-right font-bold\">\r\n                              {entityTotal.toFixed(1)}%\r\n                            </td>\r\n                          </tr>\r\n                          {isSelected && Object.entries(entityUserProjectAllocations).map(([userName, userAllocations]) => (\r\n                            <tr key={`${entity}-${userName}`} className=\"bg-gray-50\">\r\n                              <td className=\"border border-gray-300 p-2 text-xs pl-6 text-gray-600\">\r\n                                üë§ {userName}\r\n                              </td>\r\n                              {uniqueProjects.map(project => (\r\n                                <td key={project} className=\"border border-gray-300 p-2 text-xs text-right text-gray-600\">\r\n                                  {(userAllocations[project] || 0).toFixed(1)}%\r\n                                </td>\r\n                              ))}\r\n                              <td className=\"border border-gray-300 p-2 text-xs text-right font-bold text-gray-600\">\r\n                                {Object.values(userAllocations).reduce((sum, allocation) => sum + allocation, 0).toFixed(1)}%\r\n                              </td>\r\n                            </tr>\r\n                          ))}\r\n                        </React.Fragment>\r\n                      )\r\n                    })}\r\n                    {!selectedEntity && (\r\n                      <tr className=\"font-bold bg-gray-100\">\r\n                        <td className=\"border border-gray-300 p-2 text-xs font-bold\">Average</td>\r\n                        {uniqueProjects.map(project => {\r\n                          const projectValues = Object.values(entityProjectAllocations).map(allocations => allocations[project] || 0)\r\n                          const projectAverage = projectValues.length > 0 ? projectValues.reduce((sum, val) => sum + val, 0) / projectValues.length : 0\r\n                          return (\r\n                            <td key={project} className=\"border border-gray-300 p-2 text-xs text-right font-bold\">\r\n                              {projectAverage.toFixed(1)}%\r\n                            </td>\r\n                          )\r\n                        })}\r\n                        <td className=\"border border-gray-300 p-2 text-xs text-right font-bold\">\r\n                          {Object.values(entityProjectAllocations).length > 0 \r\n                            ? (Object.values(entityProjectAllocations)\r\n                                .reduce((sum, allocations) => sum + Object.values(allocations).reduce((s, a) => s + a, 0), 0) / \r\n                                Object.values(entityProjectAllocations).length).toFixed(1) + '%'\r\n                            : '0.0%'\r\n                          }\r\n                        </td>\r\n                      </tr>\r\n                    )}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Expense Allocation Details Table */}\r\n            <div>\r\n              <div className=\"flex justify-between items-center mb-3\">\r\n                <div className=\"flex items-center gap-3\">\r\n                  <h3 className=\"text-lg font-medium text-gray-700\">Expense Allocation Details</h3>\r\n                  {selectedEntity && (\r\n                    <span className=\"text-sm text-blue-600 bg-blue-50 px-2 py-1 rounded\">\r\n                      Filtered by: {selectedEntity}\r\n                    </span>\r\n                  )}\r\n                  {descriptionFilter && (\r\n                    <span className=\"text-sm text-green-600 bg-green-50 px-2 py-1 rounded\">\r\n                      Description: \"{descriptionFilter}\"\r\n                    </span>\r\n                  )}\r\n                </div>\r\n                <Button onClick={addExpenseRow} variant=\"outline\" size=\"sm\">\r\n                  + Add Row\r\n                </Button>\r\n              </div>\r\n              <div className=\"overflow-x-auto\">\r\n                <table className=\"w-full border-collapse border border-gray-300 text-xs\">\r\n                  <thead>\r\n                    <tr>\r\n                      <th className=\"border border-gray-300 p-2 bg-gray-50 text-left text-xs font-semibold w-24\">Entity</th>\r\n                      <th className=\"border border-gray-300 p-2 bg-gray-50 text-left text-xs font-semibold\">\r\n                        <div className=\"flex flex-col gap-1\">\r\n                          <span>Description</span>\r\n                          <input\r\n                            type=\"text\"\r\n                            value={descriptionFilter}\r\n                            onChange={(e) => setDescriptionFilter(e.target.value)}\r\n                            placeholder=\"Filter descriptions...\"\r\n                            className=\"w-full px-1 py-0.5 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500\"\r\n                          />\r\n                        </div>\r\n                      </th>\r\n                      <th className=\"border border-gray-300 p-2 bg-gray-50 text-left text-xs font-semibold w-20\">Currency</th>\r\n                      <th className=\"border border-gray-300 p-2 bg-gray-50 text-right text-xs font-semibold w-28\">Amount</th>\r\n                      {uniqueProjects.map(project => (\r\n                        <th key={project} className=\"border border-gray-300 p-2 bg-gray-50 text-right text-xs font-semibold whitespace-nowrap w-24\">\r\n                          {project}\r\n                        </th>\r\n                      ))}\r\n                      <th className=\"border border-gray-300 p-2 bg-gray-50 text-center text-xs font-semibold w-20\">Actions</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {filteredExpenseRows.map((row) => (\r\n                      <tr key={row.id}>\r\n                        <td className=\"border border-gray-300 p-1 w-24\">\r\n                          <select\r\n                            value={row.entity}\r\n                            onChange={(e) => updateExpenseRow(row.id, 'entity', e.target.value)}\r\n                            className=\"w-full border-0 bg-transparent focus:outline-none focus:ring-1 focus:ring-blue-500 rounded text-xs\"\r\n                          >\r\n                            <option value=\"\">Select Entity</option>\r\n                            {uniqueEntities.map(entity => (\r\n                              <option key={entity} value={entity}>{entity}</option>\r\n                            ))}\r\n                          </select>\r\n                        </td>\r\n                        <td className=\"border border-gray-300 p-1\">\r\n                          <input\r\n                            type=\"text\"\r\n                            value={row.description}\r\n                            onChange={(e) => updateExpenseRow(row.id, 'description', e.target.value)}\r\n                            className=\"w-full border-0 bg-transparent focus:outline-none focus:ring-1 focus:ring-blue-500 rounded text-xs\"\r\n                            placeholder=\"Enter description\"\r\n                          />\r\n                        </td>\r\n                        <td className=\"border border-gray-300 p-1 w-20\">\r\n                          <input\r\n                            type=\"text\"\r\n                            value={row.currency}\r\n                            onChange={(e) => updateExpenseRow(row.id, 'currency', e.target.value)}\r\n                            className=\"w-full border-0 bg-transparent focus:outline-none focus:ring-1 focus:ring-blue-500 rounded text-xs text-center\"\r\n                            placeholder=\"USD\"\r\n                            maxLength={3}\r\n                          />\r\n                        </td>\r\n                        <td className=\"border border-gray-300 p-1 w-28\">\r\n                          <input\r\n                            type=\"number\"\r\n                            value={row.amount}\r\n                            onChange={(e) => updateExpenseRow(row.id, 'amount', parseFloat(e.target.value) || 0)}\r\n                            className=\"w-full text-right border-0 bg-transparent focus:outline-none focus:ring-1 focus:ring-blue-500 rounded text-xs\"\r\n                            placeholder=\"0.00\"\r\n                            step=\"0.01\"\r\n                            min=\"0\"\r\n                          />\r\n                        </td>\r\n                        {uniqueProjects.map(project => (\r\n                          <td key={project} className=\"border border-gray-300 p-1 text-right text-xs w-24\">\r\n                            {(row.projectAmounts[project] || 0).toFixed(2)}\r\n                          </td>\r\n                        ))}\r\n                        <td className=\"border border-gray-300 p-1 text-center w-20\">\r\n                          <Button\r\n                            onClick={() => deleteExpenseRow(row.id)}\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            className=\"text-red-600 hover:text-red-800 text-xs px-2 py-1\"\r\n                          >\r\n                            Delete\r\n                          </Button>\r\n                        </td>\r\n                      </tr>\r\n                    ))}\r\n                    {filteredExpenseRows.length === 0 && (\r\n                      <tr>\r\n                        <td colSpan={5 + uniqueProjects.length} className=\"border border-gray-300 p-8 text-center text-gray-500\">\r\n                          {selectedEntity || descriptionFilter ? (\r\n                            <>\r\n                              {selectedEntity && descriptionFilter \r\n                                ? `No expense rows found for ${selectedEntity} with descriptions matching \"${descriptionFilter}\". \r\n                                   Try adjusting your filters or click \"Add Row\" to add a new expense.`\r\n                                : selectedEntity \r\n                                ? `No expense rows found for ${selectedEntity}. Click \"Add Row\" to add expenses for this entity.`\r\n                                : `No expense rows found with descriptions matching \"${descriptionFilter}\". \r\n                                   Try adjusting your filter or click \"Add Row\" to add a new expense.`\r\n                              }\r\n                            </>\r\n                          ) : (\r\n                            \"No expense rows added yet. Click 'Add Row' to get started.\"\r\n                          )}\r\n                        </td>\r\n                      </tr>\r\n                    )}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            </div>\r\n          </>\r\n        )}\r\n      </div>\r\n      </main>\r\n    </>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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","ignoreList":[0,1]}