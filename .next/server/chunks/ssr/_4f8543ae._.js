module.exports=[46447,(a,b,c)=>{"use strict";b.exports=a.r(60441).vendored["react-ssr"].ReactJsxRuntime},85358,(a,b,c)=>{"use strict";b.exports=a.r(60441).vendored["react-ssr"].ReactServerDOMTurbopackClient},77577,a=>{"use strict";function b(){return[]}function c(a){}function d(a){let b={...a,id:`system-user-${Date.now()}`,createdAt:new Date().toISOString()};return c([b]),b}function e(a,b){c([].map(c=>c.id===a?{...c,...b}:c))}function f(a){c([].filter(b=>b.id!==a))}function g(a,b){return[].find(c=>c.email===a&&c.password===b&&c.isActive)||null}function h(){return null}function i(){let a=h();return a&&[].find(b=>b.email===a)||null}function j(a){}function k(){}function l(a){return{projects:[],users:[],allocations:[],positions:[],entities:[]}}function m(){let a=h();return a?l(a):{projects:[],users:[],allocations:[],positions:[],entities:[]}}function n(a){if(h());}a.s(["addSystemUser",()=>d,"authenticateUser",()=>g,"clearCurrentUser",()=>k,"deleteSystemUser",()=>f,"getCurrentSystemUser",()=>i,"getCurrentUser",()=>h,"getCurrentUserData",()=>m,"getSystemUsers",()=>b,"getUserData",()=>l,"setCurrentUser",()=>j,"setCurrentUserData",()=>n,"updateSystemUser",()=>e])},43437,a=>{"use strict";var b=a.i(46447),c=a.i(30564),d=a.i(77577),e=a.i(35561);let f=["January","February","March","April","May","June","July","August","September","October","November","December"],g=Array.from({length:10},(a,b)=>2024+b);function h(){let[a,h]=(0,c.useState)(null),[i,j]=(0,c.useState)(null),[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)(0),[s,t]=(0,c.useState)(2024),[u,v]=(0,c.useState)("percentage"),[w,x]=(0,c.useState)([]);(0,c.useEffect)(()=>{let a=(0,d.getCurrentUser)(),b=(0,d.getCurrentSystemUser)();if(!a||!b){window.location.href="/login";return}if(h(a),j(b.role),"admin"===b.role){let a=(0,d.getCurrentUserData)();l(a.projects),n(a.users.length>0?a.users:[{id:"1",name:"John Doe",department:"Engineering"},{id:"2",name:"Jane Smith",department:"Design"},{id:"3",name:"Bob Johnson",department:"Product"}]),p(a.allocations)}else{let a=(0,d.getSystemUsers)().find(a=>"admin"===a.role&&a.isActive);if(a){let b=(0,d.getUserData)(a.email);l(b.projects),n(b.users.length>0?b.users:[{id:"1",name:"John Doe",department:"Engineering"},{id:"2",name:"Jane Smith",department:"Design"},{id:"3",name:"Bob Johnson",department:"Product"}]),p(b.allocations)}}},[]),(0,c.useEffect)(()=>{},[]),(0,c.useEffect)(()=>{B()},[m,o,q,s,u]);let y=(a,b,c)=>Math.round(c/100*((a,b,c=1)=>{let d=new Date(a,b,1),e=new Date(a,b+1,0).getDate(),f=0;for(let a=1;a<=e;a++){d.setDate(a);let b=d.getDay();1===c?b>=1&&b<=5&&f++:b>=0&&b<=4&&f++}return f})(Math.floor(b/12)+2024,b%12,+("mon-fri"===(a.workDays||"mon-fri")))),z=(a,b)=>{if(!a?.endDate)return!1;let c=new Date(a.endDate);if(Number.isNaN(c.getTime()))return!1;let d=c.getMonth();return b>(c.getFullYear()-2024)*12+d},A=(a,b)=>{if(!a?.startDate)return!0;let c=new Date(a.startDate);if(Number.isNaN(c.getTime()))return!0;let d=c.getMonth();return b>=(c.getFullYear()-2024)*12+d},B=()=>{let a=Array.from({length:12},(a,b)=>{let c=new Date(s,q+b,1),d=c.getMonth(),e=c.getFullYear();return{month:d,year:e,globalIndex:(e-2024)*12+d,displayName:`${f[d].slice(0,3).toUpperCase()} ${String(e).slice(-2)}`}});x(m.filter(b=>a.some(a=>A(b,a.globalIndex)&&!z(b,a.globalIndex))).map(b=>{let c=a.map(a=>{if(!A(b,a.globalIndex)||z(b,a.globalIndex))return{month:a.month,year:a.year,unallocated:0,displayName:a.displayName};let c=Math.max(0,100-o.filter(c=>c.userId===b.id&&c.monthIndex===a.globalIndex).reduce((a,b)=>a+(b.percentage||0),0));return{month:a.month,year:a.year,unallocated:c,displayName:a.displayName}});return{user:b,totalUnallocated:c.reduce((a,b)=>a+b.unallocated,0),monthlyBreakdown:c}}).filter(a=>a.totalUnallocated>0).sort((a,b)=>b.totalUnallocated-a.totalUnallocated))},C=Array.from(w.reduce((a,b)=>{let c=b.user.department;return a.has(c)||a.set(c,[]),a.get(c).push(b),a},new Map)).map(([a,b])=>({department:a,users:b.sort((a,b)=>b.totalUnallocated-a.totalUnallocated)})).sort((a,b)=>a.department.localeCompare(b.department));return(0,b.jsxs)("main",{className:"min-h-screen bg-background",children:[(0,b.jsx)("nav",{className:"bg-white border-b border-gray-200 px-6 py-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-6",children:[(0,b.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"Sola"}),(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)(e.default,{href:"/",className:"text-gray-600 hover:text-gray-800 font-medium",children:"Allocation"}),(0,b.jsx)(e.default,{href:"/planning",className:"text-blue-600 hover:text-blue-800 font-medium",children:"Planning"}),(0,b.jsx)(e.default,{href:"/actual-allocation",className:"text-gray-600 hover:text-gray-800 font-medium",children:"Payroll Allocation"}),(0,b.jsx)(e.default,{href:"/expense-allocation",className:"text-gray-600 hover:text-gray-800 font-medium",children:"Expense Allocation"}),(0,b.jsx)(e.default,{href:"/scheduled-records",className:"text-gray-600 hover:text-gray-800 font-medium",children:"Scheduled Records"})]})]})}),(0,b.jsxs)("div",{className:"space-y-4 p-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("h1",{className:"text-xl font-bold",children:"Planning - Unallocated Staff"}),(0,b.jsxs)("div",{className:"flex gap-3 items-end",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"block text-xs font-medium",children:"Start Month"}),(0,b.jsx)("select",{value:q,onChange:a=>r(Number.parseInt(a.target.value)),className:"border rounded px-2 py-1 text-sm",children:f.map((a,c)=>(0,b.jsx)("option",{value:c,children:a},a))})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("label",{className:"block text-xs font-medium",children:"Start Year"}),(0,b.jsx)("select",{value:s,onChange:a=>t(Number.parseInt(a.target.value)),className:"border rounded px-2 py-1 text-sm",children:g.map(a=>(0,b.jsx)("option",{value:a,children:a},a))})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 ml-3",children:[(0,b.jsx)("span",{className:"text-xs text-gray-600",children:"View:"}),(0,b.jsxs)("div",{className:"flex border rounded overflow-hidden",children:[(0,b.jsx)("button",{onClick:()=>v("percentage"),className:`px-2 py-1 text-xs font-medium transition-colors ${"percentage"===u?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:"%"}),(0,b.jsx)("button",{onClick:()=>v("days"),className:`px-2 py-1 text-xs font-medium transition-colors ${"days"===u?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:"Days"})]})]}),(0,b.jsx)("button",{onClick:()=>{let a="",b=["Staff","Department","Total Unallocated",...w[0]?.monthlyBreakdown.map(a=>a.displayName)||[]];a+=b.join(",")+"\n",C.forEach(b=>{b.users.forEach(b=>{let c=[b.user.name,b.user.department,"percentage"===u?`${Math.round(b.totalUnallocated/12)}%`:`${Math.round(y(b.user,12*q+s,b.totalUnallocated/12))} days`,...b.monthlyBreakdown.map(a=>{if("percentage"===u)return`${Math.round(a.unallocated)}%`;{let c=y(b.user,(a.year-2024)*12+a.month,a.unallocated);return`${c} days`}})];a+=c.join(",")+"\n"})});let c=new Blob([a],{type:"text/csv;charset=utf-8;"}),d=document.createElement("a"),e=URL.createObjectURL(c),f=`unallocated-staff-${u}-${new Date().toISOString().split("T")[0]}.csv`;d.setAttribute("href",e),d.setAttribute("download",f),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d)},className:"px-2 py-1 text-xs bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors",children:"Export"})]})]}),0===C.length?(0,b.jsxs)("div",{className:"text-center py-6 text-gray-500",children:[(0,b.jsx)("p",{className:"text-base",children:"No unallocated staff found in the selected time period."}),(0,b.jsx)("p",{className:"text-xs mt-1",children:"All staff members are fully allocated or there are no active staff members."})]}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full border-collapse border border-gray-200",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"bg-gray-100",children:[(0,b.jsx)("th",{className:"border border-gray-200 px-3 py-1.5 text-left text-xs font-semibold text-gray-800 sticky left-0 bg-gray-100 z-10",children:"Staff Name"}),(0,b.jsx)("th",{className:"border border-gray-200 px-3 py-1.5 text-center text-xs font-semibold text-gray-800 sticky left-32 bg-gray-100 z-10 w-32",children:"Total"}),Array.from({length:12},(a,c)=>{let d=new Date(s,q+c,1),e=d.getMonth(),g=d.getFullYear(),h=`${f[e].slice(0,3).toUpperCase()} ${String(g).slice(-2)}`;return(0,b.jsx)("th",{className:"border border-gray-200 px-2 py-1.5 text-center text-xs font-semibold text-gray-800 min-w-20",children:h},c)})]})}),(0,b.jsx)("tbody",{children:C.map(a=>(0,b.jsxs)(c.default.Fragment,{children:[(0,b.jsx)("tr",{className:"bg-gray-50",children:(0,b.jsxs)("td",{colSpan:14,className:"border border-gray-200 px-3 py-1 text-xs font-semibold text-gray-700",children:[a.department," (",a.users.length," staff)"]})}),a.users.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,b.jsx)("td",{className:"border border-gray-200 px-3 py-1 text-xs font-medium sticky left-0 bg-white z-10",children:a.user.name}),(0,b.jsxs)("td",{className:"border border-gray-200 px-3 py-1 text-center text-xs font-medium sticky left-32 bg-white z-10 w-32",children:[(0,b.jsx)("span",{className:"font-medium",children:"percentage"===u?`${Math.round(a.totalUnallocated)}%`:`${Math.round(.3*a.totalUnallocated)}d`}),(0,b.jsxs)("span",{className:"text-[10px] text-gray-500 ml-1",children:["(","percentage"===u?`${Math.round(a.totalUnallocated/12)}% avg`:`${Math.round(y(a.user,12*q+s,a.totalUnallocated/12))}d avg`,")"]})]}),a.monthlyBreakdown.map(c=>(0,b.jsx)("td",{className:`border border-gray-200 px-2 py-1 text-center text-xs font-medium ${0===c.unallocated?"bg-gray-100":c.unallocated<=25?"bg-yellow-100":c.unallocated<=50?"bg-orange-100":c.unallocated<=75?"bg-red-100":"bg-red-200"}`,children:0===c.unallocated?(0,b.jsx)("span",{className:"text-gray-400",children:"-"}):(0,b.jsx)("span",{className:"font-medium",children:"percentage"===u?`${Math.round(c.unallocated)}%`:`${y(a.user,(c.year-2024)*12+c.month,c.unallocated)}d`})},`${c.year}-${c.month}`))]},a.user.id))]},a.department))})]})})]})]})}a.s(["default",()=>h])}];

//# sourceMappingURL=_4f8543ae._.js.map