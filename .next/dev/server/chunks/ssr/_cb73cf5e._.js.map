{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sinan/sola/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\r\nimport { twMerge } from 'tailwind-merge'\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs))\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,oOAAO,EAAC,IAAA,8LAAI,EAAC;AACtB"}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sinan/sola/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\r\nimport { Slot } from '@radix-ui/react-slot'\r\nimport { cva, type VariantProps } from 'class-variance-authority'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nconst buttonVariants = cva(\r\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\r\n        destructive:\r\n          'bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\r\n        outline:\r\n          'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',\r\n        secondary:\r\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\r\n        ghost:\r\n          'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',\r\n        link: 'text-primary underline-offset-4 hover:underline',\r\n      },\r\n      size: {\r\n        default: 'h-9 px-4 py-2 has-[>svg]:px-3',\r\n        sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',\r\n        lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',\r\n        icon: 'size-9',\r\n        'icon-sm': 'size-8',\r\n        'icon-lg': 'size-10',\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: 'default',\r\n      size: 'default',\r\n    },\r\n  },\r\n)\r\n\r\nfunction Button({\r\n  className,\r\n  variant,\r\n  size,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<'button'> &\r\n  VariantProps<typeof buttonVariants> & {\r\n    asChild?: boolean\r\n  }) {\r\n  const Comp = asChild ? Slot : 'button'\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"button\"\r\n      className={cn(buttonVariants({ variant, size, className }))}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Button, buttonVariants }\r\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,kPAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,4SAAI,GAAG;IAE9B,qBACE,6WAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 78, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sinan/sola/components/allocation-cell.tsx"],"sourcesContent":["\"use client\"\r\nimport { useState } from \"react\"\r\n\r\ninterface AllocationCellProps {\r\n  userId: string\r\n  monthIndex: number\r\n  allocations?: any[]\r\n  onEdit?: (id: string) => void\r\n  onSaveEdit?: (id: string, percentage: number) => void\r\n  onRemove?: (id: string) => void\r\n  onEmptyCellClick?: () => void\r\n  project?: any\r\n  projects?: any[]\r\n  users?: any[]\r\n  month?: any\r\n  userEnded?: boolean\r\n  userNotStarted?: boolean\r\n  viewMode?: 'percentage' | 'days'\r\n  getDaysFromPercentage?: (userId: string, monthIndex: number, percentage: number) => number\r\n  readOnly?: boolean\r\n}\r\n\r\nexport function AllocationCell({\r\n  userId,\r\n  monthIndex,\r\n  allocations = [],\r\n  onEdit,\r\n  onSaveEdit,\r\n  onRemove,\r\n  onEmptyCellClick,\r\n  projects = [],\r\n  users = [],\r\n  userEnded = false,\r\n  userNotStarted = false,\r\n  viewMode = 'percentage',\r\n  getDaysFromPercentage,\r\n  readOnly = false,\r\n}: AllocationCellProps) {\r\n  const [isHovering, setIsHovering] = useState(false)\r\n  const [editingId, setEditingId] = useState<string | null>(null)\r\n  const [editValue, setEditValue] = useState(0)\r\n\r\n  // Helper to convert percentage to days based on user work pattern\r\n  const getDaysFromPercentageLocal = (userId: string, monthIndex: number, percentage: number): number => {\r\n    if (getDaysFromPercentage) {\r\n      return getDaysFromPercentage(userId, monthIndex, percentage)\r\n    }\r\n    // Fallback calculation if function not provided\r\n    const year = Math.floor(monthIndex / 12) + 2024\r\n    const month = monthIndex % 12\r\n    \r\n    // Default to mon-fri for now\r\n    const workPattern = 'mon-fri'\r\n    const startDay = workPattern === 'mon-fri' ? 1 : 0\r\n    \r\n    // Calculate working days in month\r\n    const date = new Date(year, month, 1)\r\n    const daysInMonth = new Date(year, month + 1, 0).getDate()\r\n    let workingDays = 0\r\n    \r\n    for (let day = 1; day <= daysInMonth; day++) {\r\n      date.setDate(day)\r\n      const dayOfWeek = date.getDay()\r\n      \r\n      if (startDay === 1) {\r\n        if (dayOfWeek >= 1 && dayOfWeek <= 5) workingDays++\r\n      } else {\r\n        if (dayOfWeek >= 0 && dayOfWeek <= 4) workingDays++\r\n      }\r\n    }\r\n    \r\n    return Math.round((percentage / 100) * workingDays)\r\n  }\r\n\r\n  // Calculate total allocated percentage for this cell\r\n  const totalAllocated = allocations.reduce((sum, a) => sum + (a.percentage || 0), 0)\r\n  const freePercentage = Math.max(0, 100 - totalAllocated)\r\n\r\n  // Determine border class based on allocation level\r\n  const allocationBorderClass =\r\n    totalAllocated === 100\r\n      ? \"border-2 border-green-500\"\r\n      : totalAllocated > 100\r\n      ? \"border-2 border-red-500\"\r\n      : \"\"\r\n\r\n  const handleClick = () => {\r\n    if (freePercentage > 0 && onEmptyCellClick && !userNotStarted) {\r\n      onEmptyCellClick()\r\n    }\r\n  }\r\n\r\n  return (\r\n    <td\r\n      data-user-id={userId}\r\n      data-month={monthIndex}\r\n      className={`w-32 border-r border-b border-border bg-background px-1 py-0.5 min-h-8 transition-colors relative ${\r\n        userEnded || userNotStarted || readOnly\r\n          ? \"cursor-not-allowed bg-gray-50\"\r\n          : freePercentage > 0 && onEmptyCellClick\r\n          ? \"cursor-pointer hover:bg-muted/50\"\r\n          : \"hover:bg-muted/30\"\r\n      }`}\r\n      onMouseEnter={() => !userEnded && !userNotStarted && !readOnly && freePercentage > 0 && setIsHovering(true)}\r\n      onMouseLeave={() => setIsHovering(false)}\r\n      onClick={userEnded || userNotStarted || readOnly ? undefined : handleClick}\r\n    >\r\n      <div className=\"flex flex-col h-full gap-0.5\">\r\n        {/* Allocation bars row */}\r\n        <div className=\"flex items-center flex-1\">\r\n          <div className={`flex w-full h-4 rounded overflow-hidden bg-gray-100 ${allocationBorderClass}`}>\r\n            {userEnded ? (\r\n              <div className=\"w-full h-full flex items-center justify-center text-[8px] font-semibold text-gray-500 bg-gray-200\">\r\n                ended\r\n              </div>\r\n            ) : userNotStarted ? (\r\n              <div className=\"w-full h-full flex items-center justify-center text-[8px] font-semibold text-gray-500 bg-gray-200\">\r\n                not started\r\n              </div>\r\n            ) : (\r\n              allocations.map((allocation) => {\r\n              const project = projects.find((p) => p.id === allocation.projectId)\r\n              console.log(\"[v0] AllocationCell rendering bar:\", {\r\n                allocationId: allocation.id,\r\n                projectId: allocation.projectId,\r\n                projectColor: project?.color,\r\n              })\r\n                // Keep total bar size constant: if allocations exceed 100%,\r\n                // normalize segments so they still fit into a 100% width bar.\r\n                const capacity = totalAllocated > 100 ? totalAllocated : 100\r\n                const width = Math.max(\r\n                  0,\r\n                  Math.min(100, ((allocation.percentage || 0) / capacity) * 100),\r\n                )\r\n\r\n                // Calculate display value based on view mode\r\n                const displayValue = viewMode === 'days' \r\n                  ? Math.round(getDaysFromPercentageLocal(userId, monthIndex, allocation.percentage || 0))\r\n                  : Math.round(allocation.percentage || 0)\r\n\r\n                const displayText = viewMode === 'days' \r\n                  ? `${displayValue} days`\r\n                  : `${displayValue}%`\r\n\r\n                // Calculate days for tooltip (always show days)\r\n                const daysValue = getDaysFromPercentageLocal(userId, monthIndex, allocation.percentage || 0)\r\n\r\n                return (\r\n                  <div\r\n                    key={allocation.id}\r\n                    className={`h-full text-[8px] flex items-center justify-center font-semibold relative ${\r\n                      readOnly ? \"\" : \"group cursor-pointer\"\r\n                    } text-white`}\r\n                    style={{\r\n                      backgroundColor: project?.color || \"#999\",\r\n                      width: `${width}%`,\r\n                      minWidth: width > 0 ? \"8%\" : undefined,\r\n                    }}\r\n                    onClick={(e) => {\r\n                      if (readOnly) return\r\n                      e.stopPropagation()\r\n                      onEdit?.(allocation.id)\r\n                    }}\r\n                    title={`${project?.name ?? \"Project\"} - ${allocation.positionName || allocation.name || \"Position\"} (${displayText})`}\r\n                  >\r\n                    {displayText}\r\n                    {!readOnly && (\r\n                      <button\r\n                        onClick={(e) => {\r\n                          e.stopPropagation()\r\n                          onRemove?.(allocation.id)\r\n                        }}\r\n                        className=\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity\"\r\n                      >\r\n                        √ó\r\n                      </button>\r\n                    )}\r\n                  </div>\r\n                )\r\n              })\r\n            )}\r\n          </div>\r\n          {/* Green tick for 90-100% allocation */}\r\n          {!userEnded && !userNotStarted && totalAllocated >= 90 && totalAllocated <= 100 && allocations.length > 0 && (\r\n            <div className=\"ml-1 flex-shrink-0\">\r\n              <svg className=\"w-4 h-4 text-green-500\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\r\n              </svg>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        \r\n        {!userEnded && !userNotStarted && !readOnly && isHovering && freePercentage > 0 && (\r\n          <div className=\"absolute inset-0 flex items-center justify-center bg-primary/10 rounded text-[9px] text-primary font-medium pointer-events-none\">\r\n            Click to select position\r\n          </div>\r\n        )}\r\n      </div>\r\n    </td>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 266, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sinan/sola/components/project-manager.tsx"],"sourcesContent":["\"use client\"\r\nimport { useState } from \"react\"\r\nimport type { Project, Position } from \"../lib/types\"\r\n\r\ninterface ProjectManagerProps {\r\n  projects: Project[]\r\n  positions: Position[]\r\n  months: string[]\r\n  startMonth?: number\r\n  startYear?: number\r\n  onAddProject: (project: Project) => void\r\n  onUpdateProject: (projectId: string, updates: Partial<Project>) => void\r\n  onDeleteProject: (projectId: string) => void\r\n  onUpdatePositions: (positions: Position[]) => void\r\n  onProjectSelect?: (projectId: string | null) => void\r\n  selectedProjectId?: string | null\r\n  onCleanupAllocations?: (projectId: string, validPositionIds: string[]) => void\r\n  currentUserRole?: 'admin' | 'editor' | 'viewer' | null\r\n}\r\n\r\ninterface PositionBudget {\r\n  id: string\r\n  name: string\r\n  projectTask?: string\r\n  budgets: Record<number, number>\r\n}\r\n\r\nexport function ProjectManager({\r\n  projects,\r\n  positions = [],\r\n  months,\r\n  startMonth = 0,\r\n  startYear = 2024,\r\n  onAddProject,\r\n  onUpdateProject,\r\n  onDeleteProject,\r\n  onUpdatePositions,\r\n  onProjectSelect,\r\n  selectedProjectId,\r\n  onCleanupAllocations,\r\n  currentUserRole,\r\n}: ProjectManagerProps) {\r\n  const [showCreateModal, setShowCreateModal] = useState(false)\r\n  const [editingProjectId, setEditingProjectId] = useState<string | null>(null)\r\n  const [newProjectName, setNewProjectName] = useState(\"\")\r\n  const [selectedColor, setSelectedColor] = useState(\"#3B82F6\")\r\n  const [positionBudgets, setPositionBudgets] = useState<PositionBudget[]>([])\r\n  const [projectStartMonth, setProjectStartMonth] = useState(0)\r\n  const [projectStartYear, setProjectStartYear] = useState(2024)\r\n  const [projectEndMonth, setProjectEndMonth] = useState(0)\r\n  const [projectEndYear, setProjectEndYear] = useState(2024)\r\n  const [monthTablePage, setMonthTablePage] = useState(0)\r\n  const [allocationMode, setAllocationMode] = useState<'percentage' | 'days'>('percentage')\r\n\r\n  // Check if current user can edit projects\r\n  const canEditProjects = currentUserRole === 'admin' || currentUserRole === 'editor'\r\n\r\n  const MONTHS = [\r\n    \"January\",\r\n    \"February\",\r\n    \"March\",\r\n    \"April\",\r\n    \"May\",\r\n    \"June\",\r\n    \"July\",\r\n    \"August\",\r\n    \"September\",\r\n    \"October\",\r\n    \"November\",\r\n    \"December\",\r\n  ]\r\n  const YEARS = Array.from({ length: 10 }, (_, i) => 2024 + i)\r\n\r\n  // Helper to calculate working days in a month\r\n  const getWorkingDaysInMonth = (year: number, month: number, startDay: number = 1): number => {\r\n    const date = new Date(year, month, 1)\r\n    const daysInMonth = new Date(year, month + 1, 0).getDate()\r\n    let workingDays = 0\r\n    \r\n    for (let day = 1; day <= daysInMonth; day++) {\r\n      date.setDate(day)\r\n      const dayOfWeek = date.getDay() // 0 = Sunday, 6 = Saturday\r\n      \r\n      if (startDay === 1) {\r\n        // Monday to Friday (1-5)\r\n        if (dayOfWeek >= 1 && dayOfWeek <= 5) {\r\n          workingDays++\r\n        }\r\n      } else {\r\n        // Sunday to Thursday (0-4)\r\n        if (dayOfWeek >= 0 && dayOfWeek <= 4) {\r\n          workingDays++\r\n        }\r\n      }\r\n    }\r\n    \r\n    return workingDays\r\n  }\r\n\r\n  const COLORS = [\r\n    \"#3B82F6\", // Blue\r\n    \"#10B981\", // Green\r\n    \"#F59E0B\", // Amber\r\n    \"#8B5CF6\", // Purple\r\n    \"#EC4899\", // Pink\r\n    \"#06B6D4\", // Cyan\r\n    \"#EF4444\", // Red\r\n    \"#14B8A6\", // Teal\r\n  ]\r\n\r\n  const toGlobalMonthIndex = (month: number, year: number) => {\r\n    return (year - 2024) * 12 + month\r\n  }\r\n\r\n  const fromGlobalMonthIndex = (globalIndex: number) => {\r\n    return {\r\n      month: globalIndex % 12,\r\n      year: 2024 + Math.floor(globalIndex / 12),\r\n    }\r\n  }\r\n\r\n  const projectDurationMonths = (() => {\r\n    const startIdx = toGlobalMonthIndex(projectStartMonth, projectStartYear)\r\n    const endIdx = toGlobalMonthIndex(projectEndMonth, projectEndYear)\r\n    return Math.max(1, endIdx - startIdx + 1)\r\n  })()\r\n\r\n  const getDisplayMonths = () => {\r\n    const startIdx = toGlobalMonthIndex(projectStartMonth, projectStartYear)\r\n    const endIdx = toGlobalMonthIndex(projectEndMonth, projectEndYear)\r\n    const pageStart = startIdx + monthTablePage * 12\r\n    const pageEnd = Math.min(pageStart + 12, endIdx + 1)\r\n\r\n    const displayMonths = []\r\n    for (let i = pageStart; i < pageEnd; i++) {\r\n      const { month, year } = fromGlobalMonthIndex(i)\r\n      displayMonths.push({\r\n        month,\r\n        year,\r\n        displayName: `${MONTHS[month].slice(0, 3)} ${year.toString().slice(-2)}`,\r\n        globalIndex: i,\r\n      })\r\n    }\r\n    return displayMonths\r\n  }\r\n\r\n  const displayMonths = getDisplayMonths()\r\n  const maxPages = Math.ceil(projectDurationMonths / 12)\r\n\r\n  const handleCreateProject = () => {\r\n    if (!newProjectName.trim()) return\r\n\r\n    console.log('[DEBUG] Creating project with dates:', {\r\n      projectStartMonth,\r\n      projectStartYear,\r\n      projectEndMonth,\r\n      projectEndYear\r\n    })\r\n\r\n    const newProject: Project = {\r\n      id: `proj-${Date.now()}`,\r\n      name: newProjectName,\r\n      color: selectedColor,\r\n      startMonth: projectStartMonth,\r\n      startYear: projectStartYear,\r\n      endMonth: projectEndMonth,\r\n      endYear: projectEndYear,\r\n      allocationMode,\r\n    }\r\n\r\n    console.log('[DEBUG] Project object being created:', newProject)\r\n\r\n    onAddProject(newProject)\r\n\r\n    const newPositions: Position[] = []\r\n    const startIdx = toGlobalMonthIndex(projectStartMonth, projectStartYear)\r\n    const endIdx = toGlobalMonthIndex(projectEndMonth, projectEndYear)\r\n\r\n    positionBudgets.forEach((positionBudget) => {\r\n      displayMonths.forEach((displayMonth, displayIdx) => {\r\n        const percentage = positionBudget.budgets[displayMonth.globalIndex] || 0\r\n        if (percentage > 0) {\r\n          const position: Position = {\r\n            id: `pos-${newProject.id}-${positionBudget.id}-${displayMonth.globalIndex}`,\r\n            projectId: newProject.id,\r\n            monthIndex: displayMonth.globalIndex,\r\n            percentage: allocationMode === 'days' ? (percentage / getWorkingDaysInMonth(displayMonth.year, displayMonth.month, 1)) * 100 : percentage,\r\n            allocated: 0,\r\n            name: positionBudget.name,\r\n            projectTask: positionBudget.projectTask,\r\n            days: allocationMode === 'days' ? percentage : undefined,\r\n          }\r\n          newPositions.push(position)\r\n        }\r\n      })\r\n    })\r\n\r\n    if (newPositions.length > 0) {\r\n      onUpdatePositions([...positions, ...newPositions])\r\n    }\r\n\r\n    setNewProjectName(\"\")\r\n    setSelectedColor(\"#3B82F6\")\r\n    setPositionBudgets([])\r\n    setProjectStartMonth(0)\r\n    setProjectStartYear(2024)\r\n    setProjectEndMonth(0)\r\n    setProjectEndYear(2024)\r\n    setMonthTablePage(0)\r\n    setAllocationMode('percentage')\r\n    setShowCreateModal(false)\r\n  }\r\n\r\n  const handleEditProject = (projectId: string) => {\r\n    setEditingProjectId(projectId)\r\n    const project = projects.find((p) => p.id === projectId)\r\n    if (project) {\r\n      setNewProjectName(project.name)\r\n      setSelectedColor(project.color)\r\n      setProjectStartMonth(project.startMonth ?? 0)\r\n      setProjectStartYear(project.startYear ?? 2024)\r\n      setProjectEndMonth(project.endMonth ?? 0)\r\n      setProjectEndYear(project.endYear ?? 2024)\r\n      setAllocationMode(project.allocationMode ?? 'percentage')\r\n      setMonthTablePage(0)\r\n\r\n      const projectPositions = positions.filter((p) => p.projectId === projectId)\r\n      const positionMap = new Map<string, PositionBudget>()\r\n\r\n      projectPositions.forEach((p) => {\r\n        const name = p.name || \"Unnamed Position\"\r\n        if (!positionMap.has(name)) {\r\n          positionMap.set(name, {\r\n            id: `${name}-${Date.now()}`,\r\n            name,\r\n            projectTask: p.projectTask,\r\n            budgets: {},\r\n          })\r\n        }\r\n        const pos = positionMap.get(name)!\r\n        // Use days if available, otherwise use percentage\r\n        const value = project.allocationMode === 'days' && p.days ? p.days : p.percentage\r\n        pos.budgets[p.monthIndex] = value\r\n      })\r\n\r\n      setPositionBudgets(Array.from(positionMap.values()))\r\n    }\r\n  }\r\n\r\n  const handleSaveEditProject = () => {\r\n    if (!editingProjectId || !newProjectName.trim()) return\r\n\r\n    const projectId = editingProjectId // Store before clearing state\r\n\r\n    console.log(\"[v0] Saving project with dates:\", {\r\n      projectId,\r\n      startMonth: projectStartMonth,\r\n      startYear: projectStartYear,\r\n      endMonth: projectEndMonth,\r\n      endYear: projectEndYear,\r\n    })\r\n\r\n    console.log(\"[v0] Saving project with color:\", {\r\n      projectId,\r\n      selectedColor,\r\n    })\r\n\r\n    console.log(\"[v0] About to call onUpdateProject with:\", {\r\n      projectId,\r\n      name: newProjectName,\r\n      color: selectedColor,\r\n      startMonth: projectStartMonth,\r\n      startYear: projectStartYear,\r\n      endMonth: projectEndMonth,\r\n      endYear: projectEndYear,\r\n    })\r\n\r\n    // Update positions BEFORE updating the project to avoid triggering another project update\r\n    const existingPositions = positions.filter((p) => p.projectId === projectId)\r\n    const newPositions: Position[] = []\r\n\r\n    positionBudgets.forEach((positionBudget) => {\r\n      displayMonths.forEach((displayMonth) => {\r\n        const value = positionBudget.budgets[displayMonth.globalIndex] || 0\r\n        if (value > 0) {\r\n          const existingPos = existingPositions.find(\r\n            (p) => p.monthIndex === displayMonth.globalIndex && p.name === positionBudget.name,\r\n          )\r\n          const project = projects.find((p) => p.id === projectId)\r\n          const mode = project?.allocationMode || 'percentage'\r\n          \r\n          const position: Position = {\r\n            id: existingPos?.id || `pos-${projectId}-${positionBudget.id}-${displayMonth.globalIndex}`,\r\n            projectId,\r\n            monthIndex: displayMonth.globalIndex,\r\n            percentage: mode === 'days' ? (value / getWorkingDaysInMonth(displayMonth.year, displayMonth.month, 1)) * 100 : value,\r\n            allocated: existingPos?.allocated || 0,\r\n            name: positionBudget.name,\r\n            projectTask: positionBudget.projectTask,\r\n            days: mode === 'days' ? value : undefined,\r\n          }\r\n          newPositions.push(position)\r\n        }\r\n      })\r\n    })\r\n\r\n    const otherPositions = positions.filter((p) => p.projectId !== projectId)\r\n    onUpdatePositions([...otherPositions, ...newPositions])\r\n\r\n    // Clean up allocations for removed positions\r\n    if (onCleanupAllocations) {\r\n      const validPositionIds = newPositions.map(p => p.id)\r\n      onCleanupAllocations(projectId, validPositionIds)\r\n    }\r\n\r\n    // Now update the project\r\n    onUpdateProject(projectId, {\r\n      name: newProjectName,\r\n      color: selectedColor,\r\n      startMonth: projectStartMonth,\r\n      startYear: projectStartYear,\r\n      endMonth: projectEndMonth,\r\n      endYear: projectEndYear,\r\n      allocationMode,\r\n    })\r\n\r\n    // Close the edit modal immediately so the project list re-renders with the new color\r\n    setEditingProjectId(null)\r\n\r\n    setNewProjectName(\"\")\r\n    setSelectedColor(\"#3B82F6\")\r\n    setPositionBudgets([])\r\n    setProjectStartMonth(0)\r\n    setProjectStartYear(2024)\r\n    setProjectEndMonth(0)\r\n    setProjectEndYear(2024)\r\n    setMonthTablePage(0)\r\n    setAllocationMode('percentage')\r\n  }\r\n\r\n  const handleAddPositionLine = () => {\r\n    setPositionBudgets([\r\n      ...positionBudgets,\r\n      {\r\n        id: `pos-${Date.now()}`,\r\n        name: \"New Position\",\r\n        budgets: {},\r\n      },\r\n    ])\r\n  }\r\n\r\n  const handleDeletePositionLine = (id: string) => {\r\n    setPositionBudgets(positionBudgets.filter((p) => p.id !== id))\r\n  }\r\n\r\n  const handleUpdatePositionName = (id: string, name: string) => {\r\n    setPositionBudgets(positionBudgets.map((p) => (p.id === id ? { ...p, name } : p)))\r\n  }\r\n\r\n  const handleUpdateProjectTask = (id: string, projectTask: string) => {\r\n    setPositionBudgets(positionBudgets.map((p) => (p.id === id ? { ...p, projectTask } : p)))\r\n  }\r\n\r\n  const handleUpdatePositionBudget = (id: string, globalMonthIndex: number, value: number) => {\r\n    setPositionBudgets(\r\n      positionBudgets.map((p) => (p.id === id ? { ...p, budgets: { ...p.budgets, [globalMonthIndex]: value } } : p)),\r\n    )\r\n  }\r\n\r\n  const exportPositionsToExcel = () => {\r\n    if (positionBudgets.length === 0) {\r\n      alert(\"No positions to export\")\r\n      return\r\n    }\r\n\r\n    let csvContent = \"\"\r\n    \r\n    // Create header row with project task, position name and all months\r\n    const headerRow = [\"Project Task\", \"Position Name\", ...displayMonths.map(m => m.displayName)]\r\n    csvContent += headerRow.join(\",\") + \"\\n\"\r\n    \r\n    // Add data rows for each position (only include positions with names)\r\n    positionBudgets\r\n      .filter(p => p.name.trim() !== \"\")\r\n      .forEach(position => {\r\n        const row = [position.projectTask || \"\", position.name]\r\n        displayMonths.forEach(month => {\r\n          const value = position.budgets[month.globalIndex] || 0\r\n          row.push(value.toString())\r\n        })\r\n        csvContent += row.join(\",\") + \"\\n\"\r\n      })\r\n    \r\n    // Create and download the file\r\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' })\r\n    const link = document.createElement('a')\r\n    const url = URL.createObjectURL(blob)\r\n    \r\n    const projectName = newProjectName || \"Project\"\r\n    const fileName = `${projectName}-positions-${allocationMode}-${new Date().toISOString().split('T')[0]}.csv`\r\n    link.setAttribute('href', url)\r\n    link.setAttribute('download', fileName)\r\n    link.style.visibility = 'hidden'\r\n    document.body.appendChild(link)\r\n    link.click()\r\n    document.body.removeChild(link)\r\n  }\r\n\r\n  const importPositionsFromExcel = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = event.target.files?.[0]\r\n    if (!file) return\r\n\r\n    const reader = new FileReader()\r\n    reader.onload = (e) => {\r\n      try {\r\n        const text = e.target?.result as string\r\n        const lines = text.split('\\n').filter(line => line.trim())\r\n        \r\n        if (lines.length < 2) {\r\n          alert(\"File must contain at least a header row and one data row\")\r\n          return\r\n        }\r\n\r\n        // Parse header row to get months\r\n        const headers = lines[0].split(',').map(h => h.trim())\r\n        const monthHeaders = headers.slice(2) // Remove \"Project Task\" and \"Position Name\"\r\n        \r\n        // Parse data rows\r\n        const importedPositions: PositionBudget[] = []\r\n        \r\n        for (let i = 1; i < lines.length; i++) {\r\n          const values = lines[i].split(',').map(v => v.trim())\r\n          if (values.length < 3 || !values[1]) continue // Skip empty rows\r\n          \r\n          const projectTask = values[0]\r\n          const positionName = values[1]\r\n          const budgets: Record<number, number> = {}\r\n          \r\n          // Map values to months\r\n          values.slice(2).forEach((value, index) => {\r\n            if (index < displayMonths.length) {\r\n              const numValue = parseFloat(value) || 0\r\n              budgets[displayMonths[index].globalIndex] = numValue\r\n            }\r\n          })\r\n          \r\n          importedPositions.push({\r\n            id: `imported-${positionName}-${Date.now()}-${i}`,\r\n            name: positionName,\r\n            projectTask,\r\n            budgets\r\n          })\r\n        }\r\n        \r\n        if (importedPositions.length > 0) {\r\n          if (positionBudgets.some(p => p.name.trim() !== \"\")) {\r\n            const confirmReplace = confirm(\r\n              `Import will replace existing positions with ${importedPositions.length} imported positions. Continue?`\r\n            )\r\n            if (!confirmReplace) return\r\n          }\r\n          \r\n          // Update the positionBudgets state for the table display\r\n          setPositionBudgets(importedPositions)\r\n          \r\n          alert(`Successfully imported ${importedPositions.length} positions`)\r\n        } else {\r\n          alert(\"No valid position data found in file\")\r\n        }\r\n      } catch (error) {\r\n        console.error('Import error:', error)\r\n        alert(\"Error importing file. Please check the file format and try again.\")\r\n      }\r\n    }\r\n    \r\n    reader.onerror = () => {\r\n      alert(\"Error reading file\")\r\n    }\r\n    \r\n    reader.readAsText(file)\r\n    \r\n    // Reset the file input\r\n    if (event.target) {\r\n      event.target.value = ''\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex flex-wrap gap-4 items-center\">\r\n        {projects.map((project) => {\r\n          // Determine if text should be white or black based on background color brightness\r\n          const getContrastColor = (hex: string) => {\r\n            const r = parseInt(hex.slice(1, 3), 16)\r\n            const g = parseInt(hex.slice(3, 5), 16)\r\n            const b = parseInt(hex.slice(5, 7), 16)\r\n            const brightness = (r * 299 + g * 587 + b * 114) / 1000\r\n            return brightness > 128 ? \"#000\" : \"#fff\"\r\n          }\r\n          const textColor = getContrastColor(project.color)\r\n          \r\n          return (\r\n            <div\r\n              key={project.id}\r\n              className={`flex items-center justify-between px-3 py-1.5 rounded border border-border cursor-pointer hover:opacity-80 transition-opacity w-32 h-8 ${\r\n                selectedProjectId === project.id ? 'ring-2 ring-offset-2 ring-blue-500' : ''\r\n              }`}\r\n              style={{ backgroundColor: project.color, color: textColor }}\r\n              onClick={() => {\r\n                if (onProjectSelect) {\r\n                  onProjectSelect(selectedProjectId === project.id ? null : project.id)\r\n                }\r\n              }}\r\n            >\r\n              <span className=\"text-xs font-medium truncate flex-1\">{project.name}</span>\r\n              {canEditProjects && (\r\n                <button\r\n                  onClick={(e) => {\r\n                    e.stopPropagation()\r\n                    handleEditProject(project.id)\r\n                  }}\r\n                  className=\"px-1.5 py-0.5 text-[10px] bg-white/20 rounded hover:bg-white/30 transition-colors flex-shrink-0\"\r\n                  style={{ color: textColor }}\r\n                >\r\n                  Edit\r\n                </button>\r\n              )}\r\n            </div>\r\n          )\r\n        })}\r\n        {canEditProjects && (\r\n          <button\r\n            onClick={() => setShowCreateModal(true)}\r\n            className=\"px-4 py-2 bg-primary text-primary-foreground rounded font-medium hover:bg-primary/90 transition-colors text-sm\"\r\n          >\r\n            + New Project\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      {(showCreateModal || editingProjectId) && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-card p-6 rounded-lg border border-border shadow-lg w-full h-full mx-4 overflow-y-auto\">\r\n            <h2 className=\"text-lg font-semibold text-foreground mb-4\">\r\n              {editingProjectId ? \"Edit Project\" : \"Create New Project\"}\r\n            </h2>\r\n\r\n            <div className=\"mb-6 grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div>\r\n                <label className=\"text-xs font-medium text-muted-foreground mb-2 block\">Project Name</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={newProjectName}\r\n                  onChange={(e) => setNewProjectName(e.target.value)}\r\n                  className=\"w-full px-3 py-2 border border-border rounded text-foreground bg-card\"\r\n                  placeholder=\"Enter project name\"\r\n                  disabled={!canEditProjects}\r\n                  autoFocus\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"text-xs font-medium text-muted-foreground mb-2 block\">Project Color</label>\r\n                <div className=\"flex gap-2 flex-wrap\">\r\n                  {COLORS.map((color) => (\r\n                    <button\r\n                      key={color}\r\n                      onClick={() => {\r\n                        console.log(\"[v0] Color picker clicked, setting color to:\", color)\r\n                        setSelectedColor(color)\r\n                      }}\r\n                      className={`w-8 h-8 rounded transition-all ${selectedColor === color ? \"ring-2 ring-offset-2 ring-primary\" : \"hover:opacity-80\"}`}\r\n                      style={{ backgroundColor: color }}\r\n                      title={color}\r\n                    />\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"mb-6\">\r\n              <label className=\"text-xs font-medium text-muted-foreground mb-2 block\">Allocation Mode</label>\r\n              <div className=\"flex gap-4\">\r\n                <label className=\"flex items-center gap-2 cursor-pointer\">\r\n                  <input\r\n                    type=\"radio\"\r\n                    name=\"allocationMode\"\r\n                    value=\"percentage\"\r\n                    checked={allocationMode === 'percentage'}\r\n                    onChange={(e) => setAllocationMode('percentage')}\r\n                    className=\"text-primary\"\r\n                    disabled={!canEditProjects}\r\n                  />\r\n                  <span className=\"text-sm\">% Allocation</span>\r\n                </label>\r\n                <label className=\"flex items-center gap-2 cursor-pointer\">\r\n                  <input\r\n                    type=\"radio\"\r\n                    name=\"allocationMode\"\r\n                    value=\"days\"\r\n                    checked={allocationMode === 'days'}\r\n                    onChange={(e) => setAllocationMode('days')}\r\n                    className=\"text-primary\"\r\n                    disabled={!canEditProjects}\r\n                  />\r\n                  <span className=\"text-sm\">Day Allocation</span>\r\n                </label>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"mb-6 grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n              <div>\r\n                <label className=\"text-xs font-medium text-muted-foreground mb-2 block\">Start Month</label>\r\n                <select\r\n                  value={projectStartMonth}\r\n                  onChange={(e) => setProjectStartMonth(Number(e.target.value))}\r\n                  className=\"border border-border rounded px-3 py-2 w-full text-sm bg-background text-foreground\"\r\n                  disabled={!canEditProjects}\r\n                >\r\n                  {MONTHS.map((month, idx) => (\r\n                    <option key={idx} value={idx}>\r\n                      {month}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"text-xs font-medium text-muted-foreground mb-2 block\">Start Year</label>\r\n                <select\r\n                  value={projectStartYear}\r\n                  onChange={(e) => setProjectStartYear(Number(e.target.value))}\r\n                  className=\"border border-border rounded px-3 py-2 w-full text-sm bg-background text-foreground\"\r\n                  disabled={!canEditProjects}\r\n                >\r\n                  {YEARS.map((year) => (\r\n                    <option key={year} value={year}>\r\n                      {year}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"text-xs font-medium text-muted-foreground mb-2 block\">End Month</label>\r\n                <select\r\n                  value={projectEndMonth}\r\n                  onChange={(e) => setProjectEndMonth(Number(e.target.value))}\r\n                  className=\"border border-border rounded px-3 py-2 w-full text-sm bg-background text-foreground\"\r\n                  disabled={!canEditProjects}\r\n                >\r\n                  {MONTHS.map((month, idx) => (\r\n                    <option key={idx} value={idx}>\r\n                      {month}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"text-xs font-medium text-muted-foreground mb-2 block\">End Year</label>\r\n                <select\r\n                  value={projectEndYear}\r\n                  onChange={(e) => setProjectEndYear(Number(e.target.value))}\r\n                  className=\"border border-border rounded px-3 py-2 w-full text-sm bg-background text-foreground\"\r\n                  disabled={!canEditProjects}\r\n                >\r\n                  {YEARS.map((year) => (\r\n                    <option key={year} value={year}>\r\n                      {year}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"mb-6\">\r\n              <div className=\"flex justify-between items-center mb-2\">\r\n                <label className=\"text-xs font-medium text-muted-foreground\">\r\n                  Positions by Month ({allocationMode === 'days' ? 'Days' : '%'}) - Page {monthTablePage + 1} of {maxPages}\r\n                </label>\r\n                <div className=\"flex gap-2 items-center\">\r\n                  <button\r\n                    onClick={() => setMonthTablePage(Math.max(0, monthTablePage - 1))}\r\n                    disabled={monthTablePage === 0}\r\n                    className=\"px-3 py-1 text-xs bg-primary text-primary-foreground rounded hover:bg-primary/90 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                  >\r\n                    ‚Üê Prev 12\r\n                  </button>\r\n                  <button\r\n                    onClick={() => setMonthTablePage(Math.min(maxPages - 1, monthTablePage + 1))}\r\n                    disabled={monthTablePage >= maxPages - 1}\r\n                    className=\"px-3 py-1 text-xs bg-primary text-primary-foreground rounded hover:bg-primary/90 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                  >\r\n                    Next 12 ‚Üí\r\n                  </button>\r\n                  <button\r\n                    onClick={handleAddPositionLine}\r\n                    className=\"px-3 py-1 text-xs bg-primary text-primary-foreground rounded hover:bg-primary/90 transition-colors\"\r\n                    disabled={!canEditProjects}\r\n                  >\r\n                    + Add Position\r\n                  </button>\r\n                  <button\r\n                    onClick={exportPositionsToExcel}\r\n                    className=\"px-3 py-1 text-xs bg-green-600 text-white rounded hover:bg-green-700 transition-colors\"\r\n                    title=\"Export positions to Excel\"\r\n                  >\r\n                    üì• Export\r\n                  </button>\r\n                  <button\r\n                    onClick={() => document.getElementById('excel-import-input')?.click()}\r\n                    className=\"px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors\"\r\n                    title=\"Import positions from Excel\"\r\n                    disabled={!canEditProjects}\r\n                  >\r\n                    üì§ Import\r\n                  </button>\r\n                  <input\r\n                    id=\"excel-import-input\"\r\n                    type=\"file\"\r\n                    accept=\".xlsx,.xls,.csv\"\r\n                    onChange={importPositionsFromExcel}\r\n                    style={{ display: 'none' }}\r\n                    disabled={!canEditProjects}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"border border-border rounded overflow-x-auto\">\r\n                <table className=\"w-full text-[10px]\">\r\n                  <thead className=\"bg-muted border-b border-border\">\r\n                    <tr>\r\n                      <th className=\"px-4 py-2 text-left font-semibold text-muted-foreground min-w-20\">\r\n                        Project Task\r\n                      </th>\r\n                      <th className=\"px-4 py-2 text-left font-semibold text-muted-foreground min-w-40\">\r\n                        Position Name\r\n                      </th>\r\n                      {displayMonths.map((displayMonth) => (\r\n                        <th\r\n                          key={displayMonth.globalIndex}\r\n                          className=\"px-4 py-2 text-center font-semibold text-muted-foreground min-w-20\"\r\n                        >\r\n                          {displayMonth.displayName}\r\n                        </th>\r\n                      ))}\r\n                      <th className=\"px-4 py-2 text-center font-semibold text-muted-foreground w-10\">Action</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {positionBudgets.length === 0 ? (\r\n                      <tr>\r\n                        <td colSpan={displayMonths.length + 3} className=\"px-4 py-8 text-center text-muted-foreground\">\r\n                          No positions yet. Click \"Add Position\" to create one.\r\n                        </td>\r\n                      </tr>\r\n                    ) : (\r\n                      positionBudgets.map((positionBudget) => (\r\n                        <tr key={positionBudget.id} className=\"border-t border-border hover:bg-muted/50\">\r\n                          <td className=\"px-4 py-2 border-r border-border\">\r\n                            <input\r\n                              type=\"text\"\r\n                              value={positionBudget.projectTask || \"\"}\r\n                              onChange={(e) => handleUpdateProjectTask(positionBudget.id, e.target.value)}\r\n                              className=\"w-full px-2 py-1 border border-border rounded text-foreground bg-card\"\r\n                              placeholder=\"e.g., 01.03.01\"\r\n                              disabled={!canEditProjects}\r\n                            />\r\n                          </td>\r\n                          <td className=\"px-4 py-2 border-r border-border\">\r\n                            <input\r\n                              type=\"text\"\r\n                              value={positionBudget.name}\r\n                              onChange={(e) => handleUpdatePositionName(positionBudget.id, e.target.value)}\r\n                              className=\"w-full px-2 py-1 border border-border rounded text-foreground bg-card\"\r\n                              placeholder=\"e.g., Senior Developer\"\r\n                              disabled={!canEditProjects}\r\n                            />\r\n                          </td>\r\n                          {displayMonths.map((displayMonth) => (\r\n                            <td\r\n                              key={displayMonth.globalIndex}\r\n                              className=\"px-4 py-2 border-r border-border last:border-r-0 bg-background\"\r\n                            >\r\n                              <input\r\n                                type=\"number\"\r\n                                min=\"0\"\r\n                                max={allocationMode === 'days' ? getWorkingDaysInMonth(displayMonth.year, displayMonth.month, 1) : 999}\r\n                                value={positionBudget.budgets[displayMonth.globalIndex] || \"\"}\r\n                                onChange={(e) =>\r\n                                  handleUpdatePositionBudget(\r\n                                    positionBudget.id,\r\n                                    displayMonth.globalIndex,\r\n                                    e.target.value ? Number(e.target.value) : 0,\r\n                                  )\r\n                                }\r\n                                className=\"w-full px-2 py-1 text-center border border-border rounded text-foreground bg-card\"\r\n                                placeholder={allocationMode === 'days' ? `0-${getWorkingDaysInMonth(displayMonth.year, displayMonth.month, 1)} days` : \"0%\"}\r\n                                disabled={!canEditProjects}\r\n                              />\r\n                            </td>\r\n                          ))}\r\n                          <td className=\"px-4 py-2 text-center\">\r\n                            <button\r\n                              onClick={() => handleDeletePositionLine(positionBudget.id)}\r\n                              className=\"px-2 py-1 text-xs bg-destructive text-destructive-foreground rounded hover:bg-destructive/90 transition-colors\"\r\n                              disabled={!canEditProjects}\r\n                            >\r\n                              ‚úï\r\n                            </button>\r\n                          </td>\r\n                        </tr>\r\n                      ))\r\n                    )}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex gap-2 justify-end\">\r\n              <button\r\n                onClick={() => {\r\n                  setShowCreateModal(false)\r\n                  setEditingProjectId(null)\r\n                  setNewProjectName(\"\")\r\n                  setSelectedColor(\"#3B82F6\")\r\n                  setPositionBudgets([])\r\n                  setProjectStartMonth(0)\r\n                  setProjectStartYear(2024)\r\n                  setProjectEndMonth(0)\r\n                  setProjectEndYear(2024)\r\n                  setMonthTablePage(0)\r\n                  setAllocationMode('percentage')\r\n                }}\r\n                className=\"px-4 py-2 bg-muted text-muted-foreground rounded font-medium hover:bg-muted/80 transition-colors text-sm\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              {editingProjectId && (\r\n                <button\r\n                  onClick={() => {\r\n                    if (\r\n                      window.confirm(\"Are you sure you want to delete this project? All positions will be removed.\")\r\n                    ) {\r\n                      onDeleteProject(editingProjectId)\r\n                      setEditingProjectId(null)\r\n                      setNewProjectName(\"\")\r\n                      setSelectedColor(\"#3B82F6\")\r\n                      setPositionBudgets([])\r\n                      setProjectStartMonth(0)\r\n                      setProjectStartYear(2024)\r\n                      setProjectEndMonth(0)\r\n                      setProjectEndYear(2024)\r\n                      setMonthTablePage(0)\r\n                      setAllocationMode('percentage')\r\n                    }\r\n                  }}\r\n                  className=\"px-4 py-2 bg-destructive text-black rounded font-medium hover:bg-destructive/90 transition-colors text-sm\"\r\n                >\r\n                  Delete Project\r\n                </button>\r\n              )}\r\n              <button\r\n                onClick={editingProjectId ? handleSaveEditProject : handleCreateProject}\r\n                className=\"px-4 py-2 bg-primary text-primary-foreground rounded font-medium hover:bg-primary/90 transition-colors text-sm\"\r\n                disabled={!canEditProjects}\r\n              >\r\n                {editingProjectId ? \"Save Changes\" : \"Create Project\"}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1434, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sinan/sola/lib/storage.ts"],"sourcesContent":["// User-specific storage utilities\r\nexport interface UserData {\r\n  projects: any[]\r\n  users: any[]\r\n  allocations: any[]\r\n  positions: any[]\r\n  entities: any[]\r\n  startMonth?: number\r\n  startYear?: number\r\n  systemUsers?: SystemUser[] // Global system users (for login)\r\n}\r\n\r\nexport interface SystemUser {\r\n  id: string\r\n  email: string\r\n  name: string\r\n  password: string\r\n  role: 'admin' | 'editor' | 'viewer' | 'senior'\r\n  isActive: boolean\r\n  createdAt: string\r\n}\r\n\r\nconst STORAGE_KEYS = {\r\n  CURRENT_USER: \"sola-current-user\",\r\n  USER_DATA_PREFIX: \"sola-user-data-\",\r\n  SYSTEM_USERS: \"sola-system-users\", // Global user registry\r\n} as const\r\n\r\nexport function getSystemUsers(): SystemUser[] {\r\n  if (typeof window === 'undefined') return []\r\n  const data = localStorage.getItem(STORAGE_KEYS.SYSTEM_USERS)\r\n  return data ? JSON.parse(data) : []\r\n}\r\n\r\nexport function setSystemUsers(users: SystemUser[]): void {\r\n  if (typeof window === 'undefined') return\r\n  localStorage.setItem(STORAGE_KEYS.SYSTEM_USERS, JSON.stringify(users))\r\n}\r\n\r\nexport function addSystemUser(user: Omit<SystemUser, 'id' | 'createdAt'>): SystemUser {\r\n  const users = getSystemUsers()\r\n  const newUser: SystemUser = {\r\n    ...user,\r\n    id: `system-user-${Date.now()}`,\r\n    createdAt: new Date().toISOString(),\r\n  }\r\n  setSystemUsers([...users, newUser])\r\n  return newUser\r\n}\r\n\r\nexport function updateSystemUser(id: string, updates: Partial<SystemUser>): void {\r\n  const users = getSystemUsers()\r\n  const updated = users.map(u => u.id === id ? { ...u, ...updates } : u)\r\n  setSystemUsers(updated)\r\n}\r\n\r\nexport function deleteSystemUser(id: string): void {\r\n  const users = getSystemUsers()\r\n  setSystemUsers(users.filter(u => u.id !== id))\r\n}\r\n\r\nexport function authenticateUser(email: string, password: string): SystemUser | null {\r\n  const users = getSystemUsers()\r\n  return users.find(u => u.email === email && u.password === password && u.isActive) || null\r\n}\r\n\r\nexport function getCurrentUser(): string | null {\r\n  if (typeof window === 'undefined') return null\r\n  return localStorage.getItem(STORAGE_KEYS.CURRENT_USER)\r\n}\r\n\r\nexport function getCurrentSystemUser(): SystemUser | null {\r\n  const email = getCurrentUser()\r\n  if (!email) return null\r\n  const users = getSystemUsers()\r\n  return users.find(u => u.email === email) || null\r\n}\r\n\r\nexport function setCurrentUser(email: string): void {\r\n  if (typeof window === 'undefined') return\r\n  localStorage.setItem(STORAGE_KEYS.CURRENT_USER, email)\r\n}\r\n\r\nexport function clearCurrentUser(): void {\r\n  if (typeof window === 'undefined') return\r\n  localStorage.removeItem(STORAGE_KEYS.CURRENT_USER)\r\n}\r\n\r\nexport function getUserData(email: string): UserData {\r\n  if (typeof window === 'undefined') return { projects: [], users: [], allocations: [], positions: [], entities: [] }\r\n  \r\n  const data = localStorage.getItem(STORAGE_KEYS.USER_DATA_PREFIX + email)\r\n  return data ? JSON.parse(data) : { projects: [], users: [], allocations: [], positions: [], entities: [] }\r\n}\r\n\r\nexport function setUserData(email: string, data: Partial<UserData>): void {\r\n  if (typeof window === 'undefined') return\r\n  \r\n  const existing = getUserData(email)\r\n  const updated = { ...existing, ...data }\r\n  localStorage.setItem(STORAGE_KEYS.USER_DATA_PREFIX + email, JSON.stringify(updated))\r\n}\r\n\r\nexport function clearUserData(email: string): void {\r\n  if (typeof window === 'undefined') return\r\n  localStorage.removeItem(STORAGE_KEYS.USER_DATA_PREFIX + email)\r\n}\r\n\r\n// Convenience functions that work with the current user\r\nexport function getCurrentUserData(): UserData {\r\n  const currentUser = getCurrentUser()\r\n  if (!currentUser) return { projects: [], users: [], allocations: [], positions: [], entities: [] }\r\n  return getUserData(currentUser)\r\n}\r\n\r\nexport function setCurrentUserData(data: Partial<UserData>): void {\r\n  const currentUser = getCurrentUser()\r\n  if (!currentUser) return\r\n  setUserData(currentUser, data)\r\n}\r\n"],"names":[],"mappings":"AAAA,kCAAkC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsBlC,MAAM,eAAe;IACnB,cAAc;IACd,kBAAkB;IAClB,cAAc;AAChB;AAEO,SAAS;IACd,wCAAmC,OAAO,EAAE;;;IAC5C,MAAM;AAER;AAEO,SAAS,eAAe,KAAmB;IAChD,wCAAmC;;;AAErC;AAEO,SAAS,cAAc,IAA0C;IACtE,MAAM,QAAQ;IACd,MAAM,UAAsB;QAC1B,GAAG,IAAI;QACP,IAAI,CAAC,YAAY,EAAE,KAAK,GAAG,IAAI;QAC/B,WAAW,IAAI,OAAO,WAAW;IACnC;IACA,eAAe;WAAI;QAAO;KAAQ;IAClC,OAAO;AACT;AAEO,SAAS,iBAAiB,EAAU,EAAE,OAA4B;IACvE,MAAM,QAAQ;IACd,MAAM,UAAU,MAAM,GAAG,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,KAAK;YAAE,GAAG,CAAC;YAAE,GAAG,OAAO;QAAC,IAAI;IACpE,eAAe;AACjB;AAEO,SAAS,iBAAiB,EAAU;IACzC,MAAM,QAAQ;IACd,eAAe,MAAM,MAAM,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;AAC5C;AAEO,SAAS,iBAAiB,KAAa,EAAE,QAAgB;IAC9D,MAAM,QAAQ;IACd,OAAO,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,KAAK,KAAK,SAAS,EAAE,QAAQ,KAAK,YAAY,EAAE,QAAQ,KAAK;AACxF;AAEO,SAAS;IACd,wCAAmC,OAAO;;;AAE5C;AAEO,SAAS;IACd,MAAM,QAAQ;IACd,IAAI,CAAC,OAAO,OAAO;IACnB,MAAM,QAAQ;IACd,OAAO,MAAM,IAAI,CAAC,CAAA,IAAK,EAAE,KAAK,KAAK,UAAU;AAC/C;AAEO,SAAS,eAAe,KAAa;IAC1C,wCAAmC;;;AAErC;AAEO,SAAS;IACd,wCAAmC;;;AAErC;AAEO,SAAS,YAAY,KAAa;IACvC,wCAAmC,OAAO;QAAE,UAAU,EAAE;QAAE,OAAO,EAAE;QAAE,aAAa,EAAE;QAAE,WAAW,EAAE;QAAE,UAAU,EAAE;IAAC;;;IAElH,MAAM;AAER;AAEO,SAAS,YAAY,KAAa,EAAE,IAAuB;IAChE,wCAAmC;;;IAEnC,MAAM;IACN,MAAM;AAER;AAEO,SAAS,cAAc,KAAa;IACzC,wCAAmC;;;AAErC;AAGO,SAAS;IACd,MAAM,cAAc;IACpB,IAAI,CAAC,aAAa,OAAO;QAAE,UAAU,EAAE;QAAE,OAAO,EAAE;QAAE,aAAa,EAAE;QAAE,WAAW,EAAE;QAAE,UAAU,EAAE;IAAC;IACjG,OAAO,YAAY;AACrB;AAEO,SAAS,mBAAmB,IAAuB;IACxD,MAAM,cAAc;IACpB,IAAI,CAAC,aAAa;IAClB,YAAY,aAAa;AAC3B"}},
    {"offset": {"line": 1577, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sinan/sola/components/user-management.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport React, { useState } from \"react\"\r\nimport { Button } from \"./ui/button\"\r\nimport { getSystemUsers, addSystemUser, updateSystemUser, deleteSystemUser, getCurrentUserData, setCurrentUserData, getCurrentUser, type SystemUser } from \"../lib/storage\"\r\nimport type { Entity } from \"../lib/types\"\r\n\r\ninterface UserManagementProps {\r\n  isOpen: boolean\r\n  onClose: () => void\r\n}\r\n\r\nexport function UserManagement({ isOpen, onClose }: UserManagementProps) {\r\n  const [users, setUsers] = useState<SystemUser[]>(getSystemUsers())\r\n  const [newUser, setNewUser] = useState({ \r\n    email: \"\", \r\n    name: \"\", \r\n    password: \"\",\r\n    role: \"editor\" as 'admin' | 'editor' | 'viewer' | 'senior'\r\n  })\r\n  const [isAdding, setIsAdding] = useState(false)\r\n  const [editingUser, setEditingUser] = useState<SystemUser | null>(null)\r\n  const [editForm, setEditForm] = useState({\r\n    email: \"\",\r\n    name: \"\",\r\n    password: \"\",\r\n    role: \"editor\" as 'admin' | 'editor' | 'viewer' | 'senior'\r\n  })\r\n\r\n  // Entity management state\r\n  const [entities, setEntities] = useState<Entity[]>(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const userData = getCurrentUserData()\r\n      return userData.entities || []\r\n    }\r\n    return []\r\n  })\r\n  const [newEntityName, setNewEntityName] = useState(\"\")\r\n  const [newEntityCurrencyCode, setNewEntityCurrencyCode] = useState(\"\")\r\n  const [newEntityTaxAccount, setNewEntityTaxAccount] = useState(\"\")\r\n  const [newEntitySSAccount, setNewEntitySSAccount] = useState(\"\")\r\n  const [showEntitySection, setShowEntitySection] = useState(false)\r\n\r\n  // Backup management state\r\n  const [showBackupSection, setShowBackupSection] = useState(false)\r\n\r\n  // User management section state\r\n  const [showUserSection, setShowUserSection] = useState(true)\r\n\r\n  // Save entities to localStorage whenever they change\r\n  React.useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      setCurrentUserData({ entities })\r\n    }\r\n  }, [entities])\r\n\r\n  const refreshUsers = () => {\r\n    const allUsers = getSystemUsers()\r\n    console.log(\"All users in system:\", allUsers)\r\n    setUsers(allUsers)\r\n  }\r\n\r\n  const handleAddUser = () => {\r\n    if (!newUser.email || !newUser.name || !newUser.password) return\r\n    \r\n    console.log(\"Adding user:\", newUser)\r\n    const addedUser = addSystemUser({\r\n      email: newUser.email,\r\n      name: newUser.name,\r\n      password: newUser.password,\r\n      role: newUser.role,\r\n      isActive: true,\r\n    })\r\n    console.log(\"User added successfully:\", addedUser)\r\n    \r\n    setNewUser({ email: \"\", name: \"\", password: \"\", role: \"editor\" })\r\n    setIsAdding(false)\r\n    refreshUsers()\r\n  }\r\n\r\n  const handleEditUser = (user: SystemUser) => {\r\n    setEditingUser(user)\r\n    setEditForm({\r\n      email: user.email,\r\n      name: user.name,\r\n      password: user.password,\r\n      role: user.role\r\n    })\r\n  }\r\n\r\n  const handleSaveEdit = () => {\r\n    if (!editingUser || !editForm.email || !editForm.name) return\r\n    \r\n    updateSystemUser(editingUser.id, {\r\n      email: editForm.email,\r\n      name: editForm.name,\r\n      password: editForm.password || editingUser.password,\r\n      role: editForm.role\r\n    })\r\n    \r\n    setEditingUser(null)\r\n    setEditForm({ email: \"\", name: \"\", password: \"\", role: \"editor\" })\r\n    refreshUsers()\r\n  }\r\n\r\n  const handleCancelEdit = () => {\r\n    setEditingUser(null)\r\n    setEditForm({ email: \"\", name: \"\", password: \"\", role: \"editor\" })\r\n  }\r\n\r\n  const handleToggleActive = (userId: string, isActive: boolean) => {\r\n    updateSystemUser(userId, { isActive })\r\n    refreshUsers()\r\n  }\r\n\r\n  const handleDeleteUser = (userId: string) => {\r\n    if (confirm(\"Are you sure you want to delete this user?\")) {\r\n      deleteSystemUser(userId)\r\n      refreshUsers()\r\n    }\r\n  }\r\n\r\n  // Entity management functions\r\n  const handleAddEntity = () => {\r\n    if (!newEntityName.trim() || !newEntityCurrencyCode.trim()) return\r\n    \r\n    const newEntity: Entity = {\r\n      id: `entity-${Date.now()}`,\r\n      name: newEntityName.trim(),\r\n      currencyCode: newEntityCurrencyCode.trim(),\r\n      taxAccount: newEntityTaxAccount.trim(),\r\n      ssAccount: newEntitySSAccount.trim()\r\n    }\r\n    \r\n    setEntities(prev => [...prev, newEntity])\r\n    setNewEntityName(\"\")\r\n    setNewEntityCurrencyCode(\"\")\r\n    setNewEntityTaxAccount(\"\")\r\n    setNewEntitySSAccount(\"\")\r\n  }\r\n\r\n  const handleDeleteEntity = (entityId: string) => {\r\n    if (confirm(\"Are you sure you want to delete this entity?\")) {\r\n      setEntities(prev => prev.filter(e => e.id !== entityId))\r\n    }\r\n  }\r\n\r\n  // Backup management functions\r\n  const handleCreateBackup = () => {\r\n    if (typeof window === 'undefined') return\r\n    \r\n    // Get all current user data\r\n    const currentUser = getCurrentUser()\r\n    if (!currentUser) return\r\n    \r\n    const userData = getCurrentUserData()\r\n    \r\n    // Create backup object with timestamp\r\n    const backup = {\r\n      timestamp: new Date().toISOString(),\r\n      version: \"1.0\",\r\n      data: {\r\n        projects: userData.projects || [],\r\n        users: userData.users || [],\r\n        allocations: userData.allocations || [],\r\n        positions: userData.positions || [],\r\n        entities: userData.entities || [],\r\n        startMonth: userData.startMonth,\r\n        startYear: userData.startYear,\r\n        systemUsers: userData.systemUsers || []\r\n      }\r\n    }\r\n    \r\n    // Convert to JSON and create downloadable file\r\n    const backupJson = JSON.stringify(backup, null, 2)\r\n    const blob = new Blob([backupJson], { type: 'application/json' })\r\n    const url = URL.createObjectURL(blob)\r\n    \r\n    // Create download link\r\n    const link = document.createElement('a')\r\n    link.href = url\r\n    link.download = `sola-backup-${new Date().toISOString().split('T')[0]}.json`\r\n    document.body.appendChild(link)\r\n    link.click()\r\n    document.body.removeChild(link)\r\n    URL.revokeObjectURL(url)\r\n    \r\n    alert('Backup created successfully!')\r\n  }\r\n\r\n  const handleImportBackup = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = event.target.files?.[0]\r\n    if (!file) return\r\n    \r\n    const reader = new FileReader()\r\n    reader.onload = (e) => {\r\n      try {\r\n        const backupText = e.target?.result as string\r\n        const backup = JSON.parse(backupText)\r\n        \r\n        // Validate backup structure\r\n        if (!backup.data || typeof backup.data !== 'object') {\r\n          throw new Error('Invalid backup file structure')\r\n        }\r\n        \r\n        if (confirm('This will overwrite all current data. Are you sure you want to continue?')) {\r\n          // Import all data\r\n          const dataToImport = backup.data\r\n          \r\n          // Update user data\r\n          setCurrentUserData({\r\n            projects: dataToImport.projects || [],\r\n            users: dataToImport.users || [],\r\n            allocations: dataToImport.allocations || [],\r\n            positions: dataToImport.positions || [],\r\n            entities: dataToImport.entities || [],\r\n            startMonth: dataToImport.startMonth,\r\n            startYear: dataToImport.startYear,\r\n            systemUsers: dataToImport.systemUsers || []\r\n          })\r\n          \r\n          // Update local state\r\n          setEntities(dataToImport.entities || [])\r\n          refreshUsers()\r\n          \r\n          alert('Backup imported successfully! Please refresh the page to see all changes.')\r\n        }\r\n      } catch (error) {\r\n        alert('Error importing backup: ' + (error as Error).message)\r\n      }\r\n    }\r\n    \r\n    reader.readAsText(file)\r\n    // Reset file input\r\n    event.target.value = ''\r\n  }\r\n\r\n  if (!isOpen) return null\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto\">\r\n        <div className=\"flex justify-between items-center mb-4\">\r\n          <h3 className=\"text-lg font-semibold\">Settings</h3>\r\n          <Button onClick={onClose} variant=\"outline\" size=\"sm\">\r\n            √ó\r\n          </Button>\r\n        </div>\r\n\r\n        {/* User Management Section */}\r\n        <div className=\"border-b pb-4\">\r\n          <div className=\"flex items-center justify-between mb-3\">\r\n            <h4 className=\"text-sm font-semibold text-gray-700\">User Management</h4>\r\n            <Button\r\n              onClick={() => setShowUserSection(!showUserSection)}\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n            >\r\n              {showUserSection ? 'Hide' : 'Show'}\r\n            </Button>\r\n          </div>\r\n          \r\n          {showUserSection && (\r\n            <div className=\"space-y-4\">\r\n              {/* Role Permissions Guide */}\r\n              <div className=\"p-3 bg-blue-50 border border-blue-200 rounded text-sm\">\r\n                <h5 className=\"font-semibold text-blue-800 mb-2\">Role Permissions Guide:</h5>\r\n                <div className=\"space-y-1 text-xs\">\r\n                  <div><strong>Admin:</strong> Full access to all features including Settings</div>\r\n                  <div><strong>Senior:</strong> Can edit/delete on all pages, but cannot access Settings</div>\r\n                  <div><strong>Editor:</strong> Can edit Expense Allocation & Scheduled Records only, view all pages except Settings</div>\r\n                  <div><strong>Viewer:</strong> Can only view Allocation & Planning pages, no edit access</div>\r\n                </div>\r\n              </div>\r\n              {/* Edit User Form */}\r\n              {editingUser && (\r\n                <div className=\"p-4 border rounded-lg bg-blue-50 space-y-3\">\r\n                  <h4 className=\"font-medium text-sm\">Edit User: {editingUser.name}</h4>\r\n                  <input\r\n                    type=\"email\"\r\n                    placeholder=\"Email\"\r\n                    value={editForm.email}\r\n                    onChange={(e) => setEditForm({ ...editForm, email: e.target.value })}\r\n                    className=\"w-full px-3 py-2 border rounded text-sm\"\r\n                  />\r\n                  <input\r\n                    type=\"text\"\r\n                    placeholder=\"Name\"\r\n                    value={editForm.name}\r\n                    onChange={(e) => setEditForm({ ...editForm, name: e.target.value })}\r\n                    className=\"w-full px-3 py-2 border rounded text-sm\"\r\n                  />\r\n                  <input\r\n                    type=\"password\"\r\n                    placeholder=\"Password (leave empty to keep current)\"\r\n                    value={editForm.password}\r\n                    onChange={(e) => setEditForm({ ...editForm, password: e.target.value })}\r\n                    className=\"w-full px-3 py-2 border rounded text-sm\"\r\n                  />\r\n                  <select\r\n                    value={editForm.role}\r\n                    onChange={(e) => setEditForm({ ...editForm, role: e.target.value as 'admin' | 'editor' | 'viewer' | 'senior' })}\r\n                    className=\"w-full px-3 py-2 border rounded text-sm\"\r\n                  >\r\n                    <option value=\"admin\">Admin</option>\r\n                    <option value=\"senior\">Senior</option>\r\n                    <option value=\"editor\">Editor</option>\r\n                    <option value=\"viewer\">Viewer</option>\r\n                  </select>\r\n                  <div className=\"flex gap-2\">\r\n                    <Button onClick={handleSaveEdit} size=\"sm\">Save Changes</Button>\r\n                    <Button onClick={handleCancelEdit} variant=\"outline\" size=\"sm\">Cancel</Button>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Add User Form */}\r\n              {isAdding && (\r\n                <div className=\"p-4 border rounded-lg bg-gray-50 space-y-3\">\r\n                  <input\r\n                    type=\"email\"\r\n                    placeholder=\"Email\"\r\n                    value={newUser.email}\r\n                    onChange={(e) => setNewUser({ ...newUser, email: e.target.value })}\r\n                    className=\"w-full px-3 py-2 border rounded text-sm\"\r\n                  />\r\n                  <input\r\n                    type=\"text\"\r\n                    placeholder=\"Name\"\r\n                    value={newUser.name}\r\n                    onChange={(e) => setNewUser({ ...newUser, name: e.target.value })}\r\n                    className=\"w-full px-3 py-2 border rounded text-sm\"\r\n                  />\r\n                  <input\r\n                    type=\"password\"\r\n                    placeholder=\"Password\"\r\n                    value={newUser.password}\r\n                    onChange={(e) => setNewUser({ ...newUser, password: e.target.value })}\r\n                    className=\"w-full px-3 py-2 border rounded text-sm\"\r\n                  />\r\n                  <select\r\n                    value={newUser.role}\r\n                    onChange={(e) => setNewUser({ ...newUser, role: e.target.value as 'admin' | 'editor' | 'viewer' | 'senior' })}\r\n                    className=\"w-full px-3 py-2 border rounded text-sm\"\r\n                  >\r\n                    <option value=\"admin\">Admin</option>\r\n                    <option value=\"senior\">Senior</option>\r\n                    <option value=\"editor\">Editor</option>\r\n                    <option value=\"viewer\">Viewer</option>\r\n                  </select>\r\n                  <div className=\"flex gap-2\">\r\n                    <Button onClick={handleAddUser} size=\"sm\">Add User</Button>\r\n                    <Button onClick={() => setIsAdding(false)} variant=\"outline\" size=\"sm\">Cancel</Button>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Add User Button */}\r\n              {!isAdding && (\r\n                <Button onClick={() => setIsAdding(true)} variant=\"outline\" size=\"sm\">\r\n                  + Add New User\r\n                </Button>\r\n              )}\r\n\r\n              {/* Users List */}\r\n              <div className=\"space-y-2\">\r\n                {users.map((user) => (\r\n                  <div key={user.id} className=\"flex items-center justify-between p-3 border rounded\">\r\n                    <div className=\"flex-1\">\r\n                      <div className=\"font-medium text-sm\">{user.name}</div>\r\n                      <div className=\"text-xs text-gray-500\">{user.email}</div>\r\n                      <div className=\"text-xs\">\r\n                        <span className={`px-2 py-1 rounded text-xs ${\r\n                          user.role === 'admin' ? 'bg-red-100 text-red-700' :\r\n                          user.role === 'senior' ? 'bg-purple-100 text-purple-700' :\r\n                          user.role === 'editor' ? 'bg-blue-100 text-blue-700' :\r\n                          'bg-gray-100 text-gray-700'\r\n                        }`}>\r\n                          {user.role}\r\n                        </span>\r\n                        <span className={`ml-2 px-2 py-1 rounded text-xs ${\r\n                          user.isActive ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'\r\n                        }`}>\r\n                          {user.isActive ? 'Active' : 'Inactive'}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex gap-2\">\r\n                      <Button\r\n                        onClick={() => handleEditUser(user)}\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                      >\r\n                        Edit\r\n                      </Button>\r\n                      <Button\r\n                        onClick={() => handleToggleActive(user.id, !user.isActive)}\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                      >\r\n                        {user.isActive ? 'Deactivate' : 'Activate'}\r\n                      </Button>\r\n                      {user.email !== 'admin@sola.com' && (\r\n                        <Button\r\n                          onClick={() => handleDeleteUser(user.id)}\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          className=\"text-red-600 hover:text-red-700\"\r\n                        >\r\n                          Delete\r\n                        </Button>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Entity Management Section */}\r\n        <div className=\"border-t pt-4\">\r\n          <div className=\"flex items-center justify-between mb-3\">\r\n            <h4 className=\"text-sm font-semibold text-gray-700\">Entity Management</h4>\r\n            <Button\r\n              onClick={() => setShowEntitySection(!showEntitySection)}\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n            >\r\n              {showEntitySection ? 'Hide' : 'Show'}\r\n            </Button>\r\n          </div>\r\n          \r\n          {showEntitySection && (\r\n            <div className=\"space-y-3\">\r\n              {/* Add New Entity Form */}\r\n              <div className=\"border rounded-lg p-3 bg-gray-50\">\r\n                <h5 className=\"text-sm font-medium mb-2\">Add New Entity</h5>\r\n                <div className=\"grid grid-cols-2 gap-2\">\r\n                  <input\r\n                    type=\"text\"\r\n                    placeholder=\"Entity Name\"\r\n                    value={newEntityName}\r\n                    onChange={(e) => setNewEntityName(e.target.value)}\r\n                    className=\"px-2 py-1 border rounded text-sm\"\r\n                  />\r\n                  <input\r\n                    type=\"text\"\r\n                    placeholder=\"Currency Code\"\r\n                    value={newEntityCurrencyCode}\r\n                    onChange={(e) => setNewEntityCurrencyCode(e.target.value)}\r\n                    className=\"px-2 py-1 border rounded text-sm\"\r\n                  />\r\n                  <input\r\n                    type=\"text\"\r\n                    placeholder=\"Tax Account\"\r\n                    value={newEntityTaxAccount}\r\n                    onChange={(e) => setNewEntityTaxAccount(e.target.value)}\r\n                    className=\"px-2 py-1 border rounded text-sm\"\r\n                  />\r\n                  <input\r\n                    type=\"text\"\r\n                    placeholder=\"SS Account\"\r\n                    value={newEntitySSAccount}\r\n                    onChange={(e) => setNewEntitySSAccount(e.target.value)}\r\n                    className=\"px-2 py-1 border rounded text-sm\"\r\n                  />\r\n                </div>\r\n                <Button onClick={handleAddEntity} size=\"sm\" className=\"mt-2\">\r\n                  Add Entity\r\n                </Button>\r\n              </div>\r\n\r\n              {/* Existing Entities List */}\r\n              {entities.length > 0 && (\r\n                <div className=\"border rounded-lg p-3\">\r\n                  <h5 className=\"text-sm font-medium mb-2\">Existing Entities</h5>\r\n                  <div className=\"space-y-2\">\r\n                    {entities.map(entity => (\r\n                      <div key={entity.id} className=\"flex items-center justify-between p-2 border rounded text-xs bg-gray-50\">\r\n                        <div>\r\n                          <div className=\"font-medium\">{entity.name}</div>\r\n                          <div className=\"text-gray-600\">\r\n                            Currency: {entity.currencyCode} | Tax: {entity.taxAccount} | SS: {entity.ssAccount}\r\n                          </div>\r\n                        </div>\r\n                        <Button\r\n                          onClick={() => handleDeleteEntity(entity.id)}\r\n                          variant=\"destructive\"\r\n                          size=\"sm\"\r\n                        >\r\n                          Delete\r\n                        </Button>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Backup Management Section */}\r\n        <div className=\"border-t pt-4\">\r\n          <div className=\"flex items-center justify-between mb-3\">\r\n            <h4 className=\"text-sm font-semibold text-gray-700\">Backup Management</h4>\r\n            <Button\r\n              onClick={() => setShowBackupSection(!showBackupSection)}\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n            >\r\n              {showBackupSection ? 'Hide' : 'Show'}\r\n            </Button>\r\n          </div>\r\n          \r\n          {showBackupSection && (\r\n            <div className=\"space-y-3\">\r\n              <div className=\"border rounded-lg p-3 bg-gray-50\">\r\n                <h5 className=\"text-sm font-medium mb-2\">Data Backup & Restore</h5>\r\n                <p className=\"text-xs text-gray-600 mb-3\">\r\n                  Create backups of all your data (projects, users, entities, allocations) and restore them when needed.\r\n                </p>\r\n                \r\n                <div className=\"space-y-3\">\r\n                  {/* Create Backup */}\r\n                  <div className=\"flex items-center justify-between p-2 border rounded bg-white\">\r\n                    <div>\r\n                      <div className=\"text-sm font-medium\">Create Backup</div>\r\n                      <div className=\"text-xs text-gray-600\">Download all data as JSON file</div>\r\n                    </div>\r\n                    <Button onClick={handleCreateBackup} size=\"sm\">\r\n                      Create Backup\r\n                    </Button>\r\n                  </div>\r\n                  \r\n                  {/* Import Backup */}\r\n                  <div className=\"flex items-center justify-between p-2 border rounded bg-white\">\r\n                    <div>\r\n                      <div className=\"text-sm font-medium\">Import Backup</div>\r\n                      <div className=\"text-xs text-gray-600\">Restore data from backup file</div>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <input\r\n                        type=\"file\"\r\n                        accept=\".json\"\r\n                        onChange={handleImportBackup}\r\n                        className=\"text-xs file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"mt-3 p-2 bg-yellow-50 border border-yellow-200 rounded\">\r\n                  <p className=\"text-xs text-yellow-800\">\r\n                    <strong>Warning:</strong> Importing a backup will overwrite all current data. \r\n                    Make sure to create a backup before importing.\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2733, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sinan/sola/lib/permissions.ts"],"sourcesContent":["// Role-based access control utilities\r\n\r\nexport type UserRole = 'admin' | 'editor' | 'viewer' | 'senior'\r\n\r\nexport interface PagePermissions {\r\n  canView: boolean\r\n  canEdit: boolean\r\n  canDelete: boolean\r\n}\r\n\r\nexport interface TabPermissions {\r\n  allocation: PagePermissions\r\n  planning: PagePermissions\r\n  actualAllocation: PagePermissions\r\n  expenseAllocation: PagePermissions\r\n  scheduledRecords: PagePermissions\r\n  settings: PagePermissions\r\n}\r\n\r\n/**\r\n * Get permissions for a specific role and page\r\n */\r\nexport function getPermissions(role: UserRole, page: keyof Omit<TabPermissions, 'settings'>): PagePermissions {\r\n  switch (role) {\r\n    case 'admin':\r\n      return {\r\n        canView: true,\r\n        canEdit: true,\r\n        canDelete: true\r\n      }\r\n    \r\n    case 'senior':\r\n      return {\r\n        canView: true,\r\n        canEdit: true,\r\n        canDelete: true\r\n      }\r\n    \r\n    case 'editor':\r\n      // Editor can view all tabs except settings, but only edit specific pages\r\n      const canEdit = page === 'expenseAllocation' || page === 'scheduledRecords'\r\n      return {\r\n        canView: true,\r\n        canEdit,\r\n        canDelete: canEdit\r\n      }\r\n    \r\n    case 'viewer':\r\n      // Viewer can only view allocation and planning\r\n      const canView = page === 'allocation' || page === 'planning'\r\n      return {\r\n        canView,\r\n        canEdit: false,\r\n        canDelete: false\r\n      }\r\n    \r\n    default:\r\n      return {\r\n        canView: false,\r\n        canEdit: false,\r\n        canDelete: false\r\n      }\r\n  }\r\n}\r\n\r\n/**\r\n * Get all tab permissions for a role\r\n */\r\nexport function getAllTabPermissions(role: UserRole): TabPermissions {\r\n  return {\r\n    allocation: getPermissions(role, 'allocation'),\r\n    planning: getPermissions(role, 'planning'),\r\n    actualAllocation: getPermissions(role, 'actualAllocation'),\r\n    expenseAllocation: getPermissions(role, 'expenseAllocation'),\r\n    scheduledRecords: getPermissions(role, 'scheduledRecords'),\r\n    settings: {\r\n      canView: role === 'admin',\r\n      canEdit: role === 'admin',\r\n      canDelete: role === 'admin'\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Check if user can access a specific tab\r\n */\r\nexport function canAccessTab(role: UserRole, tab: keyof TabPermissions): boolean {\r\n  const permissions = getAllTabPermissions(role)\r\n  return permissions[tab].canView\r\n}\r\n\r\n/**\r\n * Check if user can edit on a specific page\r\n */\r\nexport function canEditPage(role: UserRole, page: keyof Omit<TabPermissions, 'settings'>): boolean {\r\n  return getPermissions(role, page).canEdit\r\n}\r\n\r\n/**\r\n * Check if user can delete on a specific page\r\n */\r\nexport function canDeletePage(role: UserRole, page: keyof Omit<TabPermissions, 'settings'>): boolean {\r\n  return getPermissions(role, page).canDelete\r\n}\r\n"],"names":[],"mappings":"AAAA,sCAAsC;;;;;;;;;;;;;AAsB/B,SAAS,eAAe,IAAc,EAAE,IAA4C;IACzF,OAAQ;QACN,KAAK;YACH,OAAO;gBACL,SAAS;gBACT,SAAS;gBACT,WAAW;YACb;QAEF,KAAK;YACH,OAAO;gBACL,SAAS;gBACT,SAAS;gBACT,WAAW;YACb;QAEF,KAAK;YACH,yEAAyE;YACzE,MAAM,UAAU,SAAS,uBAAuB,SAAS;YACzD,OAAO;gBACL,SAAS;gBACT;gBACA,WAAW;YACb;QAEF,KAAK;YACH,+CAA+C;YAC/C,MAAM,UAAU,SAAS,gBAAgB,SAAS;YAClD,OAAO;gBACL;gBACA,SAAS;gBACT,WAAW;YACb;QAEF;YACE,OAAO;gBACL,SAAS;gBACT,SAAS;gBACT,WAAW;YACb;IACJ;AACF;AAKO,SAAS,qBAAqB,IAAc;IACjD,OAAO;QACL,YAAY,eAAe,MAAM;QACjC,UAAU,eAAe,MAAM;QAC/B,kBAAkB,eAAe,MAAM;QACvC,mBAAmB,eAAe,MAAM;QACxC,kBAAkB,eAAe,MAAM;QACvC,UAAU;YACR,SAAS,SAAS;YAClB,SAAS,SAAS;YAClB,WAAW,SAAS;QACtB;IACF;AACF;AAKO,SAAS,aAAa,IAAc,EAAE,GAAyB;IACpE,MAAM,cAAc,qBAAqB;IACzC,OAAO,WAAW,CAAC,IAAI,CAAC,OAAO;AACjC;AAKO,SAAS,YAAY,IAAc,EAAE,IAA4C;IACtF,OAAO,eAAe,MAAM,MAAM,OAAO;AAC3C;AAKO,SAAS,cAAc,IAAc,EAAE,IAA4C;IACxF,OAAO,eAAe,MAAM,MAAM,SAAS;AAC7C"}},
    {"offset": {"line": 2812, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/sinan/sola/components/allocation-grid.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport React from \"react\"\r\nimport { useState, useEffect } from \"react\"\r\nimport type { Project, User, Allocation, Position, Entity } from \"../lib/types\"\r\nimport { Button } from \"./ui/button\"\r\nimport { AllocationCell } from \"./allocation-cell\"\r\nimport { ProjectManager } from \"./project-manager\"\r\nimport { getCurrentUser, clearCurrentUser, getCurrentUserData, setCurrentUserData, getCurrentSystemUser, getUserData, getSystemUsers } from \"../lib/storage\"\r\nimport { UserManagement } from \"./user-management\"\r\nimport { canEditPage, canAccessTab, UserRole } from \"../lib/permissions\"\r\n\r\nconst MONTHS = [\r\n  \"January\",\r\n  \"February\",\r\n  \"March\",\r\n  \"April\",\r\n  \"May\",\r\n  \"June\",\r\n  \"July\",\r\n  \"August\",\r\n  \"September\",\r\n  \"October\",\r\n  \"November\",\r\n  \"December\",\r\n]\r\nconst YEARS = Array.from({ length: 10 }, (_, i) => 2024 + i)\r\n\r\nexport function AllocationGrid() {\r\n  // Check if user is logged in and get their role\r\n  const [currentUser, setCurrentUserState] = useState<string | null>(null)\r\n  const [currentUserRole, setCurrentUserRole] = useState<UserRole | null>(null)\r\n  \r\n  // Load user-specific data on component mount\r\n  const [projects, setProjects] = useState<Project[]>(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const systemUser = getCurrentSystemUser()\r\n      \r\n      if (systemUser?.role === 'admin') {\r\n        // Admin loads their own data\r\n        const userData = getCurrentUserData()\r\n        console.log(\"[v0] Admin loading own data:\", userData.projects)\r\n        return userData.projects\r\n      } else {\r\n        // System users load admin's data\r\n        const systemUsers = getSystemUsers()\r\n        const adminUser = systemUsers.find(u => u.role === 'admin' && u.isActive)\r\n        \r\n        if (adminUser) {\r\n          const adminData = getUserData(adminUser.email)\r\n          console.log(\"[v0] System user loading admin data:\", adminData.projects)\r\n          return adminData.projects\r\n        }\r\n      }\r\n    }\r\n    return []\r\n  })\r\n\r\n  const [users, setUsers] = useState<User[]>(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const systemUser = getCurrentSystemUser()\r\n      \r\n      if (systemUser?.role === 'admin') {\r\n        // Admin loads their own data\r\n        const userData = getCurrentUserData()\r\n        return userData.users.length > 0 ? userData.users : [\r\n          { id: \"1\", name: \"John Doe\", department: \"Engineering\" },\r\n          { id: \"2\", name: \"Jane Smith\", department: \"Design\" },\r\n          { id: \"3\", name: \"Bob Johnson\", department: \"Product\" },\r\n        ]\r\n      } else {\r\n        // System users load admin's data\r\n        const systemUsers = getSystemUsers()\r\n        const adminUser = systemUsers.find(u => u.role === 'admin' && u.isActive)\r\n        \r\n        if (adminUser) {\r\n          const adminData = getUserData(adminUser.email)\r\n          return adminData.users.length > 0 ? adminData.users : [\r\n            { id: \"1\", name: \"John Doe\", department: \"Engineering\" },\r\n            { id: \"2\", name: \"Jane Smith\", department: \"Design\" },\r\n            { id: \"3\", name: \"Bob Johnson\", department: \"Product\" },\r\n          ]\r\n        }\r\n      }\r\n    }\r\n    return [\r\n      { id: \"1\", name: \"John Doe\", department: \"Engineering\" },\r\n      { id: \"2\", name: \"Jane Smith\", department: \"Design\" },\r\n      { id: \"3\", name: \"Bob Johnson\", department: \"Product\" },\r\n    ]\r\n  })\r\n\r\n  const [allocations, setAllocations] = useState<Allocation[]>(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const systemUser = getCurrentSystemUser()\r\n      \r\n      if (systemUser?.role === 'admin') {\r\n        // Admin loads their own data\r\n        const userData = getCurrentUserData()\r\n        return userData.allocations\r\n      } else {\r\n        // System users load admin's data\r\n        const systemUsers = getSystemUsers()\r\n        const adminUser = systemUsers.find(u => u.role === 'admin' && u.isActive)\r\n        \r\n        if (adminUser) {\r\n          const adminData = getUserData(adminUser.email)\r\n          return adminData.allocations\r\n        }\r\n      }\r\n    }\r\n    return []\r\n  })\r\n\r\n  const [positions, setPositions] = useState<Position[]>(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const systemUser = getCurrentSystemUser()\r\n      \r\n      if (systemUser?.role === 'admin') {\r\n        // Admin loads their own data\r\n        const userData = getCurrentUserData()\r\n        return userData.positions\r\n      } else {\r\n        // System users load admin's data\r\n        const systemUsers = getSystemUsers()\r\n        const adminUser = systemUsers.find(u => u.role === 'admin' && u.isActive)\r\n        \r\n        if (adminUser) {\r\n          const adminData = getUserData(adminUser.email)\r\n          return adminData.positions\r\n        }\r\n      }\r\n    }\r\n    return []\r\n  })\r\n\r\n  // Check login status and role on mount\r\n  useEffect(() => {\r\n    const user = getCurrentUser()\r\n    const systemUser = getCurrentSystemUser()\r\n    if (!user || !systemUser) {\r\n      window.location.href = \"/login\"\r\n    } else {\r\n      setCurrentUserState(user)\r\n      setCurrentUserRole(systemUser.role)\r\n    }\r\n  }, [])\r\n\r\n  // Save data to user-specific storage whenever it changes\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined' && currentUser) {\r\n      console.log(\"[v0] Saving projects for user:\", currentUser, projects)\r\n      setCurrentUserData({ projects })\r\n    }\r\n  }, [projects, currentUser])\r\n\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined' && currentUser) {\r\n      setCurrentUserData({ users })\r\n    }\r\n  }, [users, currentUser])\r\n\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined' && currentUser) {\r\n      setCurrentUserData({ allocations })\r\n    }\r\n  }, [allocations, currentUser])\r\n\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined' && currentUser) {\r\n      setCurrentUserData({ positions })\r\n    }\r\n  }, [positions, currentUser])\r\n\r\n  const [selectedMonth, setSelectedMonth] = useState<number | null>(null)\r\n\r\n  // Grid starting month/year (top-right selectors). Persist per user.\r\n  const [startMonth, setStartMonth] = useState(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const userData = getCurrentUserData()\r\n      return userData.startMonth ?? 0\r\n    }\r\n    return 0\r\n  })\r\n\r\n  const [startYear, setStartYear] = useState(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const userData = getCurrentUserData()\r\n      return userData.startYear ?? 2024\r\n    }\r\n    return 2024\r\n  })\r\n\r\n  // Persist starting month/year when they change\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined' && currentUser) {\r\n      setCurrentUserData({ startMonth, startYear })\r\n    }\r\n  }, [startMonth, startYear, currentUser])\r\n  const [editingId, setEditingId] = useState<string | null>(null)\r\n  const [editValue, setEditValue] = useState(0)\r\n  const [showUnallocatedModal, setShowUnallocatedModal] = useState(false)\r\n  const [pendingAllocation, setPendingAllocation] = useState<{ userId: string; monthIndex: number } | null>(null)\r\n  const [showUserModal, setShowUserModal] = useState(false)\r\n  const [editingUserId, setEditingUserId] = useState<string | null>(null)\r\n  const [editingUserName, setEditingUserName] = useState(\"\")\r\n  const [editingUserDept, setEditingUserDept] = useState(\"\")\r\n  const [editingUserEntity, setEditingUserEntity] = useState(\"\")\r\n  const [editingUserVendorAC, setEditingUserVendorAC] = useState(\"\")\r\n  const [editingUserStartDate, setEditingUserStartDate] = useState(\"\")\r\n  const [editingUserEndDate, setEditingUserEndDate] = useState(\"\")\r\n  const [editingUserWorkDays, setEditingUserWorkDays] = useState<'mon-fri' | 'sun-thu'>('mon-fri')\r\n  const [selectedCellMonth, setSelectedCellMonth] = useState<number | null>(null)\r\n  const [selectedCellUser, setSelectedCellUser] = useState<string | null>(null)\r\n  const [showPositionModal, setShowPositionModal] = useState(false)\r\n  const [showUserManagement, setShowUserManagement] = useState(false)\r\n  const [viewMode, setViewMode] = useState<'percentage' | 'days'>('percentage')\r\n  const [showMonthDetail, setShowMonthDetail] = useState(false)\r\n  const [selectedMonthForDetail, setSelectedMonthForDetail] = useState<{ year: number; month: number; globalIndex: number } | null>(null)\r\n  const [showGanttChart, setShowGanttChart] = useState(false)\r\n  const [ganttStartYear, setGanttStartYear] = useState(new Date().getFullYear())\r\n  const [customAllocationAmount, setCustomAllocationAmount] = useState<{ [key: string]: string }>({})\r\n  const [selectedPositionForCustom, setSelectedPositionForCustom] = useState<string | null>(null)\r\n  const [selectedProjectId, setSelectedProjectId] = useState<string | null>(null)\r\n  \r\n  // Load entities from localStorage for dropdown\r\n  const [entities, setEntities] = useState<Entity[]>(() => {\r\n    if (typeof window !== 'undefined') {\r\n      const userData = getCurrentUserData()\r\n      return userData.entities || []\r\n    }\r\n    return []\r\n  })\r\n\r\n  // Check if current user has permission for specific actions\r\n  const canEdit = currentUserRole ? canEditPage(currentUserRole, 'allocation') : false\r\n  const canView = currentUserRole ? canAccessTab(currentUserRole, 'allocation') : false\r\n\r\n  // Filter projects to show only those active between starting month and starting month + 11 months\r\n  const filteredProjects = projects.filter(project => {\r\n    console.log('[DEBUG] Checking project:', project.name)\r\n    console.log('[DEBUG] Project dates:', {\r\n      startMonth: project.startMonth,\r\n      startYear: project.startYear,\r\n      endMonth: project.endMonth,\r\n      endYear: project.endYear,\r\n      hasEndMonth: !!project.endMonth,\r\n      hasEndYear: !!project.endYear,\r\n      endMonthType: typeof project.endMonth,\r\n      endYearType: typeof project.endYear\r\n    })\r\n    \r\n    // If project has no end date, include it\r\n    if (!project.endMonth || !project.endYear) {\r\n      console.log('[DEBUG] Project has no end date, including - endMonth:', project.endMonth, 'endYear:', project.endYear)\r\n      return true\r\n    }\r\n    \r\n    // Calculate project start date - ensure proper year handling\r\n    const projectStartYear = project.startYear || 2024\r\n    const projectEndYear = project.endYear || 2024\r\n    \r\n    console.log('[DEBUG] Using years:', {\r\n      projectStartYear,\r\n      projectEndYear\r\n    })\r\n    \r\n    // Create date objects\r\n    const projectStartDate = new Date(projectStartYear, project.startMonth || 0, 1)\r\n    const projectEndDate = new Date(projectEndYear, project.endMonth, 1)\r\n    \r\n    // Calculate staff allocation start and end dates\r\n    const staffStartDate = new Date(startYear, startMonth, 1)\r\n    const staffEndDate = new Date(startYear, startMonth + 11, 1)\r\n    \r\n    console.log('[DEBUG] Date comparison:', {\r\n      projectStartDate: projectStartDate.toISOString().split('T')[0],\r\n      projectEndDate: projectEndDate.toISOString().split('T')[0],\r\n      staffStartDate: staffStartDate.toISOString().split('T')[0],\r\n      staffEndDate: staffEndDate.toISOString().split('T')[0]\r\n    })\r\n    \r\n    // Check if project overlaps with staff allocation period\r\n    const overlaps = projectStartDate <= staffEndDate && projectEndDate >= staffStartDate\r\n    \r\n    console.log('[DEBUG] Overlap result:', {\r\n      projectStartBeforeStaffEnd: projectStartDate <= staffEndDate,\r\n      projectEndAfterStaffStart: projectEndDate >= staffStartDate,\r\n      overlaps: overlaps\r\n    })\r\n    \r\n    return overlaps\r\n  })\r\n\r\n  const MONTHS = [\r\n    \"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\r\n    \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"\r\n  ]\r\n\r\n  const getContrastColor = (hex: string) => {\r\n    const r = parseInt(hex.slice(1, 3), 16)\r\n    const g = parseInt(hex.slice(3, 5), 16)\r\n    const b = parseInt(hex.slice(5, 7), 16)\r\n    const brightness = (r * 299 + g * 587 + b * 114) / 1000\r\n    return brightness > 128 ? \"#000\" : \"#fff\"\r\n  }\r\n\r\n  const addProject = (project: Project) => {\r\n    setProjects((prev) => [...prev, project])\r\n  }\r\n\r\n  // Export to Excel function\r\n  const exportToExcel = () => {\r\n    // Create CSV content\r\n    let csvContent = \"\"\r\n    \r\n    // Add header row\r\n    const headerRow = [\"Staff\", ...months.map(m => m.display)]\r\n    csvContent += headerRow.join(\",\") + \"\\n\"\r\n    \r\n    // Add department rows and user data\r\n    groupedUsers.forEach(group => {\r\n      // Add department header\r\n      csvContent += `${group.department},\\n`\r\n      \r\n      // Add users in this department\r\n      group.users.forEach(user => {\r\n        const userRow = [user.name]\r\n        \r\n        months.forEach(month => {\r\n          const userAllocations = allocations.filter(\r\n            a => a.userId === user.id && a.monthIndex === month.globalIndex\r\n          )\r\n          \r\n          if (userAllocations.length > 0) {\r\n            const totalAllocated = userAllocations.reduce((sum, a) => sum + (a.percentage || 0), 0)\r\n            let displayValue\r\n            \r\n            if (viewMode === 'days') {\r\n              displayValue = getDaysFromPercentage(user.id, month.globalIndex, totalAllocated)\r\n              userRow.push(`${displayValue} days`)\r\n            } else {\r\n              displayValue = Math.round(totalAllocated)\r\n              userRow.push(`${displayValue}%`)\r\n            }\r\n          } else {\r\n            // Check if user hasn't started or has ended\r\n            if (!isUserStartedInMonth(user.id, month.globalIndex)) {\r\n              userRow.push(\"not started\")\r\n            } else if (isUserEndedInMonth(user.id, month.globalIndex)) {\r\n              userRow.push(\"ended\")\r\n            } else {\r\n              userRow.push(\"\")\r\n            }\r\n          }\r\n        })\r\n        \r\n        csvContent += userRow.join(\",\") + \"\\n\"\r\n      })\r\n    })\r\n    \r\n    // Create and download the file\r\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' })\r\n    const link = document.createElement('a')\r\n    const url = URL.createObjectURL(blob)\r\n    \r\n    const fileName = `staff-allocation-${viewMode}-${new Date().toISOString().split('T')[0]}.csv`\r\n    link.setAttribute('href', url)\r\n    link.setAttribute('download', fileName)\r\n    link.style.visibility = 'hidden'\r\n    document.body.appendChild(link)\r\n    link.click()\r\n    document.body.removeChild(link)\r\n  }\r\n\r\n  // Export month detail to Excel function\r\n  const exportMonthDetailToExcel = () => {\r\n    if (!selectedMonthForDetail) return\r\n    \r\n    // Create CSV content for month detail view\r\n    let csvContent = \"\"\r\n    \r\n    // Add header row with projects\r\n    const headerRow = [\"Staff\", ...filteredProjects.map(p => p.name), \"Total\"]\r\n    csvContent += headerRow.join(\",\") + \"\\n\"\r\n    \r\n    // Add department rows and user data for the selected month\r\n    groupedUsers.forEach(group => {\r\n      // Add department header\r\n      csvContent += `${group.department},\\n`\r\n      \r\n      // Add users in this department\r\n      group.users.forEach(user => {\r\n        const userRow = [user.name]\r\n        \r\n        // Add allocations for each project\r\n        filteredProjects.forEach(project => {\r\n          const userAllocations = allocations.filter(\r\n            a => a.userId === user.id && \r\n            a.projectId === project.id && \r\n            a.monthIndex === selectedMonthForDetail.globalIndex\r\n          )\r\n          \r\n          if (userAllocations.length > 0) {\r\n            const totalAllocated = userAllocations.reduce((sum, a) => sum + (a.percentage || 0), 0)\r\n            let displayValue\r\n            \r\n            if (viewMode === 'days') {\r\n              displayValue = Math.round(getDaysFromPercentage(user.id, selectedMonthForDetail.globalIndex, totalAllocated))\r\n              userRow.push(`${displayValue} days`)\r\n            } else {\r\n              displayValue = Math.round(totalAllocated)\r\n              userRow.push(`${displayValue}%`)\r\n            }\r\n          } else {\r\n            userRow.push(\"\")\r\n          }\r\n        })\r\n        \r\n        // Add total column\r\n        const totalAllocated = allocations\r\n          .filter((a) => a.userId === user.id && a.monthIndex === selectedMonthForDetail.globalIndex)\r\n          .reduce((sum, a) => sum + (a.percentage || 0), 0)\r\n        \r\n        if (viewMode === 'days') {\r\n          const totalDays = Math.round(getDaysFromPercentage(user.id, selectedMonthForDetail.globalIndex, totalAllocated))\r\n          userRow.push(`${totalDays} days`)\r\n        } else {\r\n          userRow.push(`${Math.round(totalAllocated)}%`)\r\n        }\r\n        \r\n        csvContent += userRow.join(\",\") + \"\\n\"\r\n      })\r\n    })\r\n    \r\n    // Create and download the file\r\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' })\r\n    const link = document.createElement('a')\r\n    const url = URL.createObjectURL(blob)\r\n    \r\n    const fileName = `staff-allocation-detail-${MONTHS[selectedMonthForDetail.month]}-${selectedMonthForDetail.year}-${viewMode}-${new Date().toISOString().split('T')[0]}.csv`\r\n    link.setAttribute('href', url)\r\n    link.setAttribute('download', fileName)\r\n    link.style.visibility = 'hidden'\r\n    document.body.appendChild(link)\r\n    link.click()\r\n    document.body.removeChild(link)\r\n  }\r\n\r\n  const updateProject = (projectId: string, updates: Partial<Project>) => {\r\n    console.log(\"[v0] updateProject called:\", { projectId, updates })\r\n    console.trace(\"[v0] updateProject call stack\")\r\n    setProjects((prev) => {\r\n      const existing = prev.find((p) => p.id === projectId)\r\n      if (existing && Object.entries(updates).every(([key, value]) => existing[key as keyof Project] === value)) {\r\n        console.log(\"[v0] Skipping update: no actual changes detected\")\r\n        return prev\r\n      }\r\n      const next = prev.map((p) => (p.id === projectId ? { ...p, ...updates } : p))\r\n      console.log(\"[v0] projects after update:\", next)\r\n      return next\r\n    })\r\n  }\r\n\r\n  const deleteProject = (projectId: string) => {\r\n    setProjects((prev) => prev.filter((p) => p.id !== projectId))\r\n    setAllocations((prev) => prev.filter((a) => a.projectId !== projectId))\r\n  }\r\n\r\n  const addUser = () => {\r\n    setEditingUserId(null)\r\n    setEditingUserName(\"\")\r\n    setEditingUserDept(\"\")\r\n    setEditingUserEntity(\"\")\r\n    setEditingUserVendorAC(\"\")\r\n    setEditingUserStartDate(\"\")\r\n    setEditingUserEndDate(\"\")\r\n    setEditingUserWorkDays('mon-fri')\r\n    setShowUserModal(true)\r\n  }\r\n\r\n  const editUser = (userId: string) => {\r\n    const user = users.find((u) => u.id === userId)\r\n    if (user) {\r\n      setEditingUserId(userId)\r\n      setEditingUserName(user.name)\r\n      setEditingUserDept(user.department)\r\n      setEditingUserEntity(user.entity || \"\")\r\n      setEditingUserVendorAC(user.vendorAC || \"\")\r\n      setEditingUserStartDate(user.startDate || \"\")\r\n      setEditingUserEndDate(user.endDate || \"\")\r\n      setEditingUserWorkDays(user.workDays || 'mon-fri')\r\n      setShowUserModal(true)\r\n    }\r\n  }\r\n\r\n  const saveUserChanges = () => {\r\n    if (!editingUserName.trim()) return\r\n\r\n    if (editingUserId) {\r\n      setUsers((prev) =>\r\n        prev.map((u) =>\r\n          u.id === editingUserId\r\n            ? {\r\n                ...u,\r\n                name: editingUserName,\r\n                department: editingUserDept,\r\n                entity: editingUserEntity || undefined,\r\n                vendorAC: editingUserVendorAC || undefined,\r\n                startDate: editingUserStartDate || undefined,\r\n                endDate: editingUserEndDate || undefined,\r\n                workDays: editingUserWorkDays,\r\n              }\r\n            : u,\r\n        ),\r\n      )\r\n    } else {\r\n      const newUser: User = {\r\n        id: `user-${Date.now()}`,\r\n        name: editingUserName,\r\n        department: editingUserDept,\r\n        entity: editingUserEntity || undefined,\r\n        vendorAC: editingUserVendorAC || undefined,\r\n        startDate: editingUserStartDate || undefined,\r\n        endDate: editingUserEndDate || undefined,\r\n        workDays: editingUserWorkDays,\r\n      }\r\n      setUsers((prev) => [...prev, newUser])\r\n    }\r\n\r\n    setShowUserModal(false)\r\n    setEditingUserId(null)\r\n    setEditingUserName(\"\")\r\n    setEditingUserDept(\"\")\r\n    setEditingUserEntity(\"\")\r\n    setEditingUserVendorAC(\"\")\r\n    setEditingUserStartDate(\"\")\r\n    setEditingUserEndDate(\"\")\r\n    setEditingUserWorkDays('mon-fri')\r\n  }\r\n\r\n  const deleteUser = (userId: string) => {\r\n    setUsers((prev) => prev.filter((u) => u.id !== userId))\r\n    setAllocations((prev) => prev.filter((a) => a.userId !== userId))\r\n  }\r\n\r\n  const updatePositions = (newPositions: Position[]) => {\r\n    const updatedProjects = projects.map((project) => ({\r\n      ...project,\r\n      positions: newPositions.filter((p) => p.projectId === project.id),\r\n    }))\r\n    setProjects(updatedProjects)\r\n    \r\n    // Update allocations to match new position budgets\r\n    const updatedAllocations = allocations.map(allocation => {\r\n      const newPosition = newPositions.find(p => \r\n        p.projectId === allocation.projectId && \r\n        p.monthIndex === allocation.monthIndex && \r\n        p.name === allocation.positionName\r\n      )\r\n      \r\n      if (newPosition && allocation.percentage > newPosition.percentage) {\r\n        // Reduce allocation to match new budget\r\n        return {\r\n          ...allocation,\r\n          percentage: newPosition.percentage\r\n        }\r\n      }\r\n      \r\n      return allocation\r\n    })\r\n    \r\n    setAllocations(updatedAllocations)\r\n  }\r\n\r\n  const handleMonthClick = (monthIndex: number) => {\r\n    const year = Math.floor(monthIndex / 12) + 2024\r\n    const month = monthIndex % 12\r\n    setSelectedMonthForDetail({ year, month, globalIndex: monthIndex })\r\n    setShowMonthDetail(true)\r\n  }\r\n\r\n  // Months shown in the grid. The globalIndex here MUST match how ProjectManager\r\n  // stores position.monthIndex: (year - 2024) * 12 + month.\r\n  const months = Array.from({ length: 12 }, (_, i) => {\r\n    const date = new Date(startYear, startMonth + i, 1)\r\n    const month = date.getMonth()\r\n    const year = date.getFullYear()\r\n    const globalIndex = (year - 2024) * 12 + month\r\n\r\n    return {\r\n      month,\r\n      year,\r\n      globalIndex,\r\n      display: `${MONTHS[month].slice(0, 3).toUpperCase()} ${String(year).slice(-2)}`,\r\n    }\r\n  })\r\n\r\n  const handleEmptyCellClick = (userId: string, monthIndex: number) => {\r\n    if (!canEdit) return // Only allow editing if user is admin\r\n    \r\n    console.log(\"[v0] Empty cell clicked:\", { userId, monthIndex, selectedMonth })\r\n\r\n    // Respect user end date: do not allow new allocations after their end date\r\n    const user = users.find((u) => u.id === userId)\r\n    if (user?.endDate) {\r\n      const end = new Date(user.endDate)\r\n      if (!Number.isNaN(end.getTime())) {\r\n        const endMonth = end.getMonth() // 0-11\r\n        const endYear = end.getFullYear()\r\n        const endGlobalIndex = (endYear - 2024) * 12 + endMonth\r\n        if (monthIndex > endGlobalIndex) {\r\n          // After end date: block allocation\r\n          return\r\n        }\r\n      }\r\n    }\r\n    \r\n    // Respect user start date: do not allow new allocations before their start date\r\n    if (user?.startDate) {\r\n      const start = new Date(user.startDate)\r\n      if (!Number.isNaN(start.getTime())) {\r\n        const startMonth = start.getMonth() // 0-11\r\n        const startYear = start.getFullYear()\r\n        const startGlobalIndex = (startYear - 2024) * 12 + startMonth\r\n        if (monthIndex < startGlobalIndex) {\r\n          // Before start date: block allocation\r\n          return\r\n        }\r\n      }\r\n    }\r\n\r\n    setSelectedCellUser(userId)\r\n    setSelectedCellMonth(monthIndex)\r\n    setShowPositionModal(true)\r\n  }\r\n\r\n  // Helper to check if user has ended by a given month\r\n  const isUserEndedInMonth = (userId: string, monthIndex: number): boolean => {\r\n    const user = users.find((u) => u.id === userId)\r\n    if (!user?.endDate) return false\r\n    \r\n    const end = new Date(user.endDate)\r\n    if (Number.isNaN(end.getTime())) return false\r\n    \r\n    const endMonth = end.getMonth() // 0-11\r\n    const endYear = end.getFullYear()\r\n    const endGlobalIndex = (endYear - 2024) * 12 + endMonth\r\n    \r\n    return monthIndex > endGlobalIndex\r\n  }\r\n  \r\n  // Helper to check if user has started by a given month\r\n  const isUserStartedInMonth = (userId: string, monthIndex: number): boolean => {\r\n    const user = users.find((u) => u.id === userId)\r\n    if (!user?.startDate) return true\r\n    \r\n    const start = new Date(user.startDate)\r\n    if (Number.isNaN(start.getTime())) return true\r\n    \r\n    const startMonth = start.getMonth() // 0-11\r\n    const startYear = start.getFullYear()\r\n    const startGlobalIndex = (startYear - 2024) * 12 + startMonth\r\n    \r\n    return monthIndex >= startGlobalIndex\r\n  }\r\n\r\n  // Helper to calculate working days in a month\r\n  const getWorkingDaysInMonth = (year: number, month: number, startDay: number = 1): number => {\r\n    const date = new Date(year, month, 1)\r\n    const daysInMonth = new Date(year, month + 1, 0).getDate()\r\n    let workingDays = 0\r\n    \r\n    for (let day = 1; day <= daysInMonth; day++) {\r\n      date.setDate(day)\r\n      const dayOfWeek = date.getDay() // 0 = Sunday, 6 = Saturday\r\n      \r\n      if (startDay === 1) {\r\n        // Monday to Friday (1-5)\r\n        if (dayOfWeek >= 1 && dayOfWeek <= 5) {\r\n          workingDays++\r\n        }\r\n      } else {\r\n        // Sunday to Thursday (0-4)\r\n        if (dayOfWeek >= 0 && dayOfWeek <= 4) {\r\n          workingDays++\r\n        }\r\n      }\r\n    }\r\n    \r\n    return workingDays\r\n  }\r\n\r\n  // Helper to convert percentage to days based on user work pattern\r\n  const getDaysFromPercentage = (userId: string, monthIndex: number, percentage: number): number => {\r\n    const user = users.find((u) => u.id === userId)\r\n    if (!user) return 0\r\n    \r\n    // Get the month and year from monthIndex\r\n    const year = Math.floor(monthIndex / 12) + 2024\r\n    const month = monthIndex % 12\r\n    \r\n    // Get working days based on user's work pattern\r\n    const workPattern = user.workDays || 'mon-fri'\r\n    const startDay = workPattern === 'mon-fri' ? 1 : 0\r\n    const workingDays = getWorkingDaysInMonth(year, month, startDay)\r\n    \r\n    // Calculate days from percentage\r\n    return Math.round((percentage / 100) * workingDays)\r\n  }\r\n\r\n  const handleAddAllocation = (projectId: string, positionName: string, customAmount?: number) => {\r\n    if (selectedCellUser && selectedCellMonth !== null) {\r\n      // Find the underlying position so we can link by positionId\r\n      const project = projects.find((p) => p.id === projectId)\r\n      const position = project?.positions?.find(\r\n        (pos) => pos.monthIndex === selectedCellMonth && pos.name === positionName,\r\n      )\r\n\r\n      // If we can't find the position or it has no budget, do nothing\r\n      if (!position || !position.percentage) {\r\n        return\r\n      }\r\n\r\n      // How much of this position is already allocated in this month (across all users)\r\n      const alreadyAllocated = allocations\r\n        .filter(\r\n          (a) =>\r\n            a.projectId === projectId &&\r\n            a.monthIndex === selectedCellMonth &&\r\n            (a.positionId === position.id || a.positionName === positionName),\r\n        )\r\n        .reduce((sum, a) => sum + (a.percentage || 0), 0)\r\n\r\n      const remaining = Math.max(0, position.percentage - alreadyAllocated)\r\n\r\n      // Nothing left to allocate\r\n      if (remaining <= 0) {\r\n        return\r\n      }\r\n\r\n      // Use custom amount if provided, otherwise use full remaining\r\n      const allocationAmount = customAmount ? Math.min(customAmount, remaining) : remaining\r\n\r\n      const newAllocation: Allocation = {\r\n        id: `alloc-${Date.now()}`,\r\n        userId: selectedCellUser,\r\n        projectId,\r\n        monthIndex: selectedCellMonth,\r\n        percentage: allocationAmount,\r\n        positionId: position?.id,\r\n        positionName,\r\n      }\r\n      setAllocations((prev) => [...prev, newAllocation])\r\n\r\n      // Update allocated amount in positions\r\n      setProjects((prev) =>\r\n        prev.map((p) =>\r\n          p.id === projectId\r\n            ? {\r\n                ...p,\r\n                positions: p.positions?.map((pos) =>\r\n                  pos.monthIndex === selectedCellMonth && pos.name === positionName\r\n                    ? { ...pos, allocated: (pos.allocated || 0) + allocationAmount }\r\n                    : pos,\r\n                ),\r\n              }\r\n            : p,\r\n        ),\r\n      )\r\n\r\n      // Close modal and reset custom allocation state\r\n      setShowPositionModal(false)\r\n      setSelectedPositionForCustom(null)\r\n      setCustomAllocationAmount({})\r\n      setSelectedCellUser(null)\r\n      setSelectedCellMonth(null)\r\n    }\r\n  }\r\n\r\n  const handleRemoveAllocation = (allocationId: string) => {\r\n    const allocation = allocations.find((a) => a.id === allocationId)\r\n    if (allocation) {\r\n      setProjects((prev) =>\r\n        prev.map((p) =>\r\n          p.id === allocation.projectId\r\n            ? {\r\n                ...p,\r\n                positions: p.positions?.map((pos) =>\r\n                  pos.monthIndex === allocation.monthIndex && pos.name === allocation.positionName\r\n                    ? { ...pos, allocated: Math.max(0, (pos.allocated || 0) - 1) }\r\n                    : pos,\r\n                ),\r\n              }\r\n            : p,\r\n        ),\r\n      )\r\n    }\r\n    setAllocations((prev) => prev.filter((a) => a.id !== allocationId))\r\n  }\r\n\r\n  const cleanupAllocations = (projectId: string, validPositionIds: string[]) => {\r\n    setAllocations((prev) => {\r\n      const filtered = prev.filter((allocation) => {\r\n        // Keep allocation if it's not for this project\r\n        if (allocation.projectId !== projectId) return true\r\n        \r\n        // Keep allocation if it has a valid positionId\r\n        if (allocation.positionId && validPositionIds.includes(allocation.positionId)) return true\r\n        \r\n        // Remove allocation if positionId is not in the valid list\r\n        return false\r\n      })\r\n      \r\n      // Update allocated counts for the affected positions\r\n      const removedAllocations = prev.filter((allocation) => {\r\n        return allocation.projectId === projectId && \r\n               (!allocation.positionId || !validPositionIds.includes(allocation.positionId))\r\n      })\r\n      \r\n      if (removedAllocations.length > 0) {\r\n        setProjects((projectsPrev) =>\r\n          projectsPrev.map((project) =>\r\n            project.id === projectId\r\n              ? {\r\n                  ...project,\r\n                  positions: project.positions?.map((position) => {\r\n                    const removedCount = removedAllocations\r\n                      .filter((a) => a.positionId === position.id)\r\n                      .reduce((sum, a) => sum + (a.percentage || 0), 0)\r\n                    \r\n                    return {\r\n                      ...position,\r\n                      allocated: Math.max(0, (position.allocated || 0) - removedCount),\r\n                    }\r\n                  }),\r\n                }\r\n              : project,\r\n          ),\r\n        )\r\n      }\r\n      \r\n      return filtered\r\n    })\r\n  }\r\n\r\n  const handleEditAllocation = (allocationId: string, newPercentage: number) => {\r\n    setAllocations((prev) => prev.map((a) => (a.id === allocationId ? { ...a, percentage: newPercentage } : a)))\r\n    setEditingId(null)\r\n    setEditValue(0)\r\n  }\r\n\r\n  // Only show users who are active for the current grid window.\r\n  // If a user has an endDate before the starting month/year, hide them.\r\n  // If a user has a startDate after the ending month/year, hide them.\r\n  const gridStartGlobalIndex = (startYear - 2024) * 12 + startMonth\r\n  const gridEndGlobalIndex = gridStartGlobalIndex + 11 // 12 months total\r\n\r\n  const activeUsers = users.filter((user) => {\r\n    // Check end date filtering\r\n    if (user.endDate) {\r\n      const end = new Date(user.endDate)\r\n      if (!Number.isNaN(end.getTime())) {\r\n        const endMonth = end.getMonth() // 0-11\r\n        const endYear = end.getFullYear()\r\n        const endGlobalIndex = (endYear - 2024) * 12 + endMonth\r\n        if (endGlobalIndex < gridStartGlobalIndex) {\r\n          return false // User ended before grid starts\r\n        }\r\n      }\r\n    }\r\n\r\n    // Check start date filtering\r\n    if (user.startDate) {\r\n      const start = new Date(user.startDate)\r\n      if (!Number.isNaN(start.getTime())) {\r\n        const startMonth = start.getMonth() // 0-11\r\n        const startYear = start.getFullYear()\r\n        const startGlobalIndex = (startYear - 2024) * 12 + startMonth\r\n        if (startGlobalIndex > gridEndGlobalIndex) {\r\n          return false // User starts after grid ends\r\n        }\r\n      }\r\n    }\r\n\r\n    return true\r\n  })\r\n\r\n  // Filter users based on selected project\r\n  const filteredUsers = selectedProjectId \r\n    ? activeUsers.filter(user => \r\n        allocations.some(allocation => \r\n          allocation.userId === user.id && \r\n          allocation.projectId === selectedProjectId\r\n        )\r\n      )\r\n    : activeUsers\r\n\r\n  const groupedUsers = Array.from(\r\n    filteredUsers.reduce((acc, user) => {\r\n      if (!acc.has(user.department)) {\r\n        acc.set(user.department, [])\r\n      }\r\n      acc.get(user.department)!.push(user)\r\n      return acc\r\n    }, new Map<string, User[]>()),\r\n  ).map(([dept, deptUsers]) => ({\r\n    department: dept,\r\n    users: deptUsers.sort((a, b) => a.name.localeCompare(b.name)),\r\n  })).sort((a, b) => a.department.localeCompare(b.department))\r\n\r\n  return (\r\n    <div className=\"space-y-4 p-6\">\r\n      <div className=\"flex justify-between items-start gap-4\">\r\n        <div>\r\n          {/* Project Management - for users who can view allocation */}\r\n          {canView && (\r\n            <ProjectManager\r\n              projects={filteredProjects}\r\n              positions={filteredProjects.flatMap((p) => p.positions || [])}\r\n              months={MONTHS}\r\n              startMonth={startMonth}\r\n              startYear={startYear}\r\n              onAddProject={addProject}\r\n              onUpdateProject={updateProject}\r\n              onDeleteProject={deleteProject}\r\n              onUpdatePositions={updatePositions}\r\n              onProjectSelect={setSelectedProjectId}\r\n              selectedProjectId={selectedProjectId}\r\n              onCleanupAllocations={cleanupAllocations}\r\n              currentUserRole={currentUserRole}\r\n            />\r\n          )}\r\n        </div>\r\n        <div className=\"flex gap-4 items-end\">\r\n          <div className=\"space-y-2\">\r\n            <label className=\"block text-sm font-medium\">Starting Month</label>\r\n            <select\r\n              value={startMonth}\r\n              onChange={(e) => setStartMonth(Number.parseInt(e.target.value))}\r\n              className=\"border rounded px-2 py-1\"\r\n            >\r\n              {MONTHS.map((month, idx) => (\r\n                <option key={month} value={idx}>\r\n                  {month}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n          <div className=\"space-y-2\">\r\n            <label className=\"block text-sm font-medium\">Starting Year</label>\r\n            <select\r\n              value={startYear}\r\n              onChange={(e) => setStartYear(Number.parseInt(e.target.value))}\r\n              className=\"border rounded px-2 py-1\"\r\n            >\r\n              {YEARS.map((year) => (\r\n                <option key={year} value={year}>\r\n                  {year}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"space-y-2 rounded-full\">\r\n        <div className=\"flex justify-between items-center\">\r\n          <div className=\"flex items-center gap-2\">\r\n            {selectedProjectId && (\r\n              <div className=\"flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm\">\r\n                <span>Filtered by: {projects.find(p => p.id === selectedProjectId)?.name}</span>\r\n                <button\r\n                  onClick={() => setSelectedProjectId(null)}\r\n                  className=\"text-blue-600 hover:text-blue-800 font-bold\"\r\n                >\r\n                  √ó\r\n                </button>\r\n              </div>\r\n            )}\r\n            {/* Add Staff button - only for users who can edit */}\r\n            {canEdit && (\r\n              <Button onClick={addUser} variant=\"default\" size=\"sm\" className=\"bg-blue-900 hover:bg-blue-800 text-white\">\r\n                + New Staff\r\n              </Button>\r\n            )}\r\n            {/* View Mode Selector */}\r\n            <div className=\"flex items-center gap-2 ml-4\">\r\n              <span className=\"text-sm text-gray-600\">View:</span>\r\n              <div className=\"flex border rounded overflow-hidden\">\r\n                <button\r\n                  onClick={() => setViewMode('percentage')}\r\n                  className={`px-3 py-1 text-sm font-medium transition-colors ${\r\n                    viewMode === 'percentage'\r\n                      ? 'bg-blue-600 text-white'\r\n                      : 'bg-white text-gray-700 hover:bg-gray-100'\r\n                  }`}\r\n                >\r\n                  % View\r\n                </button>\r\n                <button\r\n                  onClick={() => setViewMode('days')}\r\n                  className={`px-3 py-1 text-sm font-medium transition-colors ${\r\n                    viewMode === 'days'\r\n                      ? 'bg-blue-600 text-white'\r\n                      : 'bg-white text-gray-700 hover:bg-gray-100'\r\n                  }`}\r\n                >\r\n                  Days View\r\n                </button>\r\n              </div>\r\n            </div>\r\n            {/* Export to Excel Button */}\r\n            <button\r\n              onClick={exportToExcel}\r\n              className=\"px-3 py-1 text-sm bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors ml-4\"\r\n            >\r\n              Export to Excel\r\n            </button>\r\n            {/* Gantt Chart Button */}\r\n            <button\r\n              onClick={() => setShowGanttChart(true)}\r\n              className=\"px-3 py-1 text-sm bg-green-600 text-white rounded hover:bg-green-700 transition-colors ml-2\"\r\n              title=\"Show Project Gantt Chart\"\r\n            >\r\n              üìä Gantt Chart\r\n            </button>\r\n          </div>\r\n          <div className=\"flex gap-2 items-center\">\r\n            {/* Current User Display */}\r\n            <div className=\"text-right mr-4\">\r\n              <div className=\"text-sm text-gray-600\">Current User</div>\r\n              <div className=\"font-medium\">{currentUser}</div>\r\n              <div className=\"text-xs text-gray-500 capitalize\">{currentUserRole}</div>\r\n            </div>\r\n            {/* Settings button - only for admins */}\r\n            {currentUserRole === 'admin' && (\r\n              <Button \r\n                onClick={() => setShowUserManagement(true)} \r\n                variant=\"outline\" \r\n                size=\"sm\"\r\n                className=\"flex items-center gap-2\"\r\n              >\r\n                <svg\r\n                  className=\"w-4 h-4\"\r\n                  fill=\"none\"\r\n                  stroke=\"currentColor\"\r\n                  viewBox=\"0 0 24 24\"\r\n                >\r\n                  <path\r\n                    strokeLinecap=\"round\"\r\n                    strokeLinejoin=\"round\"\r\n                    strokeWidth={2}\r\n                    d=\"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z\"\r\n                  />\r\n                </svg>\r\n                Settings\r\n              </Button>\r\n            )}\r\n            <Button\r\n              onClick={() => {\r\n                // Clear current user session but keep their data\r\n                const user = getCurrentUser()\r\n                if (user) {\r\n                  setCurrentUserData({ startMonth, startYear }) // Save current view settings\r\n                }\r\n                clearCurrentUser()\r\n                window.location.href = \"/login\"\r\n              }}\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              className=\"flex items-center gap-2\"\r\n            >\r\n              <svg\r\n                className=\"w-4 h-4\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1\"\r\n                />\r\n              </svg>\r\n              Logout\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"w-full border-collapse border border-gray-300\">\r\n            <thead>\r\n              <tr>\r\n                <th className=\"border border-gray-300 p-2 bg-gray-100 w-42\">Staff</th>\r\n                {months.map((month, idx) => {\r\n                  const monFriDays = getWorkingDaysInMonth(month.year, month.month, 1) // Monday to Friday\r\n                  const sunThuDays = getWorkingDaysInMonth(month.year, month.month, 0) // Sunday to Thursday\r\n                  return (\r\n                    <th\r\n                      key={idx}\r\n                      className=\"border border-gray-300 p-2 bg-gray-100 w-32 cursor-pointer hover:bg-gray-200 text-sm\"\r\n                      onClick={() => handleMonthClick(month.globalIndex)}\r\n                    >\r\n                      <div className=\"flex flex-col items-center\">\r\n                        <div>{month.display}</div>\r\n                        <div className=\"text-[10px] text-gray-600 mt-1\">\r\n                          <div>Mon-Fri: {monFriDays}</div>\r\n                          <div>Sun-Thu: {sunThuDays}</div>\r\n                        </div>\r\n                      </div>\r\n                    </th>\r\n                  )\r\n                })}\r\n              </tr>\r\n              <tr>\r\n                <th className=\"border border-gray-300 bg-gray-50 w-42 text-xs text-muted-foreground\">Unallocated</th>\r\n                {months.map((month) => {\r\n                  const monthUnallocated = filteredProjects.flatMap((project) => {\r\n                    const positionsForMonth =\r\n                      project.positions?.filter((pos) => pos.monthIndex === month.globalIndex) || []\r\n\r\n                    return positionsForMonth\r\n                      .map((position) => {\r\n                        const allocated = allocations\r\n                          .filter(\r\n                            (a) =>\r\n                              a.projectId === project.id &&\r\n                              a.monthIndex === month.globalIndex &&\r\n                              a.positionId === position.id,\r\n                          )\r\n                          .reduce((sum, a) => sum + (a.percentage || 0), 0)\r\n\r\n                        const unallocated = Math.max(0, position.percentage - allocated)\r\n                        if (unallocated <= 0) return null\r\n\r\n                        // Calculate display value based on project allocation mode and view mode\r\n                        let displayValue: number\r\n                        let displayText: string\r\n                        \r\n                        if (viewMode === 'days') {\r\n                          // Day view - calculate days for both allocation modes\r\n                          const workingDays = getWorkingDaysInMonth(month.year, month.month, 1) // Default to Mon-Fri\r\n                          const calculatedDays = Math.round((unallocated / 100) * workingDays)\r\n                          displayValue = calculatedDays\r\n                          displayText = `${calculatedDays} days`\r\n                        } else {\r\n                          // Percentage view - show rounded percentages for both allocation modes\r\n                          displayValue = Math.round(unallocated)\r\n                          displayText = `${displayValue}%`\r\n                        }\r\n\r\n                        return {\r\n                          projectId: project.id,\r\n                          projectName: project.name,\r\n                          projectColor: project.color,\r\n                          positionId: position.id,\r\n                          positionName: position.name || \"Position\",\r\n                          percentage: unallocated,\r\n                          displayValue,\r\n                          displayText,\r\n                        }\r\n                      })\r\n                      .filter((p): p is NonNullable<typeof p> => p != null)\r\n                  })\r\n\r\n                  return (\r\n                    <td\r\n                      key={month.globalIndex}\r\n                      className=\"border border-gray-300 bg-gray-50 p-1 align-top\"\r\n                      style={{ verticalAlign: \"top\" }}\r\n                    >\r\n                      <div className=\"flex flex-wrap gap-1\">\r\n                        {monthUnallocated.map((pos) => (\r\n                          <div\r\n                            key={`${pos.projectId}-${pos.positionId}`}\r\n                            className=\"flex items-center h-8 rounded overflow-hidden bg-gray-200 text-[9px] text-white\"\r\n                            style={{\r\n                              minWidth: \"50px\",\r\n                              maxWidth: \"120px\",\r\n                            }}\r\n                            title={`${pos.projectName} - ${pos.positionName} (${pos.displayText} unallocated)`}\r\n                          >\r\n                            <div\r\n                              className=\"h-full flex items-center justify-center px-1 text-center leading-tight\"\r\n                              style={{\r\n                                backgroundColor: pos.projectColor || \"#3b82f6\",\r\n                                width: \"100%\",\r\n                              }}\r\n                            >\r\n                              {pos.positionName} ({pos.displayText})\r\n                            </div>\r\n                          </div>\r\n                        ))}\r\n                      </div>\r\n                    </td>\r\n                  )\r\n                })}\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {groupedUsers.map((group) => (\r\n                <React.Fragment key={group.department}>\r\n                  <tr>\r\n                    <td colSpan={months.length + 1} className=\"border border-gray-300 p-1 font-semibold text-xs text-gray-800 bg-cyan-200\">\r\n                      {group.department}\r\n                    </td>\r\n                  </tr>\r\n                  {group.users.map((user) => (\r\n                    <tr key={user.id}>\r\n                      <td className=\"border border-gray-300 p-1 w-42\">\r\n                        <div className=\"flex items-center justify-between gap-1\">\r\n                          <span className=\"text-xs leading-tight\">{user.name}</span>\r\n                          {/* Edit user button - only for users who can edit */}\r\n                          {canEdit && (\r\n                            <button\r\n                              onClick={() => editUser(user.id)}\r\n                              className=\"text-blue-600 hover:text-blue-800 text-xs\"\r\n                            >\r\n                              ‚úèÔ∏è\r\n                            </button>\r\n                          )}\r\n                        </div>\r\n                      </td>\r\n                      {months.map((month) => (\r\n                        <AllocationCell\r\n                          key={`${user.id}-${month.globalIndex}`}\r\n                          userId={user.id}\r\n                          monthIndex={month.globalIndex}\r\n                          allocations={allocations.filter(\r\n                            (a) => a.userId === user.id && a.monthIndex === month.globalIndex,\r\n                          )}\r\n                          project={filteredProjects.find((p) => p.id === allocations[0]?.projectId)}\r\n                          projects={filteredProjects}\r\n                          users={users}\r\n                          month={month}\r\n                          userEnded={isUserEndedInMonth(user.id, month.globalIndex)}\r\n                          userNotStarted={!isUserStartedInMonth(user.id, month.globalIndex)}\r\n                          viewMode={viewMode}\r\n                          getDaysFromPercentage={getDaysFromPercentage}\r\n                          readOnly={currentUserRole === 'viewer'}\r\n                          onEdit={(id) => {\r\n                            setEditingId(id)\r\n                            const alloc = allocations.find((a) => a.id === id)\r\n                            if (alloc) setEditValue(alloc.percentage)\r\n                          }}\r\n                          onSaveEdit={handleEditAllocation}\r\n                          onRemove={handleRemoveAllocation}\r\n                          onEmptyCellClick={() => handleEmptyCellClick(user.id, month.globalIndex)}\r\n                        />\r\n                      ))}\r\n                    </tr>\r\n                  ))}\r\n                </React.Fragment>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      {showUserModal && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-lg p-6 w-96\">\r\n            <h3 className=\"text-lg font-bold mb-4\">{editingUserId ? \"Edit User\" : \"Add User\"}</h3>\r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1\">Name</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={editingUserName}\r\n                  onChange={(e) => setEditingUserName(e.target.value)}\r\n                  className=\"w-full border rounded px-2 py-1\"\r\n                  placeholder=\"User name\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1\">Department</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={editingUserDept}\r\n                  onChange={(e) => setEditingUserDept(e.target.value)}\r\n                  className=\"w-full border rounded px-2 py-1\"\r\n                  placeholder=\"Department\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1\">Entity</label>\r\n                <select\r\n                  value={editingUserEntity}\r\n                  onChange={(e) => setEditingUserEntity(e.target.value)}\r\n                  className=\"w-full border rounded px-2 py-1\"\r\n                >\r\n                  <option value=\"\">Select Entity</option>\r\n                  {entities.map(entity => (\r\n                    <option key={entity.id} value={entity.name}>\r\n                      {entity.name}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1\">Vendor AC</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={editingUserVendorAC}\r\n                  onChange={(e) => setEditingUserVendorAC(e.target.value)}\r\n                  className=\"w-full border rounded px-2 py-1\"\r\n                  placeholder=\"Vendor AC\"\r\n                />\r\n              </div>\r\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium mb-1\">Start Date</label>\r\n                  <input\r\n                    type=\"date\"\r\n                    value={editingUserStartDate}\r\n                    onChange={(e) => setEditingUserStartDate(e.target.value)}\r\n                    className=\"w-full border rounded px-2 py-1 text-sm\"\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label className=\"block text-sm font-medium mb-1\">End Date</label>\r\n                  <input\r\n                    type=\"date\"\r\n                    value={editingUserEndDate}\r\n                    onChange={(e) => setEditingUserEndDate(e.target.value)}\r\n                    className=\"w-full border rounded px-2 py-1 text-sm\"\r\n                  />\r\n                  <p className=\"mt-1 text-[11px] text-gray-500\">Leave blank if working indefinitely.</p>\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1\">Work Days</label>\r\n                <select\r\n                  value={editingUserWorkDays}\r\n                  onChange={(e) => setEditingUserWorkDays(e.target.value as 'mon-fri' | 'sun-thu')}\r\n                  className=\"w-full border rounded px-2 py-1 text-sm\"\r\n                >\r\n                  <option value=\"mon-fri\">Monday - Friday</option>\r\n                  <option value=\"sun-thu\">Sunday - Thursday</option>\r\n                </select>\r\n              </div>\r\n              <div className=\"flex gap-2 justify-end\">\r\n                {editingUserId && (\r\n                  <Button\r\n                    variant=\"destructive\"\r\n                    onClick={() => {\r\n                      deleteUser(editingUserId)\r\n                      setShowUserModal(false)\r\n                    }}\r\n                  >\r\n                    Delete\r\n                  </Button>\r\n                )}\r\n                <Button variant=\"outline\" onClick={() => setShowUserModal(false)}>\r\n                  Cancel\r\n                </Button>\r\n                <Button onClick={saveUserChanges}>Save</Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {showPositionModal && selectedCellMonth !== null && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-lg p-6 w-[500px] max-h-[80vh] overflow-y-auto\">\r\n            <h3 className=\"text-lg font-bold mb-4\">Select Position</h3>\r\n            <div className=\"space-y-3\">\r\n              {projects.flatMap((project) => {\r\n                // Positions created in ProjectManager already use a global monthIndex (0 = Jan 2024, ...)\r\n                // Cells in the grid also use this same global monthIndex. So we just match directly.\r\n                const monthPositions = (project.positions || [])\r\n                  .filter((p) => p.monthIndex === selectedCellMonth && (p.percentage || 0) > 0)\r\n                  .map((p) => {\r\n                    const allocated = allocations\r\n                      .filter(\r\n                        (a) =>\r\n                          a.projectId === project.id &&\r\n                          a.monthIndex === selectedCellMonth &&\r\n                          a.positionName === p.name,\r\n                      )\r\n                      .reduce((sum, a) => sum + (a.percentage || 0), 0)\r\n\r\n                    const available = Math.max(0, (p.percentage || 0) - allocated)\r\n                    const availableDays = selectedCellUser \r\n                      ? getDaysFromPercentage(selectedCellUser, selectedCellMonth, available)\r\n                      : 0\r\n                    const allocatedDays = selectedCellUser \r\n                      ? getDaysFromPercentage(selectedCellUser, selectedCellMonth, allocated)\r\n                      : 0\r\n\r\n                    return {\r\n                      ...p,\r\n                      projectId: project.id,\r\n                      projectName: project.name,\r\n                      projectColor: project.color,\r\n                      available,\r\n                      availableDays,\r\n                      allocated,\r\n                      allocatedDays,\r\n                    }\r\n                  })\r\n                  .filter((p) => p.available > 0)\r\n\r\n                const availablePositions = monthPositions\r\n\r\n                return availablePositions.map((position) => {\r\n                  const positionKey = `${position.projectId}-${position.id}`\r\n                  const isCustomMode = selectedPositionForCustom === positionKey\r\n                  const customValue = customAllocationAmount[positionKey] || \"\"\r\n\r\n                  return (\r\n                    <div\r\n                      key={positionKey}\r\n                      className=\"border border-gray-200 rounded-lg p-3 hover:bg-blue-50 transition-colors\"\r\n                      style={{\r\n                        borderLeft: `4px solid ${position.projectColor}`,\r\n                      }}\r\n                    >\r\n                      <div className=\"flex justify-between items-start mb-2\">\r\n                        <div>\r\n                          <div className=\"font-medium\">{position.name || \"Unnamed\"}</div>\r\n                          <div className=\"text-sm text-gray-600\">{position.projectName}</div>\r\n                        </div>\r\n                        <div className=\"text-right\">\r\n                          <div className=\"text-sm font-medium\">\r\n                            {Math.round(position.available)}% ({position.availableDays} days)\r\n                          </div>\r\n                          <div className=\"text-xs text-gray-500\">\r\n                            {Math.round(position.allocated)}% ({position.allocatedDays} days) allocated\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      \r\n                      {/* Progress bar */}\r\n                      <div className=\"w-full bg-gray-200 rounded-full h-2 mb-3\">\r\n                        <div\r\n                          className=\"h-2 rounded-full transition-all duration-300\"\r\n                          style={{\r\n                            width: `${(position.allocated / position.percentage) * 100}%`,\r\n                            backgroundColor: position.projectColor,\r\n                          }}\r\n                        />\r\n                      </div>\r\n\r\n                      {/* Custom allocation controls */}\r\n                      <div className=\"space-y-2\">\r\n                        {!isCustomMode ? (\r\n                          <div className=\"flex gap-2\">\r\n                            <button\r\n                              onClick={() => {\r\n                                handleAddAllocation(position.projectId, position.name || \"\", position.available)\r\n                              }}\r\n                              className=\"flex-1 px-3 py-2 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 transition-colors\"\r\n                            >\r\n                              Allocate Full ({Math.round(position.available)}%)\r\n                            </button>\r\n                            <button\r\n                              onClick={() => {\r\n                                setSelectedPositionForCustom(positionKey)\r\n                                setCustomAllocationAmount({\r\n                                  ...customAllocationAmount,\r\n                                  [positionKey]: Math.round(position.available).toString()\r\n                                })\r\n                              }}\r\n                              className=\"flex-1 px-3 py-2 bg-gray-600 text-white rounded text-sm hover:bg-gray-700 transition-colors\"\r\n                            >\r\n                              Custom Amount\r\n                            </button>\r\n                          </div>\r\n                        ) : (\r\n                          <div className=\"space-y-2\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <input\r\n                                type=\"number\"\r\n                                min=\"0\"\r\n                                max={Math.round(position.available)}\r\n                                value={customValue}\r\n                                onChange={(e) => {\r\n                                  setCustomAllocationAmount({\r\n                                    ...customAllocationAmount,\r\n                                    [positionKey]: e.target.value\r\n                                  })\r\n                                }}\r\n                                className=\"flex-1 px-3 py-2 border border-gray-300 rounded text-sm\"\r\n                                placeholder={`Enter % (max: ${Math.round(position.available)})`}\r\n                              />\r\n                              <span className=\"text-sm text-gray-600\">%</span>\r\n                            </div>\r\n                            {selectedCellUser && (\r\n                              <div className=\"text-xs text-gray-500\">\r\n                                {customValue ? `${Math.round((Number(customValue) / 100) * getDaysFromPercentage(selectedCellUser, selectedCellMonth, 100))} days` : '0 days'}\r\n                              </div>\r\n                            )}\r\n                            <div className=\"flex gap-2\">\r\n                              <button\r\n                                onClick={() => {\r\n                                  const amount = Number(customValue)\r\n                                  if (amount > 0 && amount <= position.available) {\r\n                                    handleAddAllocation(position.projectId, position.name || \"\", amount)\r\n                                  }\r\n                                }}\r\n                                disabled={!customValue || Number(customValue) <= 0 || Number(customValue) > position.available}\r\n                                className=\"flex-1 px-3 py-2 bg-green-600 text-white rounded text-sm hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                              >\r\n                                Allocate Custom\r\n                              </button>\r\n                              <button\r\n                                onClick={() => {\r\n                                  setSelectedPositionForCustom(null)\r\n                                  setCustomAllocationAmount({\r\n                                    ...customAllocationAmount,\r\n                                    [positionKey]: \"\"\r\n                                  })\r\n                                }}\r\n                                className=\"flex-1 px-3 py-2 bg-gray-400 text-white rounded text-sm hover:bg-gray-500 transition-colors\"\r\n                              >\r\n                                Cancel\r\n                              </button>\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  )\r\n                })\r\n              })}\r\n            </div>\r\n            {projects.every(\r\n              (project) =>\r\n                !project.positions?.some((p) => p.monthIndex === selectedCellMonth && (p.percentage || 0) > 0),\r\n            ) && (\r\n              <div className=\"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded text-sm text-yellow-800\">\r\n                No positions available for this month. Add positions in the project settings.\r\n              </div>\r\n            )}\r\n            <Button variant=\"outline\" onClick={() => {\r\n              setShowPositionModal(false)\r\n              setSelectedPositionForCustom(null)\r\n              setCustomAllocationAmount({})\r\n            }} className=\"w-full mt-4\">\r\n              Close\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* User Management Modal */}\r\n      <UserManagement \r\n        isOpen={showUserManagement} \r\n        onClose={() => setShowUserManagement(false)} \r\n      />\r\n\r\n      {/* Month Detail Modal */}\r\n      {showMonthDetail && selectedMonthForDetail && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-lg p-4 w-full max-w-7xl max-h-[95vh] overflow-y-auto mx-2\">\r\n            <div className=\"flex justify-between items-center mb-3\">\r\n              <div>\r\n                <h2 className=\"text-base font-bold\">\r\n                  Staff Allocation Detail - {MONTHS[selectedMonthForDetail.month]} {selectedMonthForDetail.year}\r\n                </h2>\r\n                {/* View Mode Selector */}\r\n                <div className=\"flex items-center gap-2 mt-1\">\r\n                  <span className=\"text-xs text-gray-600\">View:</span>\r\n                  <div className=\"flex border rounded overflow-hidden\">\r\n                    <button\r\n                      onClick={() => setViewMode('percentage')}\r\n                      className={`px-2 py-1 text-xs font-medium transition-colors ${\r\n                        viewMode === 'percentage'\r\n                          ? 'bg-blue-600 text-white'\r\n                          : 'bg-white text-gray-700 hover:bg-gray-100'\r\n                      }`}\r\n                    >\r\n                      % View\r\n                    </button>\r\n                    <button\r\n                      onClick={() => setViewMode('days')}\r\n                      className={`px-2 py-1 text-xs font-medium transition-colors ${\r\n                        viewMode === 'days'\r\n                          ? 'bg-blue-600 text-white'\r\n                          : 'bg-white text-gray-700 hover:bg-gray-100'\r\n                      }`}\r\n                    >\r\n                      Days View\r\n                    </button>\r\n                  </div>\r\n                  {/* Export to Excel Button */}\r\n                  <button\r\n                    onClick={exportMonthDetailToExcel}\r\n                    className=\"px-2 py-1 text-xs bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors ml-3\"\r\n                  >\r\n                    Export to Excel\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              <button\r\n                onClick={() => {\r\n                  setShowMonthDetail(false)\r\n                  setSelectedMonthForDetail(null)\r\n                }}\r\n                className=\"px-2 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors text-xs\"\r\n              >\r\n                √ó Close\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"w-full border-collapse border border-gray-300 text-xs\">\r\n                <thead>\r\n                  <tr>\r\n                    <th className=\"border border-gray-300 p-1 bg-gray-100 w-32 text-xs\">Staff</th>\r\n                    {filteredProjects.map((project) => (\r\n                      <th\r\n                        key={project.id}\r\n                        className=\"border border-gray-300 p-1 bg-gray-100 min-w-24 text-xs\"\r\n                        style={{ backgroundColor: project.color, color: getContrastColor(project.color) }}\r\n                      >\r\n                        {project.name}\r\n                      </th>\r\n                    ))}\r\n                    <th className=\"border border-gray-300 p-1 bg-gray-100 w-32 text-xs\">Total</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {groupedUsers.map((group) => (\r\n                    <React.Fragment key={group.department}>\r\n                      <tr>\r\n                        <td colSpan={filteredProjects.length + 2} className=\"border border-gray-300 p-1 font-semibold text-xs text-gray-800 bg-cyan-200\">\r\n                          {group.department}\r\n                        </td>\r\n                      </tr>\r\n                      {group.users.map((user) => (\r\n                        <tr key={user.id}>\r\n                          <td className=\"border border-gray-300 p-1 text-xs\">\r\n                            {user.name}\r\n                          </td>\r\n                          {filteredProjects.map((project) => {\r\n                            const userAllocations = allocations.filter(\r\n                              (a) => a.userId === user.id && a.monthIndex === selectedMonthForDetail.globalIndex\r\n                            )\r\n                            const projectAllocations = userAllocations.filter((a) => a.projectId === project.id)\r\n                            \r\n                            return (\r\n                              <td key={project.id} className=\"border border-gray-300 p-0.5 text-center\">\r\n                                {projectAllocations.length > 0 ? (\r\n                                  <div className=\"flex flex-col gap-0.5\">\r\n                                    {projectAllocations.map((allocation) => {\r\n                                      const position = project.positions?.find(\r\n                                        (p) => p.id === allocation.positionId\r\n                                      )\r\n                                      const displayValue = viewMode === 'days' \r\n                                        ? getDaysFromPercentage(user.id, selectedMonthForDetail.globalIndex, allocation.percentage)\r\n                                        : Math.round(allocation.percentage || 0)\r\n                                      const displayText = viewMode === 'days' \r\n                                        ? `${Math.round(displayValue)} days`\r\n                                        : `${displayValue}%`\r\n                                      \r\n                                      return (\r\n                                        <div\r\n                                          key={allocation.id}\r\n                                          className=\"text-[10px] px-1 py-0.5 rounded text-white leading-tight\"\r\n                                          style={{ backgroundColor: project.color }}\r\n                                          title={`${position?.name || 'Position'} - ${Math.round(allocation.percentage || 0)}%`}\r\n                                        >\r\n                                          {displayText}\r\n                                        </div>\r\n                                      )\r\n                                    })}\r\n                                  </div>\r\n                                ) : (\r\n                                  <div className=\"text-[10px] text-gray-400\">-</div>\r\n                                )}\r\n                              </td>\r\n                            )\r\n                          })}\r\n                          <td className=\"border border-gray-300 p-0.5 text-center text-xs font-medium\">\r\n                            {(() => {\r\n                              const totalAllocated = allocations\r\n                                .filter((a) => a.userId === user.id && a.monthIndex === selectedMonthForDetail.globalIndex)\r\n                                .reduce((sum, a) => sum + (a.percentage || 0), 0)\r\n                              const totalDays = getDaysFromPercentage(user.id, selectedMonthForDetail.globalIndex, totalAllocated)\r\n                              const roundedTotalAllocated = Math.round(totalAllocated)\r\n                              const roundedTotalDays = Math.round(totalDays)\r\n                              \r\n                              // Determine progress bar color and border\r\n                              let barColor = '#F59E0B' // Yellow (default for < 100%)\r\n                              let borderColor = 'transparent'\r\n                              \r\n                              if (roundedTotalAllocated >= 100) {\r\n                                if (roundedTotalAllocated > 100) {\r\n                                  barColor = '#10B981' // Green\r\n                                  borderColor = '#EF4444' // Red border for > 100%\r\n                                } else {\r\n                                  barColor = '#10B981' // Green\r\n                                  borderColor = 'transparent'\r\n                                }\r\n                              } else {\r\n                                barColor = '#F59E0B' // Yellow\r\n                                borderColor = 'transparent'\r\n                              }\r\n                              \r\n                              const displayText = viewMode === 'days' \r\n                                ? `${roundedTotalDays} days`\r\n                                : `${roundedTotalAllocated}%`\r\n                              \r\n                              return (\r\n                                <div className=\"w-full\">\r\n                                  {/* Progress bar */}\r\n                                  <div \r\n                                    className=\"w-full h-3 rounded relative overflow-hidden\"\r\n                                    style={{ \r\n                                      backgroundColor: '#E5E7EB',\r\n                                      border: borderColor !== 'transparent' ? `2px solid ${borderColor}` : 'none'\r\n                                    }}\r\n                                  >\r\n                                    {/* Progress bar fill - capped at 100% */}\r\n                                    <div\r\n                                      className=\"h-full rounded transition-all duration-300\"\r\n                                      style={{\r\n                                        width: `${Math.min(totalAllocated, 100)}%`, // Cap at 100% for display\r\n                                        backgroundColor: barColor\r\n                                      }}\r\n                                    />\r\n                                    {/* Text overlay - shows actual percentage */}\r\n                                    <div className=\"absolute inset-0 flex items-center justify-center text-[9px] font-medium\">\r\n                                      {viewMode === 'days' ? `${roundedTotalDays} days` : `${roundedTotalAllocated}%`}\r\n                                    </div>\r\n                                  </div>\r\n                                </div>\r\n                              )\r\n                            })()}\r\n                          </td>\r\n                        </tr>\r\n                      ))}\r\n                    </React.Fragment>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Gantt Chart Modal */}\r\n      {showGanttChart && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-lg p-6 w-full max-w-6xl max-h-[90vh] overflow-y-auto mx-4\">\r\n            <div className=\"flex justify-between items-center mb-4\">\r\n              <h2 className=\"text-xl font-bold\">Project Gantt Chart</h2>\r\n              <button\r\n                onClick={() => setShowGanttChart(false)}\r\n                className=\"text-gray-500 hover:text-gray-700 text-2xl font-bold\"\r\n              >\r\n                √ó\r\n              </button>\r\n            </div>\r\n            \r\n            <div className=\"space-y-4\">\r\n              {projects.length === 0 ? (\r\n                <div className=\"text-center py-8 text-gray-500\">\r\n                  No projects to display in Gantt chart\r\n                </div>\r\n              ) : (\r\n                <>\r\n                  {/* Timeline Header with Date Selector */}\r\n                  <div className=\"bg-gray-50 p-3 rounded-lg\">\r\n                    <div className=\"flex justify-between items-center\">\r\n                      <div>\r\n                        <div className=\"text-sm font-medium text-gray-700\">Project Timeline (Monthly View)</div>\r\n                        <div className=\"text-xs text-gray-500\">\r\n                          Based on today's date: {new Date().toLocaleDateString()}\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <label className=\"text-xs font-medium text-gray-600\">Start Year:</label>\r\n                        <select\r\n                          value={ganttStartYear}\r\n                          onChange={(e) => setGanttStartYear(Number(e.target.value))}\r\n                          className=\"border border-gray-300 rounded px-2 py-1 text-xs bg-white\"\r\n                        >\r\n                          {(() => {\r\n                            const allDates = projects.flatMap(p => [\r\n                              p.startYear || 2024,\r\n                              p.endYear || 2024\r\n                            ])\r\n                            const minYear = Math.min(...allDates, new Date().getFullYear() - 2)\r\n                            const maxYear = Math.max(...allDates, new Date().getFullYear() + 2)\r\n                            const years = []\r\n                            for (let y = minYear; y <= maxYear; y++) {\r\n                              years.push(y)\r\n                            }\r\n                            return years.map(year => (\r\n                              <option key={year} value={year}>\r\n                                {year}\r\n                              </option>\r\n                            ))\r\n                          })()}\r\n                        </select>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Calculate month range for 2 years from selected start year */}\r\n                  {(() => {\r\n                    // Create months for 2 years from ganttStartYear\r\n                    const months: { year: number; month: number; label: string }[] = []\r\n                    const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']\r\n                    for (let year = ganttStartYear; year < ganttStartYear + 2; year++) {\r\n                      for (let m = 0; m < 12; m++) {\r\n                        months.push({ year, month: m, label: `${monthNames[m]} ${year}` })\r\n                      }\r\n                    }\r\n                    \r\n                    const today = new Date()\r\n                    const currentYear = today.getFullYear()\r\n                    const currentMonth = today.getMonth()\r\n                    const currentMonthIndex = months.findIndex(m => \r\n                      m.year === currentYear && m.month === currentMonth\r\n                    )\r\n\r\n                    return (\r\n                      <div className=\"space-y-4\">\r\n                        {/* Timeline Grid */}\r\n                        <div className=\"border rounded-lg overflow-hidden relative\">\r\n                          {/* Today Line Indicator */}\r\n                          {currentMonthIndex >= 0 && (\r\n                            <div \r\n                              className=\"absolute top-0 bottom-0 w-0.5 bg-red-500 z-10 pointer-events-none\"\r\n                              style={{ \r\n                                left: `calc((3 / (months.length + 3)) * 100% + ${(currentMonthIndex + 0.5) * (97 / (months.length + 3))}%)` \r\n                              }}\r\n                            >\r\n                              <div className=\"absolute -top-2 -left-3 w-6 h-4 bg-red-500 text-white text-xs rounded flex items-center justify-center font-bold\">\r\n                                Today\r\n                              </div>\r\n                            </div>\r\n                          )}\r\n                          \r\n                          {/* Month Header */}\r\n                          <div className=\"grid bg-gray-100\" style={{ gridTemplateColumns: '3fr repeat(24, 1fr)' }}>\r\n                            <div className=\"p-0.5 text-xs font-medium text-gray-700 border-r\">Project</div>\r\n                            {months.map((month, index) => (\r\n                              <div key={`${month.year}-${month.month}`} className=\"p-0 text-xs font-medium text-center text-gray-700 border-r last:border-r-0\">\r\n                                <div className=\"text-xs\">{month.label.split(' ')[0]}</div>\r\n                                <div className=\"text-xs font-bold\">{month.label.split(' ')[1]}</div>\r\n                              </div>\r\n                            ))}\r\n                          </div>\r\n\r\n                          {/* Ongoing Projects */}\r\n                          {(() => {\r\n                            const ongoingProjects = projects.filter(p => {\r\n                              const start = new Date(p.startYear || 2024, p.startMonth || 0, 1)\r\n                              const end = new Date(p.endYear || 2024, p.endMonth || 11, 1)\r\n                              return today >= start && today <= end\r\n                            })\r\n\r\n                            if (ongoingProjects.length > 0) {\r\n                              return (\r\n                                <>\r\n                                  <div className=\"p-0.5 bg-blue-50 text-xs font-medium text-blue-700 border-b\" style={{ gridColumn: '1 / -1' }}>\r\n                                    üîµ Ongoing ({ongoingProjects.length})\r\n                                  </div>\r\n                                  {ongoingProjects.map((project) => {\r\n                                    const projectStart = new Date(project.startYear || 2024, project.startMonth || 0, 1)\r\n                                    const projectEnd = new Date(project.endYear || 2024, project.endMonth || 11, 1)\r\n                                    const totalDays = Math.ceil((projectEnd.getTime() - projectStart.getTime()) / (1000 * 60 * 60 * 24))\r\n                                    const elapsedDays = Math.ceil((today.getTime() - projectStart.getTime()) / (1000 * 60 * 60 * 24))\r\n                                    const completionPercentage = Math.max(0, Math.min(100, Math.round((elapsedDays / totalDays) * 100)))\r\n\r\n                                    return (\r\n                                      <div key={project.id} className=\"grid border-b hover:bg-gray-50 relative\" style={{ gridTemplateColumns: '3fr repeat(24, 1fr)' }}>\r\n                                        <div className=\"p-0.5 border-r\">\r\n                                          <div className=\"flex items-center gap-1\">\r\n                                            <div \r\n                                              className=\"w-2 h-2 rounded flex-shrink-0\"\r\n                                              style={{ backgroundColor: project.color }}\r\n                                            />\r\n                                            <span className=\"text-xs font-medium truncate\">{project.name}</span>\r\n                                          </div>\r\n                                        </div>\r\n                                        {months.map((month, index) => {\r\n                                          const monthStart = new Date(month.year, month.month, 1)\r\n                                          const monthEnd = new Date(month.year, month.month + 1, 0)\r\n                                          \r\n                                          const overlapStart = projectStart < monthStart ? monthStart : projectStart\r\n                                          const overlapEnd = projectEnd > monthEnd ? monthEnd : projectEnd\r\n                                          const hasOverlap = overlapStart <= overlapEnd\r\n                                          \r\n                                          const monthDays = Math.ceil((monthEnd.getTime() - monthStart.getTime()) / (1000 * 60 * 60 * 24))\r\n                                          const overlapDays = hasOverlap ? Math.ceil((overlapEnd.getTime() - overlapStart.getTime()) / (1000 * 60 * 60 * 24)) : 0\r\n                                          const monthCoverage = hasOverlap ? (overlapDays / monthDays) * 100 : 0\r\n                                          \r\n                                          const isCurrentMonthInProject = month.year === currentYear && \r\n                                            month.month === currentMonth && \r\n                                            today >= projectStart && today <= projectEnd\r\n                                          \r\n                                          return (\r\n                                            <div key={`${month.year}-${month.month}`} className=\"border-r last:border-r-0 p-0\">\r\n                                              {hasOverlap ? (\r\n                                                <div className=\"relative h-3 bg-gray-200 rounded overflow-hidden\">\r\n                                                  <div \r\n                                                    className=\"h-full rounded transition-all duration-300\"\r\n                                                    style={{ \r\n                                                      width: `${monthCoverage}%`,\r\n                                                      backgroundColor: project.color,\r\n                                                      opacity: isCurrentMonthInProject ? 1 : 0.8\r\n                                                    }}\r\n                                                  >\r\n                                                  </div>\r\n                                                  {isCurrentMonthInProject && (\r\n                                                    <div className=\"absolute inset-0 border-2 border-blue-400 rounded pointer-events-none\"></div>\r\n                                                  )}\r\n                                                </div>\r\n                                              ) : (\r\n                                                <div className=\"h-3\"></div>\r\n                                              )}\r\n                                            </div>\r\n                                          )\r\n                                        })}\r\n                                      </div>\r\n                                    )\r\n                                  })}\r\n                                </>\r\n                              )\r\n                            }\r\n                            return null\r\n                          })()}\r\n\r\n                          {/* Completed Projects */}\r\n                          {(() => {\r\n                            const completedProjects = projects.filter(p => {\r\n                              const end = new Date(p.endYear || 2024, p.endMonth || 11, 1)\r\n                              return today > end\r\n                            })\r\n\r\n                            if (completedProjects.length > 0) {\r\n                              return (\r\n                                <>\r\n                                  <div className=\"p-0.5 bg-green-50 text-xs font-medium text-green-700 border-b\" style={{ gridColumn: '1 / -1' }}>\r\n                                    üü¢ Completed ({completedProjects.length})\r\n                                  </div>\r\n                                  {completedProjects.map((project) => {\r\n                                    const projectStart = new Date(project.startYear || 2024, project.startMonth || 0, 1)\r\n                                    const projectEnd = new Date(project.endYear || 2024, project.endMonth || 11, 1)\r\n\r\n                                    return (\r\n                                      <div key={project.id} className=\"grid border-b hover:bg-gray-50\" style={{ gridTemplateColumns: '3fr repeat(24, 1fr)' }}>\r\n                                        <div className=\"p-0.5 border-r\">\r\n                                          <div className=\"flex items-center gap-1\">\r\n                                            <div \r\n                                              className=\"w-2 h-2 rounded flex-shrink-0\"\r\n                                              style={{ backgroundColor: project.color }}\r\n                                            />\r\n                                            <span className=\"text-xs font-medium truncate\">{project.name}</span>\r\n                                          </div>\r\n                                        </div>\r\n                                        {months.map((month) => {\r\n                                          const monthStart = new Date(month.year, month.month, 1)\r\n                                          const monthEnd = new Date(month.year, month.month + 1, 0)\r\n                                          \r\n                                          const overlapStart = projectStart < monthStart ? monthStart : projectStart\r\n                                          const overlapEnd = projectEnd > monthEnd ? monthEnd : projectEnd\r\n                                          const hasOverlap = overlapStart <= overlapEnd\r\n                                          \r\n                                          const monthDays = Math.ceil((monthEnd.getTime() - monthStart.getTime()) / (1000 * 60 * 60 * 24))\r\n                                          const overlapDays = hasOverlap ? Math.ceil((overlapEnd.getTime() - overlapStart.getTime()) / (1000 * 60 * 60 * 24)) : 0\r\n                                          const monthCoverage = hasOverlap ? (overlapDays / monthDays) * 100 : 0\r\n                                          \r\n                                          return (\r\n                                            <div key={`${month.year}-${month.month}`} className=\"border-r last:border-r-0 p-0\">\r\n                                              {hasOverlap ? (\r\n                                                <div className=\"relative h-3 bg-gray-200 rounded overflow-hidden\">\r\n                                                  <div \r\n                                                    className=\"h-full rounded transition-all duration-300\"\r\n                                                    style={{ \r\n                                                      width: `${monthCoverage}%`,\r\n                                                      backgroundColor: project.color,\r\n                                                      opacity: 0.7\r\n                                                    }}\r\n                                                  >\r\n                                                  </div>\r\n                                                </div>\r\n                                              ) : (\r\n                                                <div className=\"h-3\"></div>\r\n                                              )}\r\n                                            </div>\r\n                                          )\r\n                                        })}\r\n                                      </div>\r\n                                    )\r\n                                  })}\r\n                                </>\r\n                              )\r\n                            }\r\n                            return null\r\n                          })()}\r\n\r\n                          {/* Planned Projects */}\r\n                          {(() => {\r\n                            const plannedProjects = projects.filter(p => {\r\n                              const start = new Date(p.startYear || 2024, p.startMonth || 0, 1)\r\n                              return today < start\r\n                            })\r\n\r\n                            if (plannedProjects.length > 0) {\r\n                              return (\r\n                                <>\r\n                                  <div className=\"p-0.5 bg-yellow-50 text-xs font-medium text-yellow-700 border-b\" style={{ gridColumn: '1 / -1' }}>\r\n                                    üü° Planned ({plannedProjects.length})\r\n                                  </div>\r\n                                  {plannedProjects.map((project) => {\r\n                                    const projectStart = new Date(project.startYear || 2024, project.startMonth || 0, 1)\r\n                                    const projectEnd = new Date(project.endYear || 2024, project.endMonth || 11, 1)\r\n                                    const daysUntilStart = Math.ceil((projectStart.getTime() - today.getTime()) / (1000 * 60 * 60 * 24))\r\n\r\n                                    return (\r\n                                      <div key={project.id} className=\"grid border-b hover:bg-gray-50\" style={{ gridTemplateColumns: '3fr repeat(24, 1fr)' }}>\r\n                                        <div className=\"p-0.5 border-r\">\r\n                                          <div className=\"flex items-center gap-1\">\r\n                                            <div \r\n                                              className=\"w-2 h-2 rounded flex-shrink-0\"\r\n                                              style={{ backgroundColor: project.color }}\r\n                                            />\r\n                                            <span className=\"text-xs font-medium truncate\">{project.name}</span>\r\n                                          </div>\r\n                                        </div>\r\n                                        {months.map((month) => {\r\n                                          const monthStart = new Date(month.year, month.month, 1)\r\n                                          const monthEnd = new Date(month.year, month.month + 1, 0)\r\n                                          \r\n                                          const overlapStart = projectStart < monthStart ? monthStart : projectStart\r\n                                          const overlapEnd = projectEnd > monthEnd ? monthEnd : projectEnd\r\n                                          const hasOverlap = overlapStart <= overlapEnd\r\n                                          \r\n                                          const monthDays = Math.ceil((monthEnd.getTime() - monthStart.getTime()) / (1000 * 60 * 60 * 24))\r\n                                          const overlapDays = hasOverlap ? Math.ceil((overlapEnd.getTime() - overlapStart.getTime()) / (1000 * 60 * 60 * 24)) : 0\r\n                                          const monthCoverage = hasOverlap ? (overlapDays / monthDays) * 100 : 0\r\n                                          \r\n                                          return (\r\n                                            <div key={`${month.year}-${month.month}`} className=\"border-r last:border-r-0 p-0\">\r\n                                              {hasOverlap ? (\r\n                                                <div className=\"relative h-3 bg-gray-200 rounded overflow-hidden\">\r\n                                                  <div \r\n                                                    className=\"h-full rounded transition-all duration-300\"\r\n                                                    style={{ \r\n                                                      width: `${monthCoverage}%`,\r\n                                                      backgroundColor: project.color,\r\n                                                      opacity: 0.6,\r\n                                                      borderStyle: 'dashed'\r\n                                                    }}\r\n                                                  >\r\n                                                  </div>\r\n                                                </div>\r\n                                              ) : (\r\n                                                <div className=\"h-3\"></div>\r\n                                              )}\r\n                                            </div>\r\n                                          )\r\n                                        })}\r\n                                      </div>\r\n                                    )\r\n                                  })}\r\n                                </>\r\n                              )\r\n                            }\r\n                            return null\r\n                          })()}\r\n                        </div>\r\n\r\n                        {/* Date Range Info */}\r\n                        <div className=\"bg-gray-50 p-3 rounded-lg\">\r\n                          <div className=\"text-sm font-medium text-gray-700 mb-2\">Timeline Range</div>\r\n                          <div className=\"text-xs text-gray-600\">\r\n                            Showing: {ganttStartYear} - {ganttStartYear + 1} (24 months)\r\n                          </div>\r\n                        </div>\r\n\r\n                        {/* Compact Summary */}\r\n                        <div className=\"bg-gray-50 p-3 rounded-lg\">\r\n                          <div className=\"text-sm font-medium text-gray-700 mb-2\">Summary</div>\r\n                          <div className=\"grid grid-cols-3 gap-3 text-xs\">\r\n                            <div className=\"text-center\">\r\n                              <div className=\"font-medium text-green-600\">\r\n                                {projects.filter(p => new Date() > new Date(p.endYear || 2024, p.endMonth || 11, 1)).length}\r\n                              </div>\r\n                              <div className=\"text-gray-500\">Completed</div>\r\n                            </div>\r\n                            <div className=\"text-center\">\r\n                              <div className=\"font-medium text-blue-600\">\r\n                                {projects.filter(p => {\r\n                                  const start = new Date(p.startYear || 2024, p.startMonth || 0, 1)\r\n                                  const end = new Date(p.endYear || 2024, p.endMonth || 11, 1)\r\n                                  return today >= start && today <= end\r\n                                }).length}\r\n                              </div>\r\n                              <div className=\"text-gray-500\">Ongoing</div>\r\n                            </div>\r\n                            <div className=\"text-center\">\r\n                              <div className=\"font-medium text-yellow-600\">\r\n                                {projects.filter(p => new Date() < new Date(p.startYear || 2024, p.startMonth || 0, 1)).length}\r\n                              </div>\r\n                              <div className=\"text-gray-500\">Planned</div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    )\r\n                  })()}\r\n                </>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n          </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}